============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-9.0.1, pluggy-1.6.0 -- /usr/bin/python3
cachedir: .pytest_cache
rootdir: /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot
configfile: pytest.ini (WARNING: ignoring pytest config in pyproject.toml!)
testpaths: tests
plugins: anyio-3.7.1, cov-7.0.0
collecting ... collected 490 items

tests/ai_models/test_feature_pipeline.py::test_compute_market_features_adds_columns PASSED [  0%]
tests/ai_models/test_feature_pipeline.py::test_normalize_features_builds_norm_columns PASSED [  0%]
tests/ai_models/test_model_loading.py::test_pipeline_answer_returns_clean_response FAILED [  0%]
tests/ai_models/test_model_loading.py::test_build_prompt_includes_evidence PASSED [  0%]
tests/ai_models/test_prediction_api_contract.py::test_ai_response_serializes_sources PASSED [  1%]
tests/ai_models/test_prediction_api_contract.py::test_ai_response_defaults_to_none_fields PASSED [  1%]
tests/ai_models/test_safety_filters.py::test_prompt_blocked_on_jailbreak PASSED [  1%]
tests/ai_models/test_safety_filters.py::test_response_requires_evidence PASSED [  1%]
tests/ai_models/test_safety_filters.py::test_moderation_client_can_block PASSED [  1%]
tests/backend/test_ai_routes.py::test_ai_query_returns_answer PASSED     [  2%]
tests/backend/test_ai_routes.py::test_ai_query_validates_question PASSED [  2%]
tests/backend/test_auth_routes.py::test_login_successful PASSED          [  2%]
tests/backend/test_auth_routes.py::test_login_invalid_credentials PASSED [  2%]
tests/backend/test_auth_routes.py::test_logout_successful FAILED         [  2%]
tests/backend/test_auth_routes.py::test_register_new_user FAILED         [  3%]
tests/backend/test_auth_routes.py::test_register_existing_user FAILED    [  3%]
tests/backend/test_auth_routes.py::test_register_invalid_email PASSED    [  3%]
tests/backend/test_auth_routes.py::test_register_weak_password PASSED    [  3%]
tests/backend/test_auth_routes.py::test_forgot_password_valid_email FAILED [  3%]
tests/backend/test_auth_routes.py::test_forgot_password_unknown_email FAILED [  4%]
tests/backend/test_auth_routes.py::test_protected_endpoint_requires_auth FAILED [  4%]
tests/backend/test_auth_routes.py::test_protected_endpoint_with_valid_token FAILED [  4%]
tests/backend/test_auth_routes.py::test_admin_only_endpoint_requires_admin_role FAILED [  4%]
tests/backend/test_auth_routes.py::test_token_refresh PASSED             [  4%]
tests/backend/test_auth_routes.py::test_logout_invalidates_token FAILED  [  5%]
tests/backend/test_auth_routes.py::test_auth_endpoints_cors_headers FAILED [  5%]
tests/backend/test_market_data_routes.py::test_get_market_data_ohlc FAILED [  5%]
tests/backend/test_market_data_routes.py::test_get_market_data_ohlc_invalid_symbol FAILED [  5%]
tests/backend/test_market_data_routes.py::test_get_market_data_ohlc_with_date_range FAILED [  5%]
tests/backend/test_market_data_routes.py::test_get_current_price FAILED  [  6%]
tests/backend/test_market_data_routes.py::test_get_current_price_not_found FAILED [  6%]
tests/backend/test_market_data_routes.py::test_get_market_data_quote FAILED [  6%]
tests/backend/test_market_data_routes.py::test_get_market_depth FAILED   [  6%]
tests/backend/test_market_data_routes.py::test_get_historical_volume FAILED [  6%]
tests/backend/test_market_data_routes.py::test_get_market_data_with_pagination FAILED [  7%]
tests/backend/test_market_data_routes.py::test_get_market_data_invalid_timeframe FAILED [  7%]
tests/backend/test_market_data_routes.py::test_get_market_data_rate_limiting FAILED [  7%]
tests/backend/test_market_data_routes.py::test_get_market_data_caching FAILED [  7%]
tests/backend/test_market_data_routes.py::test_get_market_data_error_handling FAILED [  7%]
tests/backend/test_market_data_routes.py::test_get_market_data_empty_response FAILED [  8%]
tests/backend/test_middlewares.py::test_security_headers_middleware_injects_defaults PASSED [  8%]
tests/backend/test_middlewares.py::test_enforce_https_redirects_insecure_requests PASSED [  8%]
tests/backend/test_trading_routes.py::test_place_buy_order_success FAILED [  8%]
tests/backend/test_trading_routes.py::test_place_sell_order_success FAILED [  8%]
tests/backend/test_trading_routes.py::test_place_market_order FAILED     [  9%]
tests/backend/test_trading_routes.py::test_place_order_invalid_side FAILED [  9%]
tests/backend/test_trading_routes.py::test_place_order_invalid_quantity FAILED [  9%]
tests/backend/test_trading_routes.py::test_place_order_live_mode_blocked_without_confirmation FAILED [  9%]
tests/backend/test_trading_routes.py::test_cancel_order_success FAILED   [ 10%]
tests/backend/test_trading_routes.py::test_cancel_order_not_found FAILED [ 10%]
tests/backend/test_trading_routes.py::test_get_portfolio_summary PASSED  [ 10%]
tests/backend/test_trading_routes.py::test_get_portfolio_positions PASSED [ 10%]
tests/backend/test_trading_routes.py::test_get_pnl_today FAILED          [ 10%]
tests/backend/test_trading_routes.py::test_get_order_history PASSED      [ 11%]
tests/backend/test_trading_routes.py::test_activate_strategy_success PASSED [ 11%]
tests/backend/test_trading_routes.py::test_activate_strategy_not_found PASSED [ 11%]
tests/backend/test_trading_routes.py::test_deactivate_strategy_success PASSED [ 11%]
tests/backend/test_trading_routes.py::test_start_trading_engine FAILED   [ 11%]
tests/backend/test_trading_routes.py::test_stop_trading_engine FAILED    [ 12%]
tests/backend/test_trading_routes.py::test_get_trading_status FAILED     [ 12%]
tests/backend/test_trading_routes.py::test_get_trading_history FAILED    [ 12%]
tests/backend/test_trading_routes.py::test_place_order_unauthenticated FAILED [ 12%]
tests/backend/test_trading_routes.py::test_portfolio_endpoints_fallback_to_mvp PASSED [ 12%]
tests/backend/test_trading_routes.py::test_portfolio_endpoints_no_service_available PASSED [ 13%]
tests/backend/test_user_routes.py::test_register_creates_user_and_returns_token PASSED [ 13%]
tests/backend/test_user_routes.py::test_register_rejects_duplicate_username PASSED [ 13%]
tests/backend/test_user_routes.py::test_login_enforces_credentials[user-userpass-200] PASSED [ 13%]
tests/backend/test_user_routes.py::test_login_enforces_credentials[user-badpass-401] PASSED [ 13%]
tests/data_collector/test_backfill_scripts.py::test_nse_backfill_script_success FAILED [ 14%]
tests/data_collector/test_backfill_scripts.py::test_nse_backfill_with_date_range FAILED [ 14%]
tests/data_collector/test_backfill_scripts.py::test_bse_backfill_script_success FAILED [ 14%]
tests/data_collector/test_backfill_scripts.py::test_mcx_backfill_script_success FAILED [ 14%]
tests/data_collector/test_backfill_scripts.py::test_backfill_script_error_handling FAILED [ 14%]
tests/data_collector/test_backfill_scripts.py::test_backfill_script_invalid_dates FAILED [ 15%]
tests/data_collector/test_backfill_scripts.py::test_backfill_script_rate_limiting FAILED [ 15%]
tests/data_collector/test_backfill_scripts.py::test_backfill_script_data_validation FAILED [ 15%]
tests/data_collector/test_backfill_scripts.py::test_backfill_script_progress_reporting FAILED [ 15%]
tests/data_collector/test_backfill_scripts.py::test_backfill_script_config_loading FAILED [ 15%]
tests/data_collector/test_backfill_scripts.py::test_backfill_script_output_formats FAILED [ 16%]
tests/data_collector/test_backfill_scripts.py::test_backfill_script_dry_run_mode FAILED [ 16%]
tests/data_collector/test_backfill_scripts.py::test_backfill_script_symbol_filtering FAILED [ 16%]
tests/data_collector/test_backfill_scripts.py::test_backfill_script_parallel_processing FAILED [ 16%]
tests/data_collector/test_mock_feeds.py::test_mock_websocket_server_emits_ticks FAILED [ 16%]
tests/data_collector/test_mock_feeds.py::test_signal_handler_schedules_stop PASSED [ 17%]
tests/e2e/test_paper_trading_e2e.py::test_paper_trading_buy_order_end_to_end PASSED [ 17%]
tests/e2e/test_paper_trading_e2e.py::test_paper_trading_edge_cases_and_errors PASSED [ 17%]
tests/e2e/test_paper_trading_e2e.py::test_paper_trading_edge_cases_and_errors ERROR [ 17%]
tests/e2e/test_paper_trading_e2e.py::test_paper_trading_limit_and_stop_orders PASSED [ 17%]
tests/e2e/test_paper_trading_e2e.py::test_paper_trading_limit_and_stop_orders ERROR [ 17%]
tests/integration/test_adapters_integration.py::TestYFinanceAdapterIntegration::test_fetch_and_store_data ERROR [ 17%]
tests/integration/test_adapters_integration.py::TestYFinanceAdapterIntegration::test_fetch_multiple_symbols ERROR [ 18%]
tests/integration/test_adapters_integration.py::TestAdapterDataNormalization::test_yfinance_normalization PASSED [ 18%]
tests/integration/test_adapters_integration.py::TestAdapterDataNormalization::test_alphavantage_normalization PASSED [ 18%]
tests/integration/test_adapters_integration.py::TestAdapterErrorHandling::test_yfinance_network_error FAILED [ 18%]
tests/integration/test_adapters_integration.py::TestAdapterErrorHandling::test_alphavantage_api_error FAILED [ 18%]
tests/integration/test_adapters_integration.py::TestAdapterRateLimiting::test_yfinance_rate_limiting FAILED [ 19%]
tests/integration/test_api_auth.py::TestAPIAuthentication::test_login_invalid_credentials PASSED [ 19%]
tests/integration/test_api_auth.py::TestAPIAuthentication::test_login_nonexistent_user FAILED [ 19%]
tests/integration/test_api_auth.py::TestAPIAuthentication::test_login_successful FAILED [ 19%]
tests/integration/test_api_auth.py::TestAPIAuthentication::test_logout_authenticated FAILED [ 20%]
tests/integration/test_api_auth.py::TestAPIAuthentication::test_logout_unauthenticated FAILED [ 20%]
tests/integration/test_api_auth.py::TestProtectedEndpoints::test_place_trade_authenticated FAILED [ 20%]
tests/integration/test_api_auth.py::TestProtectedEndpoints::test_place_trade_invalid_quantity FAILED [ 20%]
tests/integration/test_api_auth.py::TestProtectedEndpoints::test_place_trade_invalid_side FAILED [ 20%]
tests/integration/test_api_auth.py::TestProtectedEndpoints::test_place_trade_no_auth FAILED [ 21%]
tests/integration/test_api_auth.py::TestProtectedEndpoints::test_protected_endpoint_authenticated FAILED [ 21%]
tests/integration/test_api_auth.py::TestProtectedEndpoints::test_protected_endpoint_invalid_token FAILED [ 21%]
tests/integration/test_api_auth.py::TestProtectedEndpoints::test_protected_endpoint_no_auth FAILED [ 21%]
tests/integration/test_api_auth.py::TestPublicEndpoints::test_health_endpoint FAILED [ 21%]
tests/integration/test_api_auth.py::TestPublicEndpoints::test_logs_endpoint_forbidden_for_non_admin FAILED [ 22%]
tests/integration/test_api_auth.py::TestPublicEndpoints::test_logs_endpoint_no_file FAILED [ 22%]
tests/integration/test_api_auth.py::TestPublicEndpoints::test_logs_endpoint_requires_auth FAILED [ 22%]
tests/integration/test_api_auth.py::TestPublicEndpoints::test_logs_endpoint_with_file FAILED [ 22%]
tests/integration/test_api_auth.py::TestPublicEndpoints::test_metrics_endpoint FAILED [ 22%]
tests/integration/test_api_auth.py::TestPublicEndpoints::test_root_endpoint FAILED [ 23%]
tests/integration/test_api_auth.py::TestPublicEndpoints::test_status_endpoint FAILED [ 23%]
tests/integration/test_api_auth.py::TestStrategyEndpoints::test_get_strategies FAILED [ 23%]
tests/integration/test_api_auth.py::TestStrategyEndpoints::test_load_strategy_invalid_class FAILED [ 23%]
tests/integration/test_api_auth.py::TestStrategyEndpoints::test_manage_strategy_invalid_action FAILED [ 23%]
tests/integration/test_api_auth.py::TestTradingEndpoints::test_control_trading_invalid_action FAILED [ 24%]
tests/integration/test_api_auth.py::TestTradingEndpoints::test_get_trading_history FAILED [ 24%]
tests/integration/test_api_auth.py::TestTradingEndpoints::test_get_trading_status FAILED [ 24%]
tests/integration/test_api_endpoints.py::TestCandlesEndpoint::test_get_candles_success PASSED [ 24%]
tests/integration/test_api_endpoints.py::TestCandlesEndpoint::test_get_candles_with_limit PASSED [ 24%]
tests/integration/test_api_endpoints.py::TestCandlesEndpoint::test_get_candles_not_found PASSED [ 25%]
tests/integration/test_api_endpoints.py::TestCandlesEndpoint::test_get_candles_missing_symbol PASSED [ 25%]
tests/integration/test_api_endpoints.py::TestCandlesEndpoint::test_get_candles_invalid_limit PASSED [ 25%]
tests/integration/test_api_endpoints.py::TestMetricsEndpoint::test_get_metrics_success FAILED [ 25%]
tests/integration/test_api_endpoints.py::TestMetricsEndpoint::test_metrics_format PASSED [ 25%]
tests/integration/test_api_endpoints.py::TestHealthEndpoints::test_health_check PASSED [ 26%]
tests/integration/test_api_endpoints.py::TestHealthEndpoints::test_ready_check FAILED [ 26%]
tests/integration/test_api_endpoints.py::TestSymbolsEndpoint::test_get_symbols FAILED [ 26%]
tests/integration/test_backend_api_roles.py::test_health_endpoints_exposed_without_auth PASSED [ 26%]
tests/integration/test_backend_api_roles.py::test_metrics_requires_admin ERROR [ 26%]
tests/integration/test_backend_api_roles.py::test_get_routes_require_auth[/api/portfolio] PASSED [ 27%]
tests/integration/test_backend_api_roles.py::test_get_routes_require_auth[/api/positions] PASSED [ 27%]
tests/integration/test_backend_api_roles.py::test_get_routes_require_auth[/api/trades] PASSED [ 27%]
tests/integration/test_backend_api_roles.py::test_protected_get_routes_accept_user_token ERROR [ 27%]
tests/integration/test_backend_api_roles.py::test_strategy_actions_require_auth PASSED [ 27%]
tests/integration/test_backend_api_roles.py::test_strategy_actions_accept_user_token ERROR [ 28%]
tests/integration/test_backend_api_roles.py::test_malformed_and_expired_tokens_are_rejected ERROR [ 28%]
tests/integration/test_backend_api_roles.py::test_logs_restricted_to_admin ERROR [ 28%]
tests/integration/test_backend_api_roles.py::test_logs_returns_503_when_store_unavailable ERROR [ 28%]
tests/integration/test_full_paper_trading_loop.py::test_process_symbol_invokes_signal_handler FAILED [ 28%]
tests/integration/test_health_and_metrics_stack.py::test_backend_metrics_endpoint_includes_components FAILED [ 29%]
tests/integration/test_health_and_metrics_stack.py::test_metrics_collector_emits_prometheus_text PASSED [ 29%]
tests/market_data_ingestion/test_api_routes.py::test_health_check_reports_service_name FAILED [ 29%]
tests/market_data_ingestion/test_api_routes.py::test_readiness_check_queries_database FAILED [ 29%]
tests/market_data_ingestion/test_api_routes.py::test_readiness_check_propagates_errors FAILED [ 30%]
tests/market_data_ingestion/test_api_routes.py::test_get_candles_returns_payload FAILED [ 30%]
tests/market_data_ingestion/test_api_routes.py::test_get_candles_raises_when_no_data FAILED [ 30%]
tests/market_data_ingestion/test_backfill_cli.py::test_backfill_api_command_executes FAILED [ 30%]
tests/market_data_ingestion/test_backfill_cli.py::test_backfill_csv_command_ingests FAILED [ 30%]
tests/market_data_ingestion/test_backfill_cli.py::test_replay_dlq_command_invokes_handler FAILED [ 31%]
tests/market_data_ingestion/test_bar_builders.py::test_candle_aggregator_emits_payload_for_each_interval FAILED [ 31%]
tests/market_data_ingestion/test_bar_builders.py::test_tick_aggregator_flushes_all_intervals FAILED [ 31%]
tests/market_data_ingestion/test_scheduler_and_retries.py::test_seconds_until_next_run_is_positive PASSED [ 31%]
tests/market_data_ingestion/test_scheduler_and_retries.py::test_trigger_refresh_invokes_backfill FAILED [ 31%]
tests/market_data_ingestion/test_source_adapters_equities.py::test_yfinance_normalize_data_produces_chronological_payload PASSED [ 32%]
tests/market_data_ingestion/test_source_adapters_equities.py::test_fetch_historical_data_invokes_rate_limit FAILED [ 32%]
tests/market_data_ingestion/test_source_adapters_mcxticks.py::test_kite_adapter_normalizes_ticks FAILED [ 32%]
tests/market_data_ingestion/test_source_adapters_mcxticks.py::test_process_message_returns_none_for_invalid_json FAILED [ 32%]
tests/market_data_ingestion/test_source_adapters_mcxticks.py::test_process_message_uses_normalizer FAILED [ 32%]
tests/market_data_ingestion/test_storage_parquet_postgres.py::test_postgres_connection_uses_asyncpg_pool FAILED [ 33%]
tests/market_data_ingestion/test_storage_parquet_postgres.py::test_sqlite_candles_can_be_dumped_to_parquet FAILED [ 33%]
tests/performance/test_candles_latency.py::test_candles_under_150ms SKIPPED [ 33%]
tests/performance/test_ingestion_performance.py::TestStoragePerformance::test_bulk_insert_performance ERROR [ 33%]
tests/performance/test_ingestion_performance.py::TestStoragePerformance::test_fetch_performance ERROR [ 33%]
tests/performance/test_ingestion_performance.py::TestAggregatorPerformance::test_tick_aggregation_performance FAILED [ 34%]
tests/performance/test_ingestion_performance.py::TestAggregatorPerformance::test_multi_symbol_aggregation_performance FAILED [ 34%]
tests/performance/test_ingestion_performance.py::TestEndToEndPerformance::test_full_pipeline_performance ERROR [ 34%]
tests/performance/test_ingestion_performance.py::TestConcurrentOperations::test_concurrent_inserts ERROR [ 34%]
tests/risk/test_exposure_limits.py::test_position_size_for_risk_respects_lot_size PASSED [ 34%]
tests/risk/test_exposure_limits.py::test_can_open_new_position_honours_open_position_limit PASSED [ 35%]
tests/risk/test_order_block_rules.py::test_circuit_breaker_blocks_orders_after_loss PASSED [ 35%]
tests/risk/test_var_and_drawdown.py::test_can_open_trade_respects_risk_per_trade FAILED [ 35%]
tests/risk/test_var_and_drawdown.py::test_register_trade_updates_drawdown PASSED [ 35%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_basic_args PASSED [ 35%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_invalid_service PASSED [ 36%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_config_file PASSED [ 36%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_parallel_flag PASSED [ 36%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_log_file PASSED   [ 36%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_debug_flag PASSED [ 36%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_reload_flag PASSED [ 37%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_timeout_option PASSED [ 37%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_help_text PASSED  [ 37%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_version PASSED    [ 37%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_verbose_mode PASSED [ 37%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_quiet_mode PASSED [ 38%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_combined_flags PASSED [ 38%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_environment_override PASSED [ 38%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_custom_port PASSED [ 38%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_invalid_port PASSED [ 38%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_file_not_found PASSED [ 39%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_permission_denied PASSED [ 39%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_output_format PASSED [ 39%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_dry_run PASSED    [ 39%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_force_restart PASSED [ 40%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_error_recovery PASSED [ 40%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_interrupt_handling PASSED [ 40%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_resource_limits PASSED [ 40%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_plugin_loading PASSED [ 40%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_custom_command PASSED [ 41%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_subcommand_parsing PASSED [ 41%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_secure_flags PASSED [ 41%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_authentication PASSED [ 41%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_encryption PASSED [ 41%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_performance_flags PASSED [ 42%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_monitoring PASSED [ 42%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_logging_config PASSED [ 42%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_user_friendly_errors PASSED [ 42%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_auto_completion PASSED [ 42%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_alert_system PASSED [ 43%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_notification_system PASSED [ 43%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_log_aggregation PASSED [ 43%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_log_analysis PASSED [ 43%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_log_visualization PASSED [ 43%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_backup PASSED     [ 44%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_restore PASSED    [ 44%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_disaster_recovery PASSED [ 44%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_horizontal_scaling PASSED [ 44%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_vertical_scaling PASSED [ 44%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_auto_scaling PASSED [ 45%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_redundancy PASSED [ 45%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_failover PASSED   [ 45%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_health_check PASSED [ 45%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_resource_optimization PASSED [ 45%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_performance_tuning PASSED [ 46%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_cache_management PASSED [ 46%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_api_gateway PASSED [ 46%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_service_mesh PASSED [ 46%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_microservices PASSED [ 46%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_encryption_at_rest PASSED [ 47%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_encryption_in_transit PASSED [ 47%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_access_control PASSED [ 47%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_gdpr_compliance PASSED [ 47%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_hipaa_compliance PASSED [ 47%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_soc2_compliance PASSED [ 48%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_user_analytics PASSED [ 48%]
tests/scripts/test_cli_parsers.py::test_dev_run_parser_business_intelligence PASSED [ 48%]
tests/scripts/test_dev_run_entrypoints.py::test_dev_run_backend_entrypoint FAILED [ 48%]
tests/scripts/test_dev_run_entrypoints.py::test_dev_run_ingestion_entrypoint FAILED [ 48%]
tests/scripts/test_dev_run_entrypoints.py::test_dev_run_engine_entrypoint FAILED [ 49%]
tests/scripts/test_dev_run_entrypoints.py::test_dev_run_invalid_service PASSED [ 49%]
tests/scripts/test_dev_run_entrypoints.py::test_dev_run_with_config_file FAILED [ 49%]
tests/scripts/test_dev_run_entrypoints.py::test_dev_run_environment_variables FAILED [ 49%]
tests/scripts/test_dev_run_entrypoints.py::test_dev_run_shutdown_signal_handling FAILED [ 50%]
tests/scripts/test_dev_run_entrypoints.py::test_dev_run_process_monitoring FAILED [ 50%]
tests/scripts/test_dev_run_entrypoints.py::test_dev_run_log_file_output FAILED [ 50%]
tests/scripts/test_dev_run_entrypoints.py::test_dev_run_multiple_services FAILED [ 50%]
tests/scripts/test_dev_run_entrypoints.py::test_dev_run_dependency_check FAILED [ 50%]
tests/scripts/test_dev_run_entrypoints.py::test_dev_run_dependency_failure FAILED [ 51%]
tests/scripts/test_dev_run_entrypoints.py::test_dev_run_health_check FAILED [ 51%]
tests/scripts/test_dev_run_entrypoints.py::test_dev_run_health_check_timeout FAILED [ 51%]
tests/scripts/test_dev_run_entrypoints.py::test_dev_run_reload_on_file_change FAILED [ 51%]
tests/scripts/test_dev_run_entrypoints.py::test_dev_run_debug_mode FAILED [ 51%]
tests/scripts/test_dev_run_entrypoints.py::test_dev_run_profile_mode FAILED [ 52%]
tests/scripts/test_dev_run_entrypoints.py::test_dev_run_with_custom_python_path FAILED [ 52%]
tests/scripts/test_dev_run_entrypoints.py::test_dev_run_service_discovery FAILED [ 52%]
tests/scripts/test_dev_run_entrypoints.py::test_dev_run_cleanup_on_exit FAILED [ 52%]
tests/strategies/regression/test_ema_crossover_regression.py::test_regression_triggers_buy_then_flat FAILED [ 52%]
tests/strategies/regression/test_portfolio_regression.py::test_validate_strategy_returns_metrics PASSED [ 53%]
tests/strategies/test_ema_crossover_unit.py::test_strategy_emits_buy_and_sell_signals PASSED [ 53%]
tests/strategies/test_ema_crossover_unit.py::test_strategy_ignores_other_symbols PASSED [ 53%]
tests/strategies/test_mean_reversion_unit.py::test_mean_reversion_enters_and_exits PASSED [ 53%]
tests/strategies/test_options_spread_unit.py::test_option_writing_requires_extra_margin PASSED [ 53%]
tests/strategies/test_risk_overrides.py::test_validate_order_rejects_when_margin_missing FAILED [ 54%]
tests/strategies/test_risk_overrides.py::test_reduce_position_allowed_when_limit_reached PASSED [ 54%]
tests/test_api_market_data.py::TestHealthEndpoints::test_health_check FAILED [ 54%]
tests/test_api_market_data.py::TestHealthEndpoints::test_healthz_alias FAILED [ 54%]
tests/test_api_market_data.py::TestHealthEndpoints::test_readiness_check_success FAILED [ 54%]
tests/test_api_market_data.py::TestHealthEndpoints::test_readiness_check_failure FAILED [ 55%]
tests/test_api_market_data.py::TestHealthEndpoints::test_readyz_alias FAILED [ 55%]
tests/test_api_market_data.py::TestMetricsEndpoint::test_get_metrics FAILED [ 55%]
tests/test_api_market_data.py::TestCandlesEndpoint::test_get_candles_success FAILED [ 55%]
tests/test_api_market_data.py::TestCandlesEndpoint::test_get_candles_no_data FAILED [ 55%]
tests/test_api_market_data.py::TestCandlesEndpoint::test_get_candles_db_error PASSED [ 56%]
tests/test_api_market_data.py::TestCandlesEndpoint::test_get_candles_missing_symbol FAILED [ 56%]
tests/test_api_market_data.py::TestCandlesEndpoint::test_get_candles_invalid_limit FAILED [ 56%]
tests/test_api_market_data.py::TestSymbolsEndpoint::test_get_symbols_success FAILED [ 56%]
tests/test_api_market_data.py::TestSymbolsEndpoint::test_get_symbols_empty FAILED [ 56%]
tests/test_api_market_data.py::TestSymbolsEndpoint::test_get_symbols_db_error FAILED [ 57%]
tests/test_api_market_data.py::TestAuthEndpoints::test_register_success PASSED [ 57%]
tests/test_api_market_data.py::TestAuthEndpoints::test_register_existing_user PASSED [ 57%]
tests/test_api_market_data.py::TestAuthEndpoints::test_register_invalid_email FAILED [ 57%]
tests/test_api_market_data.py::TestAuthEndpoints::test_register_weak_password FAILED [ 57%]
tests/test_api_market_data.py::TestAuthEndpoints::test_login_success PASSED [ 58%]
tests/test_api_market_data.py::TestAuthEndpoints::test_login_invalid_credentials PASSED [ 58%]
tests/test_api_market_data.py::TestAuthEndpoints::test_logout FAILED     [ 58%]
tests/test_api_market_data.py::TestIntegration::test_full_workflow FAILED [ 58%]
tests/test_config_loading.py::test_settings_loading_with_env_vars PASSED [ 58%]
tests/test_config_loading.py::test_database_url_construction FAILED      [ 59%]
tests/test_config_loading.py::test_database_url_fallback_to_sqlite FAILED [ 59%]
tests/test_config_loading.py::test_broker_config_loading FAILED          [ 59%]
tests/test_config_loading.py::test_risk_config_loading PASSED            [ 59%]
tests/test_config_loading.py::test_feature_flags_loading FAILED          [ 60%]
tests/test_config_loading.py::test_config_validation FAILED              [ 60%]
tests/test_config_loading.py::test_config_from_env_file FAILED           [ 60%]
tests/test_ema_crossover_strategy.py::test_strategy_initializes_defaults FAILED [ 60%]
tests/test_ema_crossover_strategy.py::test_strategy_emits_buy_and_sell_on_crossovers FAILED [ 60%]
tests/test_ema_crossover_strategy.py::test_strategy_returns_none_when_no_crossover FAILED [ 61%]
tests/test_ema_crossover_strategy.py::test_ema_values_progress_over_time FAILED [ 61%]
tests/test_ema_strategy.py::test_ema_crossover_emits_signals_on_cross FAILED [ 61%]
tests/test_env_modes.py::test_finbot_mode_valid_values FAILED            [ 61%]
tests/test_env_modes.py::test_finbot_mode_invalid_value_raises_error FAILED [ 61%]
tests/test_env_modes.py::test_live_mode_requires_confirmation FAILED     [ 62%]
tests/test_env_modes.py::test_env_file_loading FAILED                    [ 62%]
tests/test_env_modes.py::test_safety_audit_script FAILED                 [ 62%]
tests/test_execution_brokers.py::test_mock_broker_fills_market_orders PASSED [ 62%]
tests/test_execution_brokers.py::test_mock_broker_cancel PASSED          [ 62%]
tests/test_full_pipeline.py::test_full_pipeline_intraday_ema_with_mock_broker FAILED [ 63%]
tests/test_health_endpoints.py::test_health_endpoint_returns_200 PASSED  [ 63%]
tests/test_health_endpoints.py::test_health_endpoint_includes_service_status PASSED [ 63%]
tests/test_health_endpoints.py::test_health_endpoint_includes_database_status PASSED [ 63%]
tests/test_health_endpoints.py::test_health_endpoint_includes_external_apis PASSED [ 63%]
tests/test_health_endpoints.py::test_health_endpoint_degraded_when_services_unhealthy PASSED [ 64%]
tests/test_health_endpoints.py::test_ready_endpoint_alias FAILED         [ 64%]
tests/test_health_endpoints.py::test_live_endpoint_alias FAILED          [ 64%]
tests/test_health_endpoints.py::test_api_health_endpoint FAILED          [ 64%]
tests/test_health_endpoints.py::test_health_endpoint_handles_database_connection_failure PASSED [ 64%]
tests/test_health_endpoints.py::test_health_endpoint_handles_external_api_timeout PASSED [ 65%]
tests/test_health_endpoints.py::test_health_endpoint_version_info PASSED [ 65%]
tests/test_health_endpoints.py::test_health_endpoint_timestamp_format FAILED [ 65%]
tests/test_health_endpoints.py::test_health_endpoint_cache_dependency_check FAILED [ 65%]
tests/test_health_endpoints.py::test_health_endpoint_with_missing_services PASSED [ 65%]
tests/test_ingestion_candles.py::test_normalize_to_candles_orders_and_filters_future PASSED [ 66%]
tests/test_ingestion_candles.py::test_normalize_handles_empty_and_duplicates PASSED [ 66%]
tests/test_ingestion_candles.py::test_normalize_rejects_missing_fields PASSED [ 66%]
tests/test_llm_signal_parsing.py::test_llm_signal_model_accepts_valid_payload PASSED [ 66%]
tests/test_llm_signal_parsing.py::test_llm_signal_model_rejects_invalid_values PASSED [ 66%]
tests/test_llm_signal_parsing.py::test_signal_ai_parses_json_and_handles_bad_output PASSED [ 67%]
tests/test_logging_and_metrics.py::test_metrics_endpoint_returns_valid_json FAILED [ 67%]
tests/test_logging_and_metrics.py::test_metrics_endpoint_includes_uptime FAILED [ 67%]
tests/test_logging_and_metrics.py::test_metrics_endpoint_includes_trade_stream_info FAILED [ 67%]
tests/test_logging_and_metrics.py::test_metrics_endpoint_includes_dependencies_health FAILED [ 67%]
tests/test_logging_and_metrics.py::test_logs_endpoint_returns_structured_logs FAILED [ 68%]
tests/test_logging_and_metrics.py::test_logs_endpoint_filters_by_level FAILED [ 68%]
tests/test_logging_and_metrics.py::test_logs_endpoint_limits_results FAILED [ 68%]
tests/test_logging_and_metrics.py::test_logs_endpoint_pagination_with_since_until FAILED [ 68%]
tests/test_logging_and_metrics.py::test_logs_endpoint_masks_sensitive_data FAILED [ 68%]
tests/test_logging_and_metrics.py::test_logs_endpoint_handles_missing_log_file FAILED [ 69%]
tests/test_logging_and_metrics.py::test_logs_endpoint_handles_corrupt_log_file FAILED [ 69%]
tests/test_logging_and_metrics.py::test_logger_service_metrics_collection PASSED [ 69%]
tests/test_logging_and_metrics.py::test_prometheus_metrics_format PASSED [ 69%]
tests/test_risk_engine.py::test_daily_loss_circuit_breaker_blocks_orders PASSED [ 70%]
tests/test_risk_engine.py::test_max_open_positions_enforced PASSED       [ 70%]
tests/test_risk_engine.py::test_position_size_for_risk_respects_lot_size PASSED [ 70%]
tests/test_risk_engine.py::test_margin_check_blocks_when_insufficient PASSED [ 70%]
tests/test_risk_manager.py::test_circuit_breaker_triggers_and_rejects PASSED [ 70%]
tests/test_risk_manager.py::test_max_open_positions_rejects_new_open PASSED [ 71%]
tests/test_risk_manager.py::test_position_size_for_risk_calculates_expected PASSED [ 71%]
tests/test_risk_manager.py::test_margin_rejects_when_required_exceeds_available PASSED [ 71%]
tests/test_stock_scraper.py::test_detects_volume_spike_anomaly FAILED    [ 71%]
tests/trading_engine/test_backtest_runner.py::test_run_backtest_produces_result FAILED [ 71%]
tests/trading_engine/test_live_safety_guards.py::test_volatility_adjustment_clamps_multiplier PASSED [ 72%]
tests/trading_engine/test_live_safety_guards.py::test_trading_halt_flag PASSED [ 72%]
tests/trading_engine/test_live_safety_guards.py::test_circuit_breaker_opens_after_failures FAILED [ 72%]
tests/trading_engine/test_order_lifecycle.py::test_market_buy_order_reduces_cash PASSED [ 72%]
tests/trading_engine/test_order_lifecycle.py::test_sell_rejected_without_position PASSED [ 72%]
tests/trading_engine/test_paper_engine_adapter.py::test_get_paper_engine_is_user_scoped PASSED [ 73%]
tests/trading_engine/test_paper_engine_adapter.py::test_reset_portfolio_clears_state PASSED [ 73%]
tests/trading_engine/test_position_accounting.py::test_update_position_and_portfolio_value PASSED [ 73%]
tests/trading_engine/test_position_accounting.py::test_position_size_limit_breach_flags_risk PASSED [ 73%]
tests/trading_engine/test_signal_bus.py::test_strategy_manager_executes_loaded_strategy PASSED [ 73%]
tests/trading_engine/test_signal_bus.py::test_get_signal_strength_thresholds PASSED [ 74%]
tests/trading_engine/test_slippage_and_fees.py::test_execute_trade_applies_slippage_and_commission PASSED [ 74%]
tests/trading_engine/test_slippage_and_fees.py::test_sell_trade_using_slippage_discount PASSED [ 74%]
tests/unit/test_adapters.py::TestYFinanceAdapter::test_fetch_historical_data_success FAILED [ 74%]
tests/unit/test_adapters.py::TestYFinanceAdapter::test_fetch_historical_data_error FAILED [ 74%]
tests/unit/test_adapters.py::TestYFinanceAdapter::test_realtime_connect_not_implemented FAILED [ 75%]
tests/unit/test_adapters.py::TestYFinanceAdapter::test_normalize_data PASSED [ 75%]
tests/unit/test_adapters.py::TestAlphaVantageAdapter::test_fetch_historical_data_daily FAILED [ 75%]
tests/unit/test_adapters.py::TestAlphaVantageAdapter::test_fetch_historical_data_intraday FAILED [ 75%]
tests/unit/test_adapters.py::TestAlphaVantageAdapter::test_fetch_historical_data_error FAILED [ 75%]
tests/unit/test_adapters.py::TestAlphaVantageAdapter::test_realtime_connect_not_implemented FAILED [ 76%]
tests/unit/test_adapters.py::TestAlphaVantageAdapter::test_context_manager FAILED [ 76%]
tests/unit/test_adapters.py::TestKiteWebSocketAdapter::test_authenticate ERROR [ 76%]
tests/unit/test_adapters.py::TestKiteWebSocketAdapter::test_subscribe ERROR [ 76%]
tests/unit/test_adapters.py::TestKiteWebSocketAdapter::test_context_manager ERROR [ 76%]
tests/unit/test_adapters.py::TestKiteWebSocketAdapter::test_process_message_tick ERROR [ 77%]
tests/unit/test_ai_pipeline.py::test_pipeline_blocks_jailbreak FAILED    [ 77%]
tests/unit/test_ai_pipeline.py::test_pipeline_returns_grounded_answer FAILED [ 77%]
tests/unit/test_ai_safety.py::test_safety_filter_blocks_overconfident_low_confidence_response PASSED [ 77%]
tests/unit/test_ai_safety.py::test_safety_filter_detects_unsafe_language PASSED [ 77%]
tests/unit/test_ai_safety.py::test_process_prompt_propagates_disclaimer_in_mock_mode PASSED [ 78%]
tests/unit/test_backtester_event_engine.py::test_event_backtester_runs_with_costs PASSED [ 78%]
tests/unit/test_backtester_event_engine.py::test_walk_forward_runner_yields_multiple_windows PASSED [ 78%]
tests/unit/test_cli.py::TestBackfillCommand::test_backfill_with_symbols FAILED [ 78%]
tests/unit/test_cli.py::TestBackfillCommand::test_backfill_with_csv FAILED [ 78%]
tests/unit/test_cli.py::TestBackfillCommand::test_backfill_no_symbols FAILED [ 79%]
tests/unit/test_cli.py::TestRealtimeCommand::test_realtime_with_mock_provider FAILED [ 79%]
tests/unit/test_cli.py::TestMigrateCommand::test_migrate_success FAILED  [ 79%]
tests/unit/test_cli.py::TestLoadSymbolsFromCSV::test_load_symbols_from_csv_success PASSED [ 79%]
tests/unit/test_cli.py::TestLoadSymbolsFromCSV::test_load_symbols_from_csv_invalid_file PASSED [ 80%]
tests/unit/test_cli.py::TestLoadSymbolsFromCSV::test_load_symbols_from_csv_empty_file PASSED [ 80%]
tests/unit/test_env_utils.py::test_expand_env_vars_replaces_nested_placeholders PASSED [ 80%]
tests/unit/test_env_utils.py::test_expand_env_vars_supports_default PASSED [ 80%]
tests/unit/test_env_utils.py::test_expand_env_vars_preserves_placeholder_when_missing PASSED [ 80%]
tests/unit/test_env_utils.py::test_expand_env_vars_handles_path_objects PASSED [ 81%]
tests/unit/test_indicators.py::TestRSI::test_rsi_calculation PASSED      [ 81%]
tests/unit/test_indicators.py::TestRSI::test_rsi_insufficient_data PASSED [ 81%]
tests/unit/test_indicators.py::TestRSI::test_rsi_signal_generation PASSED [ 81%]
tests/unit/test_indicators.py::TestMACD::test_macd_calculation PASSED    [ 81%]
tests/unit/test_indicators.py::TestMACD::test_macd_insufficient_data PASSED [ 82%]
tests/unit/test_indicators.py::TestMACD::test_macd_signal_generation PASSED [ 82%]
tests/unit/test_indicators.py::TestBollingerBands::test_bb_calculation PASSED [ 82%]
tests/unit/test_indicators.py::TestBollingerBands::test_bb_signal_generation PASSED [ 82%]
tests/unit/test_indicators.py::TestSMA::test_sma_calculation PASSED      [ 82%]
tests/unit/test_indicators.py::TestSMA::test_sma_insufficient_data PASSED [ 83%]
tests/unit/test_indicators.py::TestEMA::test_ema_calculation PASSED      [ 83%]
tests/unit/test_indicators.py::TestStochasticOscillator::test_stoch_calculation PASSED [ 83%]
tests/unit/test_indicators.py::TestWilliamsR::test_williams_calculation PASSED [ 83%]
tests/unit/test_indicators.py::TestCCI::test_cci_calculation PASSED      [ 83%]
tests/unit/test_indicators.py::TestADX::test_adx_calculation PASSED      [ 84%]
tests/unit/test_indicators.py::TestATR::test_atr_calculation PASSED      [ 84%]
tests/unit/test_indicators.py::TestVWAP::test_vwap_calculation PASSED    [ 84%]
tests/unit/test_ingest_risk_strategy_llm.py::test_historical_loader_filters_by_dates PASSED [ 84%]
tests/unit/test_ingest_risk_strategy_llm.py::test_risk_manager_blocks_after_daily_loss PASSED [ 84%]
tests/unit/test_ingest_risk_strategy_llm.py::test_ema_crossover_emits_buy_and_flat PASSED [ 85%]
tests/unit/test_ingest_risk_strategy_llm.py::test_signal_ai_parses_valid_llm_json PASSED [ 85%]
tests/unit/test_ingest_risk_strategy_llm.py::test_signal_ai_falls_back_on_parse_error PASSED [ 85%]
tests/unit/test_logging_manager.py::test_read_logs_raises_when_missing PASSED [ 85%]
tests/unit/test_logging_manager.py::test_read_logs_raises_when_unreadable PASSED [ 85%]
tests/unit/test_models.py::test_candle_creation PASSED                   [ 86%]
tests/unit/test_models.py::test_candle_values_are_numeric PASSED         [ 86%]
tests/unit/test_models.py::test_candle_symbol_is_string PASSED           [ 86%]
tests/unit/test_models.py::test_candle_provider_is_string PASSED         [ 86%]
tests/unit/test_models.py::test_candle_meta_is_dict PASSED               [ 86%]
tests/unit/test_normalizer.py::TestDataNormalizer::test_normalize_trade_success PASSED [ 87%]
tests/unit/test_normalizer.py::TestDataNormalizer::test_normalize_trade_missing_required_fields PASSED [ 87%]
tests/unit/test_normalizer.py::TestDataNormalizer::test_normalize_trade_invalid_data PASSED [ 87%]
tests/unit/test_normalizer.py::TestDataNormalizer::test_normalize_quote_success PASSED [ 87%]
tests/unit/test_normalizer.py::TestDataNormalizer::test_normalize_quote_with_none_values PASSED [ 87%]
tests/unit/test_normalizer.py::TestDataNormalizer::test_normalize_candle_success PASSED [ 88%]
tests/unit/test_normalizer.py::TestDataNormalizer::test_normalize_trades_batch PASSED [ 88%]
tests/unit/test_normalizer.py::TestDataNormalizer::test_normalize_quotes_batch PASSED [ 88%]
tests/unit/test_normalizer.py::TestDataNormalizer::test_normalize_candles_batch PASSED [ 88%]
tests/unit/test_phase4_trading_engine.py::test_risk_manager_resizes_orders PASSED [ 88%]
tests/unit/test_phase4_trading_engine.py::test_strategy_circuit_breaker_triggers_on_losses PASSED [ 89%]
tests/unit/test_phase4_trading_engine.py::test_backtest_runs_with_ema_strategy PASSED [ 89%]
tests/unit/test_project_report.py::test_parse_tasks_with_sections PASSED [ 89%]
tests/unit/test_project_report.py::test_build_report_includes_summary_and_pending_items PASSED [ 89%]
tests/unit/test_storage.py::TestDataStorage::test_connect_sqlite FAILED  [ 90%]
tests/unit/test_storage.py::TestDataStorage::test_create_tables ERROR    [ 90%]
tests/unit/test_storage.py::TestDataStorage::test_insert_candle ERROR    [ 90%]
tests/unit/test_storage.py::TestDataStorage::test_insert_duplicate_candle ERROR [ 90%]
tests/unit/test_storage.py::TestDataStorage::test_fetch_last_n_candles ERROR [ 90%]
tests/unit/test_storage.py::TestDataStorage::test_fetch_last_n_candles_empty ERROR [ 91%]
tests/unit/test_storage.py::TestDataStorage::test_fetch_last_n_candles_different_symbols ERROR [ 91%]
tests/unit/test_storage.py::TestDataStorage::test_health_check_success ERROR [ 91%]
tests/unit/test_storage.py::TestDataStorage::test_health_check_failure FAILED [ 91%]
tests/unit/test_storage.py::TestDataStorage::test_disconnect FAILED      [ 91%]
tests/unit/test_tick_aggregator.py::test_candle_aggregation_emits_expected_payloads FAILED [ 92%]
tests/unit/test_time_utils.py::TestTimeUtils::test_generate_time_chunks PASSED [ 92%]
tests/unit/test_time_utils.py::TestTimeUtils::test_generate_time_chunks_single_chunk PASSED [ 92%]
tests/unit/test_time_utils.py::TestTimeUtils::test_align_to_granularity_minutes PASSED [ 92%]
tests/unit/test_time_utils.py::TestTimeUtils::test_align_to_granularity_zero PASSED [ 92%]
tests/unit/test_time_utils.py::TestTimeUtils::test_get_candle_bucket_start_minute PASSED [ 93%]
tests/unit/test_time_utils.py::TestTimeUtils::test_get_candle_bucket_start_hour PASSED [ 93%]
tests/unit/test_time_utils.py::TestTimeUtils::test_get_candle_bucket_start_day PASSED [ 93%]
tests/unit/test_time_utils.py::TestTimeUtils::test_get_candle_bucket_start_invalid_granularity PASSED [ 93%]
tests/unit/test_time_utils.py::TestTimeUtils::test_parse_granularity_minutes PASSED [ 93%]
tests/unit/test_time_utils.py::TestTimeUtils::test_parse_granularity_hours PASSED [ 94%]
tests/unit/test_time_utils.py::TestTimeUtils::test_parse_granularity_days PASSED [ 94%]
tests/unit/test_time_utils.py::TestTimeUtils::test_parse_granularity_invalid PASSED [ 94%]
tests/unit/test_time_utils.py::TestTimeUtils::test_is_market_hours_weekday_during_hours PASSED [ 94%]
tests/unit/test_time_utils.py::TestTimeUtils::test_is_market_hours_weekend PASSED [ 94%]
tests/unit/test_time_utils.py::TestTimeUtils::test_is_market_hours_before_open PASSED [ 95%]
tests/unit/test_time_utils.py::TestTimeUtils::test_is_market_hours_after_close PASSED [ 95%]
tests/unit/test_trading_engine.py::TestStrategyManager::test_activate_deactivate_strategy PASSED [ 95%]
tests/unit/test_trading_engine.py::TestStrategyManager::test_execute_strategy PASSED [ 95%]
tests/unit/test_trading_engine.py::TestStrategyManager::test_load_strategy PASSED [ 95%]
tests/unit/test_trading_engine.py::TestAdaptiveRSIMACDStrategy::test_initialization PASSED [ 96%]
tests/unit/test_trading_engine.py::TestAdaptiveRSIMACDStrategy::test_rsi_calculation PASSED [ 96%]
tests/unit/test_trading_engine.py::TestAdaptiveRSIMACDStrategy::test_signal_generation PASSED [ 96%]
tests/unit/test_trading_engine.py::TestPortfolioManager::test_initialization PASSED [ 96%]
tests/unit/test_trading_engine.py::TestPortfolioManager::test_portfolio_value_calculation PASSED [ 96%]
tests/unit/test_trading_engine.py::TestPortfolioManager::test_risk_limits PASSED [ 97%]
tests/unit/test_trading_engine.py::TestPortfolioManager::test_update_position PASSED [ 97%]
tests/unit/test_trading_engine.py::TestBacktester::test_initialization PASSED [ 97%]
tests/unit/test_trading_engine.py::TestBacktester::test_run_backtest PASSED [ 97%]
tests/unit/test_trading_engine.py::TestLiveTradingEngine::test_calculate_position_size PASSED [ 97%]
tests/unit/test_trading_engine.py::TestLiveTradingEngine::test_check_signal_risk_limits PASSED [ 98%]
tests/unit/test_trading_engine.py::TestLiveTradingEngine::test_generate_mock_data PASSED [ 98%]
tests/unit/test_trading_engine.py::TestLiveTradingEngine::test_get_engine_status PASSED [ 98%]
tests/unit/test_trading_engine.py::TestLiveTradingEngine::test_get_execution_history PASSED [ 98%]
tests/unit/test_trading_engine.py::TestLiveTradingEngine::test_initialization PASSED [ 98%]
tests/unit/test_trading_engine.py::TestStructuredLogger::test_log_entry PASSED [ 99%]
tests/unit/test_trading_engine.py::TestStructuredLogger::test_performance_logging PASSED [ 99%]
tests/unit/test_trading_engine.py::TestIntegration::test_error_handling PASSED [ 99%]
tests/unit/test_trading_engine.py::TestIntegration::test_live_engine_data_flow PASSED [ 99%]
tests/unit/test_trading_engine.py::TestIntegration::test_strategy_to_portfolio_integration PASSED [100%]

==================================== ERRORS ====================================
________ ERROR at teardown of test_paper_trading_edge_cases_and_errors _________
tests/e2e/test_paper_trading_e2e.py:29: in client
    with TestClient(app) as test_client:
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:756: in __exit__
    self.exit_stack.close()
/usr/lib/python3.12/contextlib.py:618: in close
    self.__exit__(None, None, None)
/usr/lib/python3.12/contextlib.py:610: in __exit__
    raise exc_details[1]
/usr/lib/python3.12/contextlib.py:595: in __exit__
    if cb(*exc_details):
       ^^^^^^^^^^^^^^^^
/usr/lib/python3.12/contextlib.py:478: in _exit_wrapper
    callback(*args, **kwds)
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:749: in wait_shutdown
    portal.call(self.wait_shutdown)
/home/mohit/.local/lib/python3.12/site-packages/anyio/from_thread.py:277: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/concurrent/futures/_base.py:456: in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
/home/mohit/.local/lib/python3.12/site-packages/anyio/from_thread.py:217: in _call_func
    retval = await retval
             ^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:797: in wait_shutdown
    await receive()
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:786: in receive
    self.task.result()
/usr/lib/python3.12/concurrent/futures/_base.py:449: in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
/home/mohit/.local/lib/python3.12/site-packages/anyio/from_thread.py:217: in _call_func
    retval = await retval
             ^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:761: in lifespan
    await self.app(scope, self.stream_receive.receive, self.stream_send.send)
/home/mohit/.local/lib/python3.12/site-packages/fastapi/applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/errors.py:149: in __call__
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/base.py:26: in __call__
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/cors.py:75: in __call__
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/base.py:26: in __call__
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:55: in __call__
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py:20: in __call__
    raise e
/home/mohit/.local/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:707: in __call__
    await self.lifespan(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:677: in lifespan
    async with self.lifespan_context(app) as maybe_state:
/usr/lib/python3.12/contextlib.py:217: in __aexit__
    await anext(self.gen)
backend/api/main.py:170: in lifespan
    await scheduler.stop()
backend/core/news_pipeline.py:347: in stop
    await self._task
backend/core/news_pipeline.py:357: in _run_loop
    await asyncio.wait_for(self._stop_event.wait(), timeout=wait_seconds)
/usr/lib/python3.12/asyncio/tasks.py:520: in wait_for
    return await fut
           ^^^^^^^^^
/usr/lib/python3.12/asyncio/locks.py:209: in wait
    fut = self._get_loop().create_future()
          ^^^^^^^^^^^^^^^^
/usr/lib/python3.12/asyncio/mixins.py:20: in _get_loop
    raise RuntimeError(f'{self!r} is bound to a different event loop')
E   RuntimeError: <asyncio.locks.Event object at 0x77681c447ec0 [unset]> is bound to a different event loop
---------------------------- Captured stdout setup -----------------------------
2025-12-06 15:20:43 | INFO | backend.core.news_pipeline | News publishing scheduler started | trace_id=-
------------------------------ Captured log setup ------------------------------
INFO     backend.core.news_pipeline:news_pipeline.py:342 News publishing scheduler started
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:43 | WARNING | backend.api.main | Slow response /api/auth/login: 239.39ms | trace_id=-
2025-12-06 15:20:43 | INFO | httpx | HTTP Request: POST http://testserver/api/auth/login "HTTP/1.1 200 OK" | trace_id=-
2025-12-06 15:20:43 | INFO | trading_engine.paper_trading | Paper trading portfolio reset with $10.00 | trace_id=-
2025-12-06 15:20:43 | INFO | httpx | HTTP Request: POST http://testserver/paper-trading/reset "HTTP/1.1 200 OK" | trace_id=-
2025-12-06 15:20:43 | INFO | httpx | HTTP Request: POST http://testserver/paper-trading/place-order "HTTP/1.1 400 Bad Request" | trace_id=-
2025-12-06 15:20:43 | INFO | httpx | HTTP Request: POST http://testserver/paper-trading/place-order "HTTP/1.1 400 Bad Request" | trace_id=-
2025-12-06 15:20:43 | INFO | httpx | HTTP Request: POST http://testserver/paper-trading/place-order "HTTP/1.1 400 Bad Request" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.api.main:main.py:209 Slow response /api/auth/login: 239.39ms
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/auth/login "HTTP/1.1 200 OK"
INFO     trading_engine.paper_trading:paper_trading.py:376 Paper trading portfolio reset with $10.00
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/paper-trading/reset "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/paper-trading/place-order "HTTP/1.1 400 Bad Request"
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/paper-trading/place-order "HTTP/1.1 400 Bad Request"
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/paper-trading/place-order "HTTP/1.1 400 Bad Request"
________ ERROR at teardown of test_paper_trading_limit_and_stop_orders _________
tests/e2e/test_paper_trading_e2e.py:29: in client
    with TestClient(app) as test_client:
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:756: in __exit__
    self.exit_stack.close()
/usr/lib/python3.12/contextlib.py:618: in close
    self.__exit__(None, None, None)
/usr/lib/python3.12/contextlib.py:610: in __exit__
    raise exc_details[1]
/usr/lib/python3.12/contextlib.py:595: in __exit__
    if cb(*exc_details):
       ^^^^^^^^^^^^^^^^
/usr/lib/python3.12/contextlib.py:478: in _exit_wrapper
    callback(*args, **kwds)
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:749: in wait_shutdown
    portal.call(self.wait_shutdown)
/home/mohit/.local/lib/python3.12/site-packages/anyio/from_thread.py:277: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/concurrent/futures/_base.py:456: in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
/home/mohit/.local/lib/python3.12/site-packages/anyio/from_thread.py:217: in _call_func
    retval = await retval
             ^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:797: in wait_shutdown
    await receive()
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:786: in receive
    self.task.result()
/usr/lib/python3.12/concurrent/futures/_base.py:449: in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
/home/mohit/.local/lib/python3.12/site-packages/anyio/from_thread.py:217: in _call_func
    retval = await retval
             ^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:761: in lifespan
    await self.app(scope, self.stream_receive.receive, self.stream_send.send)
/home/mohit/.local/lib/python3.12/site-packages/fastapi/applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/errors.py:149: in __call__
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/base.py:26: in __call__
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/cors.py:75: in __call__
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/base.py:26: in __call__
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:55: in __call__
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py:20: in __call__
    raise e
/home/mohit/.local/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:707: in __call__
    await self.lifespan(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:677: in lifespan
    async with self.lifespan_context(app) as maybe_state:
/usr/lib/python3.12/contextlib.py:217: in __aexit__
    await anext(self.gen)
backend/api/main.py:170: in lifespan
    await scheduler.stop()
backend/core/news_pipeline.py:347: in stop
    await self._task
backend/core/news_pipeline.py:357: in _run_loop
    await asyncio.wait_for(self._stop_event.wait(), timeout=wait_seconds)
/usr/lib/python3.12/asyncio/tasks.py:520: in wait_for
    return await fut
           ^^^^^^^^^
/usr/lib/python3.12/asyncio/locks.py:209: in wait
    fut = self._get_loop().create_future()
          ^^^^^^^^^^^^^^^^
/usr/lib/python3.12/asyncio/mixins.py:20: in _get_loop
    raise RuntimeError(f'{self!r} is bound to a different event loop')
E   RuntimeError: <asyncio.locks.Event object at 0x77681c447ec0 [unset]> is bound to a different event loop
---------------------------- Captured stdout setup -----------------------------
2025-12-06 15:20:44 | INFO | backend.core.news_pipeline | News publishing scheduler started | trace_id=-
------------------------------ Captured log setup ------------------------------
INFO     backend.core.news_pipeline:news_pipeline.py:342 News publishing scheduler started
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:44 | WARNING | backend.api.main | Slow response /api/auth/login: 245.83ms | trace_id=-
2025-12-06 15:20:44 | INFO | httpx | HTTP Request: POST http://testserver/api/auth/login "HTTP/1.1 200 OK" | trace_id=-
2025-12-06 15:20:44 | INFO | trading_engine.paper_trading | Paper trading portfolio reset with $10,000.00 | trace_id=-
2025-12-06 15:20:44 | INFO | httpx | HTTP Request: POST http://testserver/paper-trading/reset "HTTP/1.1 200 OK" | trace_id=-
2025-12-06 15:20:44 | INFO | trading_engine.paper_trading | Paper trade executed: AAPL buy 5.0 @ 110.0 | trace_id=-
2025-12-06 15:20:44 | INFO | httpx | HTTP Request: POST http://testserver/paper-trading/place-order "HTTP/1.1 200 OK" | trace_id=-
2025-12-06 15:20:44 | INFO | httpx | HTTP Request: POST http://testserver/paper-trading/place-order "HTTP/1.1 200 OK" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.api.main:main.py:209 Slow response /api/auth/login: 245.83ms
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/auth/login "HTTP/1.1 200 OK"
INFO     trading_engine.paper_trading:paper_trading.py:376 Paper trading portfolio reset with $10,000.00
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/paper-trading/reset "HTTP/1.1 200 OK"
INFO     trading_engine.paper_trading:paper_trading.py:317 Paper trade executed: AAPL buy 5.0 @ 110.0
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/paper-trading/place-order "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/paper-trading/place-order "HTTP/1.1 200 OK"
__ ERROR at setup of TestYFinanceAdapterIntegration.test_fetch_and_store_data __
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:353: in from_call
    result: TResult | None = func()
                             ^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:245: in <lambda>
    lambda: runtest_hook(item=item, **kwds),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/logging.py:843: in pytest_runtest_setup
    yield
/home/mohit/.local/lib/python3.12/site-packages/_pytest/capture.py:895: in pytest_runtest_setup
    return (yield)
            ^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:165: in pytest_runtest_setup
    item.session._setupstate.setup(item)
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:523: in setup
    col.setup()
/home/mohit/.local/lib/python3.12/site-packages/_pytest/python.py:1723: in setup
    self._request._fillfixtures()
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:707: in _fillfixtures
    item.funcargs[argname] = self.getfixturevalue(argname)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:539: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:627: in _get_active_fixturedef
    fixturedef.execute(request=subrequest)
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:1110: in execute
    result: FixtureValue = ihook.pytest_fixture_setup(
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup
    return (yield)
            ^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:1188: in pytest_fixture_setup
    warnings.warn(
E   pytest.PytestRemovedIn9Warning: 'test_fetch_and_store_data' requested an async fixture 'storage', with no plugin or hook that handled it. This is usually an error, as pytest does not natively support it. This will turn into an error in pytest 9.
E   See: https://docs.pytest.org/en/stable/deprecations.html#sync-test-depending-on-async-fixture
_ ERROR at setup of TestYFinanceAdapterIntegration.test_fetch_multiple_symbols _
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:353: in from_call
    result: TResult | None = func()
                             ^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:245: in <lambda>
    lambda: runtest_hook(item=item, **kwds),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/logging.py:843: in pytest_runtest_setup
    yield
/home/mohit/.local/lib/python3.12/site-packages/_pytest/capture.py:895: in pytest_runtest_setup
    return (yield)
            ^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:165: in pytest_runtest_setup
    item.session._setupstate.setup(item)
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:523: in setup
    col.setup()
/home/mohit/.local/lib/python3.12/site-packages/_pytest/python.py:1723: in setup
    self._request._fillfixtures()
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:707: in _fillfixtures
    item.funcargs[argname] = self.getfixturevalue(argname)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:539: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:627: in _get_active_fixturedef
    fixturedef.execute(request=subrequest)
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:1110: in execute
    result: FixtureValue = ihook.pytest_fixture_setup(
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup
    return (yield)
            ^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:1188: in pytest_fixture_setup
    warnings.warn(
E   pytest.PytestRemovedIn9Warning: 'test_fetch_multiple_symbols' requested an async fixture 'storage', with no plugin or hook that handled it. This is usually an error, as pytest does not natively support it. This will turn into an error in pytest 9.
E   See: https://docs.pytest.org/en/stable/deprecations.html#sync-test-depending-on-async-fixture
________________ ERROR at setup of test_metrics_requires_admin _________________
tests/integration/test_backend_api_roles.py:61: in admin_token
    assert response.status_code == 200
E   assert 404 == 200
E    +  where 404 = <Response [404 Not Found]>.status_code
---------------------------- Captured stdout setup -----------------------------
2025-12-06 15:20:47 | INFO | backend.app.main | Database initialized (mode=dev) | trace_id=-
2025-12-06 15:20:47 | INFO | httpx | HTTP Request: POST http://testserver/api/auth/login "HTTP/1.1 404 Not Found" | trace_id=-
------------------------------ Captured log setup ------------------------------
INFO     backend.app.main:main.py:63 Database initialized (mode=dev)
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/auth/login "HTTP/1.1 404 Not Found"
________ ERROR at setup of test_protected_get_routes_accept_user_token _________
tests/integration/test_backend_api_roles.py:74: in user_token
    assert response.status_code == 200
E   assert 404 == 200
E    +  where 404 = <Response [404 Not Found]>.status_code
---------------------------- Captured stdout setup -----------------------------
2025-12-06 15:20:48 | INFO | backend.app.main | Database initialized (mode=dev) | trace_id=-
2025-12-06 15:20:48 | INFO | httpx | HTTP Request: POST http://testserver/api/auth/login "HTTP/1.1 404 Not Found" | trace_id=-
------------------------------ Captured log setup ------------------------------
INFO     backend.app.main:main.py:63 Database initialized (mode=dev)
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/auth/login "HTTP/1.1 404 Not Found"
__________ ERROR at setup of test_strategy_actions_accept_user_token ___________
tests/integration/test_backend_api_roles.py:74: in user_token
    assert response.status_code == 200
E   assert 404 == 200
E    +  where 404 = <Response [404 Not Found]>.status_code
---------------------------- Captured stdout setup -----------------------------
2025-12-06 15:20:48 | INFO | backend.app.main | Database initialized (mode=dev) | trace_id=-
2025-12-06 15:20:48 | INFO | httpx | HTTP Request: POST http://testserver/api/auth/login "HTTP/1.1 404 Not Found" | trace_id=-
------------------------------ Captured log setup ------------------------------
INFO     backend.app.main:main.py:63 Database initialized (mode=dev)
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/auth/login "HTTP/1.1 404 Not Found"
_______ ERROR at setup of test_malformed_and_expired_tokens_are_rejected _______
tests/integration/test_backend_api_roles.py:74: in user_token
    assert response.status_code == 200
E   assert 404 == 200
E    +  where 404 = <Response [404 Not Found]>.status_code
---------------------------- Captured stdout setup -----------------------------
2025-12-06 15:20:48 | INFO | backend.app.main | Database initialized (mode=dev) | trace_id=-
2025-12-06 15:20:48 | INFO | httpx | HTTP Request: POST http://testserver/api/auth/login "HTTP/1.1 404 Not Found" | trace_id=-
------------------------------ Captured log setup ------------------------------
INFO     backend.app.main:main.py:63 Database initialized (mode=dev)
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/auth/login "HTTP/1.1 404 Not Found"
_______________ ERROR at setup of test_logs_restricted_to_admin ________________
tests/integration/test_backend_api_roles.py:74: in user_token
    assert response.status_code == 200
E   assert 404 == 200
E    +  where 404 = <Response [404 Not Found]>.status_code
---------------------------- Captured stdout setup -----------------------------
2025-12-06 15:20:48 | INFO | backend.app.main | Database initialized (mode=dev) | trace_id=-
2025-12-06 15:20:48 | INFO | httpx | HTTP Request: POST http://testserver/api/auth/login "HTTP/1.1 404 Not Found" | trace_id=-
------------------------------ Captured log setup ------------------------------
INFO     backend.app.main:main.py:63 Database initialized (mode=dev)
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/auth/login "HTTP/1.1 404 Not Found"
________ ERROR at setup of test_logs_returns_503_when_store_unavailable ________
tests/integration/test_backend_api_roles.py:61: in admin_token
    assert response.status_code == 200
E   assert 404 == 200
E    +  where 404 = <Response [404 Not Found]>.status_code
---------------------------- Captured stdout setup -----------------------------
2025-12-06 15:20:48 | INFO | backend.app.main | Database initialized (mode=dev) | trace_id=-
2025-12-06 15:20:48 | INFO | httpx | HTTP Request: POST http://testserver/api/auth/login "HTTP/1.1 404 Not Found" | trace_id=-
------------------------------ Captured log setup ------------------------------
INFO     backend.app.main:main.py:63 Database initialized (mode=dev)
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/auth/login "HTTP/1.1 404 Not Found"
____ ERROR at setup of TestStoragePerformance.test_bulk_insert_performance _____
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:353: in from_call
    result: TResult | None = func()
                             ^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:245: in <lambda>
    lambda: runtest_hook(item=item, **kwds),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/logging.py:843: in pytest_runtest_setup
    yield
/home/mohit/.local/lib/python3.12/site-packages/_pytest/capture.py:895: in pytest_runtest_setup
    return (yield)
            ^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:165: in pytest_runtest_setup
    item.session._setupstate.setup(item)
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:523: in setup
    col.setup()
/home/mohit/.local/lib/python3.12/site-packages/_pytest/python.py:1723: in setup
    self._request._fillfixtures()
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:707: in _fillfixtures
    item.funcargs[argname] = self.getfixturevalue(argname)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:539: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:627: in _get_active_fixturedef
    fixturedef.execute(request=subrequest)
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:1110: in execute
    result: FixtureValue = ihook.pytest_fixture_setup(
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup
    return (yield)
            ^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:1188: in pytest_fixture_setup
    warnings.warn(
E   pytest.PytestRemovedIn9Warning: 'test_bulk_insert_performance' requested an async fixture 'storage', with no plugin or hook that handled it. This is usually an error, as pytest does not natively support it. This will turn into an error in pytest 9.
E   See: https://docs.pytest.org/en/stable/deprecations.html#sync-test-depending-on-async-fixture
_______ ERROR at setup of TestStoragePerformance.test_fetch_performance ________
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:353: in from_call
    result: TResult | None = func()
                             ^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:245: in <lambda>
    lambda: runtest_hook(item=item, **kwds),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/logging.py:843: in pytest_runtest_setup
    yield
/home/mohit/.local/lib/python3.12/site-packages/_pytest/capture.py:895: in pytest_runtest_setup
    return (yield)
            ^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:165: in pytest_runtest_setup
    item.session._setupstate.setup(item)
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:523: in setup
    col.setup()
/home/mohit/.local/lib/python3.12/site-packages/_pytest/python.py:1723: in setup
    self._request._fillfixtures()
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:707: in _fillfixtures
    item.funcargs[argname] = self.getfixturevalue(argname)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:539: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:627: in _get_active_fixturedef
    fixturedef.execute(request=subrequest)
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:1110: in execute
    result: FixtureValue = ihook.pytest_fixture_setup(
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup
    return (yield)
            ^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:1188: in pytest_fixture_setup
    warnings.warn(
E   pytest.PytestRemovedIn9Warning: 'test_fetch_performance' requested an async fixture 'storage', with no plugin or hook that handled it. This is usually an error, as pytest does not natively support it. This will turn into an error in pytest 9.
E   See: https://docs.pytest.org/en/stable/deprecations.html#sync-test-depending-on-async-fixture
___ ERROR at setup of TestEndToEndPerformance.test_full_pipeline_performance ___
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:353: in from_call
    result: TResult | None = func()
                             ^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:245: in <lambda>
    lambda: runtest_hook(item=item, **kwds),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/logging.py:843: in pytest_runtest_setup
    yield
/home/mohit/.local/lib/python3.12/site-packages/_pytest/capture.py:895: in pytest_runtest_setup
    return (yield)
            ^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:165: in pytest_runtest_setup
    item.session._setupstate.setup(item)
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:523: in setup
    col.setup()
/home/mohit/.local/lib/python3.12/site-packages/_pytest/python.py:1723: in setup
    self._request._fillfixtures()
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:707: in _fillfixtures
    item.funcargs[argname] = self.getfixturevalue(argname)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:539: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:627: in _get_active_fixturedef
    fixturedef.execute(request=subrequest)
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:1110: in execute
    result: FixtureValue = ihook.pytest_fixture_setup(
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup
    return (yield)
            ^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:1188: in pytest_fixture_setup
    warnings.warn(
E   pytest.PytestRemovedIn9Warning: 'test_full_pipeline_performance' requested an async fixture 'storage', with no plugin or hook that handled it. This is usually an error, as pytest does not natively support it. This will turn into an error in pytest 9.
E   See: https://docs.pytest.org/en/stable/deprecations.html#sync-test-depending-on-async-fixture
______ ERROR at setup of TestConcurrentOperations.test_concurrent_inserts ______
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:353: in from_call
    result: TResult | None = func()
                             ^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:245: in <lambda>
    lambda: runtest_hook(item=item, **kwds),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/logging.py:843: in pytest_runtest_setup
    yield
/home/mohit/.local/lib/python3.12/site-packages/_pytest/capture.py:895: in pytest_runtest_setup
    return (yield)
            ^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:165: in pytest_runtest_setup
    item.session._setupstate.setup(item)
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:523: in setup
    col.setup()
/home/mohit/.local/lib/python3.12/site-packages/_pytest/python.py:1723: in setup
    self._request._fillfixtures()
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:707: in _fillfixtures
    item.funcargs[argname] = self.getfixturevalue(argname)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:539: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:627: in _get_active_fixturedef
    fixturedef.execute(request=subrequest)
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:1110: in execute
    result: FixtureValue = ihook.pytest_fixture_setup(
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup
    return (yield)
            ^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:1188: in pytest_fixture_setup
    warnings.warn(
E   pytest.PytestRemovedIn9Warning: 'test_concurrent_inserts' requested an async fixture 'storage', with no plugin or hook that handled it. This is usually an error, as pytest does not natively support it. This will turn into an error in pytest 9.
E   See: https://docs.pytest.org/en/stable/deprecations.html#sync-test-depending-on-async-fixture
_________ ERROR at setup of TestKiteWebSocketAdapter.test_authenticate _________
tests/unit/test_adapters.py:226: in adapter
    return KiteWebSocketAdapter(config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: Can't instantiate abstract class KiteWebSocketAdapter without an implementation for abstract method 'close'
__________ ERROR at setup of TestKiteWebSocketAdapter.test_subscribe ___________
tests/unit/test_adapters.py:226: in adapter
    return KiteWebSocketAdapter(config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: Can't instantiate abstract class KiteWebSocketAdapter without an implementation for abstract method 'close'
_______ ERROR at setup of TestKiteWebSocketAdapter.test_context_manager ________
tests/unit/test_adapters.py:226: in adapter
    return KiteWebSocketAdapter(config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: Can't instantiate abstract class KiteWebSocketAdapter without an implementation for abstract method 'close'
_____ ERROR at setup of TestKiteWebSocketAdapter.test_process_message_tick _____
tests/unit/test_adapters.py:226: in adapter
    return KiteWebSocketAdapter(config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: Can't instantiate abstract class KiteWebSocketAdapter without an implementation for abstract method 'close'
_____________ ERROR at setup of TestDataStorage.test_create_tables _____________
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:353: in from_call
    result: TResult | None = func()
                             ^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:245: in <lambda>
    lambda: runtest_hook(item=item, **kwds),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/logging.py:843: in pytest_runtest_setup
    yield
/home/mohit/.local/lib/python3.12/site-packages/_pytest/capture.py:895: in pytest_runtest_setup
    return (yield)
            ^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:165: in pytest_runtest_setup
    item.session._setupstate.setup(item)
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:523: in setup
    col.setup()
/home/mohit/.local/lib/python3.12/site-packages/_pytest/python.py:1723: in setup
    self._request._fillfixtures()
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:707: in _fillfixtures
    item.funcargs[argname] = self.getfixturevalue(argname)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:539: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:627: in _get_active_fixturedef
    fixturedef.execute(request=subrequest)
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:1110: in execute
    result: FixtureValue = ihook.pytest_fixture_setup(
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup
    return (yield)
            ^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:1188: in pytest_fixture_setup
    warnings.warn(
E   pytest.PytestRemovedIn9Warning: 'test_create_tables' requested an async fixture 'storage', with no plugin or hook that handled it. This is usually an error, as pytest does not natively support it. This will turn into an error in pytest 9.
E   See: https://docs.pytest.org/en/stable/deprecations.html#sync-test-depending-on-async-fixture
_____________ ERROR at setup of TestDataStorage.test_insert_candle _____________
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:353: in from_call
    result: TResult | None = func()
                             ^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:245: in <lambda>
    lambda: runtest_hook(item=item, **kwds),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/logging.py:843: in pytest_runtest_setup
    yield
/home/mohit/.local/lib/python3.12/site-packages/_pytest/capture.py:895: in pytest_runtest_setup
    return (yield)
            ^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:165: in pytest_runtest_setup
    item.session._setupstate.setup(item)
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:523: in setup
    col.setup()
/home/mohit/.local/lib/python3.12/site-packages/_pytest/python.py:1723: in setup
    self._request._fillfixtures()
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:707: in _fillfixtures
    item.funcargs[argname] = self.getfixturevalue(argname)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:539: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:627: in _get_active_fixturedef
    fixturedef.execute(request=subrequest)
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:1110: in execute
    result: FixtureValue = ihook.pytest_fixture_setup(
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup
    return (yield)
            ^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:1188: in pytest_fixture_setup
    warnings.warn(
E   pytest.PytestRemovedIn9Warning: 'test_insert_candle' requested an async fixture 'storage', with no plugin or hook that handled it. This is usually an error, as pytest does not natively support it. This will turn into an error in pytest 9.
E   See: https://docs.pytest.org/en/stable/deprecations.html#sync-test-depending-on-async-fixture
________ ERROR at setup of TestDataStorage.test_insert_duplicate_candle ________
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:353: in from_call
    result: TResult | None = func()
                             ^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:245: in <lambda>
    lambda: runtest_hook(item=item, **kwds),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/logging.py:843: in pytest_runtest_setup
    yield
/home/mohit/.local/lib/python3.12/site-packages/_pytest/capture.py:895: in pytest_runtest_setup
    return (yield)
            ^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:165: in pytest_runtest_setup
    item.session._setupstate.setup(item)
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:523: in setup
    col.setup()
/home/mohit/.local/lib/python3.12/site-packages/_pytest/python.py:1723: in setup
    self._request._fillfixtures()
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:707: in _fillfixtures
    item.funcargs[argname] = self.getfixturevalue(argname)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:539: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:627: in _get_active_fixturedef
    fixturedef.execute(request=subrequest)
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:1110: in execute
    result: FixtureValue = ihook.pytest_fixture_setup(
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup
    return (yield)
            ^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:1188: in pytest_fixture_setup
    warnings.warn(
E   pytest.PytestRemovedIn9Warning: 'test_insert_duplicate_candle' requested an async fixture 'storage', with no plugin or hook that handled it. This is usually an error, as pytest does not natively support it. This will turn into an error in pytest 9.
E   See: https://docs.pytest.org/en/stable/deprecations.html#sync-test-depending-on-async-fixture
_________ ERROR at setup of TestDataStorage.test_fetch_last_n_candles __________
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:353: in from_call
    result: TResult | None = func()
                             ^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:245: in <lambda>
    lambda: runtest_hook(item=item, **kwds),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/logging.py:843: in pytest_runtest_setup
    yield
/home/mohit/.local/lib/python3.12/site-packages/_pytest/capture.py:895: in pytest_runtest_setup
    return (yield)
            ^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:165: in pytest_runtest_setup
    item.session._setupstate.setup(item)
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:523: in setup
    col.setup()
/home/mohit/.local/lib/python3.12/site-packages/_pytest/python.py:1723: in setup
    self._request._fillfixtures()
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:707: in _fillfixtures
    item.funcargs[argname] = self.getfixturevalue(argname)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:539: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:627: in _get_active_fixturedef
    fixturedef.execute(request=subrequest)
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:1110: in execute
    result: FixtureValue = ihook.pytest_fixture_setup(
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup
    return (yield)
            ^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:1188: in pytest_fixture_setup
    warnings.warn(
E   pytest.PytestRemovedIn9Warning: 'test_fetch_last_n_candles' requested an async fixture 'storage', with no plugin or hook that handled it. This is usually an error, as pytest does not natively support it. This will turn into an error in pytest 9.
E   See: https://docs.pytest.org/en/stable/deprecations.html#sync-test-depending-on-async-fixture
______ ERROR at setup of TestDataStorage.test_fetch_last_n_candles_empty _______
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:353: in from_call
    result: TResult | None = func()
                             ^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:245: in <lambda>
    lambda: runtest_hook(item=item, **kwds),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/logging.py:843: in pytest_runtest_setup
    yield
/home/mohit/.local/lib/python3.12/site-packages/_pytest/capture.py:895: in pytest_runtest_setup
    return (yield)
            ^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:165: in pytest_runtest_setup
    item.session._setupstate.setup(item)
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:523: in setup
    col.setup()
/home/mohit/.local/lib/python3.12/site-packages/_pytest/python.py:1723: in setup
    self._request._fillfixtures()
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:707: in _fillfixtures
    item.funcargs[argname] = self.getfixturevalue(argname)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:539: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:627: in _get_active_fixturedef
    fixturedef.execute(request=subrequest)
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:1110: in execute
    result: FixtureValue = ihook.pytest_fixture_setup(
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup
    return (yield)
            ^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:1188: in pytest_fixture_setup
    warnings.warn(
E   pytest.PytestRemovedIn9Warning: 'test_fetch_last_n_candles_empty' requested an async fixture 'storage', with no plugin or hook that handled it. This is usually an error, as pytest does not natively support it. This will turn into an error in pytest 9.
E   See: https://docs.pytest.org/en/stable/deprecations.html#sync-test-depending-on-async-fixture
_ ERROR at setup of TestDataStorage.test_fetch_last_n_candles_different_symbols _
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:353: in from_call
    result: TResult | None = func()
                             ^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:245: in <lambda>
    lambda: runtest_hook(item=item, **kwds),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/logging.py:843: in pytest_runtest_setup
    yield
/home/mohit/.local/lib/python3.12/site-packages/_pytest/capture.py:895: in pytest_runtest_setup
    return (yield)
            ^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:165: in pytest_runtest_setup
    item.session._setupstate.setup(item)
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:523: in setup
    col.setup()
/home/mohit/.local/lib/python3.12/site-packages/_pytest/python.py:1723: in setup
    self._request._fillfixtures()
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:707: in _fillfixtures
    item.funcargs[argname] = self.getfixturevalue(argname)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:539: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:627: in _get_active_fixturedef
    fixturedef.execute(request=subrequest)
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:1110: in execute
    result: FixtureValue = ihook.pytest_fixture_setup(
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup
    return (yield)
            ^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:1188: in pytest_fixture_setup
    warnings.warn(
E   pytest.PytestRemovedIn9Warning: 'test_fetch_last_n_candles_different_symbols' requested an async fixture 'storage', with no plugin or hook that handled it. This is usually an error, as pytest does not natively support it. This will turn into an error in pytest 9.
E   See: https://docs.pytest.org/en/stable/deprecations.html#sync-test-depending-on-async-fixture
_________ ERROR at setup of TestDataStorage.test_health_check_success __________
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:353: in from_call
    result: TResult | None = func()
                             ^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:245: in <lambda>
    lambda: runtest_hook(item=item, **kwds),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/logging.py:843: in pytest_runtest_setup
    yield
/home/mohit/.local/lib/python3.12/site-packages/_pytest/capture.py:895: in pytest_runtest_setup
    return (yield)
            ^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:165: in pytest_runtest_setup
    item.session._setupstate.setup(item)
/home/mohit/.local/lib/python3.12/site-packages/_pytest/runner.py:523: in setup
    col.setup()
/home/mohit/.local/lib/python3.12/site-packages/_pytest/python.py:1723: in setup
    self._request._fillfixtures()
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:707: in _fillfixtures
    item.funcargs[argname] = self.getfixturevalue(argname)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:539: in getfixturevalue
    fixturedef = self._get_active_fixturedef(argname)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:627: in _get_active_fixturedef
    fixturedef.execute(request=subrequest)
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:1110: in execute
    result: FixtureValue = ihook.pytest_fixture_setup(
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pluggy/_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/setuponly.py:36: in pytest_fixture_setup
    return (yield)
            ^^^^^
/home/mohit/.local/lib/python3.12/site-packages/_pytest/fixtures.py:1188: in pytest_fixture_setup
    warnings.warn(
E   pytest.PytestRemovedIn9Warning: 'test_health_check_success' requested an async fixture 'storage', with no plugin or hook that handled it. This is usually an error, as pytest does not natively support it. This will turn into an error in pytest 9.
E   See: https://docs.pytest.org/en/stable/deprecations.html#sync-test-depending-on-async-fixture
=================================== FAILURES ===================================
_________________ test_pipeline_answer_returns_clean_response __________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
____________________________ test_logout_successful ____________________________
tests/backend/test_auth_routes.py:52: in test_logout_successful
    assert response.status_code == 200
E   assert 403 == 200
E    +  where 403 = <Response [403 Forbidden]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:30 | INFO | httpx | HTTP Request: POST http://testserver/api/auth/logout "HTTP/1.1 403 Forbidden" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/auth/logout "HTTP/1.1 403 Forbidden"
____________________________ test_register_new_user ____________________________
tests/backend/test_auth_routes.py:65: in test_register_new_user
    with patch("backend.api.main.USER_DATABASE", {}) as mock_db, \
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'backend.api.main' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/api/main.py'> does not have the attribute 'USER_DATABASE'
_________________________ test_register_existing_user __________________________
tests/backend/test_auth_routes.py:93: in test_register_existing_user
    with patch("backend.api.main.USER_DATABASE", {"existinguser": {}}):
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'backend.api.main' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/api/main.py'> does not have the attribute 'USER_DATABASE'
_______________________ test_forgot_password_valid_email _______________________
tests/backend/test_auth_routes.py:135: in test_forgot_password_valid_email
    with patch("backend.api.main.USER_DATABASE", {
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'backend.api.main' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/api/main.py'> does not have the attribute 'USER_DATABASE'
______________________ test_forgot_password_unknown_email ______________________
tests/backend/test_auth_routes.py:149: in test_forgot_password_unknown_email
    with patch("backend.api.main.USER_DATABASE", {}):
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'backend.api.main' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/api/main.py'> does not have the attribute 'USER_DATABASE'
____________________ test_protected_endpoint_requires_auth _____________________
tests/backend/test_auth_routes.py:161: in test_protected_endpoint_requires_auth
    assert response.status_code == 401
E   assert 403 == 401
E    +  where 403 = <Response [403 Forbidden]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:39 | INFO | httpx | HTTP Request: GET http://testserver/protected "HTTP/1.1 403 Forbidden" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/protected "HTTP/1.1 403 Forbidden"
___________________ test_protected_endpoint_with_valid_token ___________________
tests/backend/test_auth_routes.py:174: in test_protected_endpoint_with_valid_token
    assert response.status_code == 200
E   assert 403 == 200
E    +  where 403 = <Response [403 Forbidden]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:39 | INFO | httpx | HTTP Request: GET http://testserver/protected "HTTP/1.1 403 Forbidden" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/protected "HTTP/1.1 403 Forbidden"
_________________ test_admin_only_endpoint_requires_admin_role _________________
tests/backend/test_auth_routes.py:190: in test_admin_only_endpoint_requires_admin_role
    assert "Admin access required" in data["detail"]
E   AssertionError: assert 'Admin access required' in 'Authentication credentials are required'
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:39 | INFO | httpx | HTTP Request: GET http://testserver/api/logs "HTTP/1.1 403 Forbidden" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/api/logs "HTTP/1.1 403 Forbidden"
________________________ test_logout_invalidates_token _________________________
tests/backend/test_auth_routes.py:215: in test_logout_invalidates_token
    assert response.status_code == 200
E   assert 403 == 200
E    +  where 403 = <Response [403 Forbidden]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:39 | INFO | httpx | HTTP Request: POST http://testserver/api/auth/logout "HTTP/1.1 403 Forbidden" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/auth/logout "HTTP/1.1 403 Forbidden"
_______________________ test_auth_endpoints_cors_headers _______________________
tests/backend/test_auth_routes.py:224: in test_auth_endpoints_cors_headers
    assert response.status_code == 200
E   assert 405 == 200
E    +  where 405 = <Response [405 Method Not Allowed]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:39 | INFO | httpx | HTTP Request: OPTIONS http://testserver/api/auth/login "HTTP/1.1 405 Method Not Allowed" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: OPTIONS http://testserver/api/auth/login "HTTP/1.1 405 Method Not Allowed"
__________________________ test_get_market_data_ohlc ___________________________
tests/backend/test_market_data_routes.py:15: in test_get_market_data_ohlc
    with patch("backend.api.market_data.get_ohlc_data") as mock_get_data:
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'backend.api.market_data' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/api/market_data.py'> does not have the attribute 'get_ohlc_data'
___________________ test_get_market_data_ohlc_invalid_symbol ___________________
tests/backend/test_market_data_routes.py:35: in test_get_market_data_ohlc_invalid_symbol
    with patch("backend.api.market_data.get_ohlc_data") as mock_get_data:
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'backend.api.market_data' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/api/market_data.py'> does not have the attribute 'get_ohlc_data'
__________________ test_get_market_data_ohlc_with_date_range ___________________
tests/backend/test_market_data_routes.py:51: in test_get_market_data_ohlc_with_date_range
    with patch("backend.api.market_data.get_ohlc_data") as mock_get_data:
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'backend.api.market_data' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/api/market_data.py'> does not have the attribute 'get_ohlc_data'
____________________________ test_get_current_price ____________________________
tests/backend/test_market_data_routes.py:70: in test_get_current_price
    with patch("backend.api.market_data.get_current_price") as mock_get_price:
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'backend.api.market_data' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/api/market_data.py'> does not have the attribute 'get_current_price'
_______________________ test_get_current_price_not_found _______________________
tests/backend/test_market_data_routes.py:90: in test_get_current_price_not_found
    with patch("backend.api.market_data.get_current_price") as mock_get_price:
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'backend.api.market_data' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/api/market_data.py'> does not have the attribute 'get_current_price'
__________________________ test_get_market_data_quote __________________________
tests/backend/test_market_data_routes.py:104: in test_get_market_data_quote
    with patch("backend.api.market_data.get_quote") as mock_get_quote:
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'backend.api.market_data' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/api/market_data.py'> does not have the attribute 'get_quote'
____________________________ test_get_market_depth _____________________________
tests/backend/test_market_data_routes.py:129: in test_get_market_depth
    with patch("backend.api.market_data.get_market_depth") as mock_get_depth:
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'backend.api.market_data' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/api/market_data.py'> does not have the attribute 'get_market_depth'
__________________________ test_get_historical_volume __________________________
tests/backend/test_market_data_routes.py:159: in test_get_historical_volume
    with patch("backend.api.market_data.get_volume_data") as mock_get_volume:
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'backend.api.market_data' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/api/market_data.py'> does not have the attribute 'get_volume_data'
_____________________ test_get_market_data_with_pagination _____________________
tests/backend/test_market_data_routes.py:181: in test_get_market_data_with_pagination
    with patch("backend.api.market_data.get_ohlc_data") as mock_get_data:
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'backend.api.market_data' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/api/market_data.py'> does not have the attribute 'get_ohlc_data'
____________________ test_get_market_data_invalid_timeframe ____________________
tests/backend/test_market_data_routes.py:200: in test_get_market_data_invalid_timeframe
    assert response.status_code == 400
E   assert 404 == 400
E    +  where 404 = <Response [404 Not Found]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:40 | INFO | httpx | HTTP Request: GET http://testserver/api/market-data/ohlc/AAPL?timeframe=invalid "HTTP/1.1 404 Not Found" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/api/market-data/ohlc/AAPL?timeframe=invalid "HTTP/1.1 404 Not Found"
______________________ test_get_market_data_rate_limiting ______________________
tests/backend/test_market_data_routes.py:216: in test_get_market_data_rate_limiting
    assert 429 in responses or all(r == 200 for r in responses)
E   assert (429 in [404, 404, 404, 404, 404] or False)
E    +  where False = all(<generator object test_get_market_data_rate_limiting.<locals>.<genexpr> at 0x77681e728c70>)
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:40 | INFO | httpx | HTTP Request: GET http://testserver/api/market-data/price/AAPL "HTTP/1.1 404 Not Found" | trace_id=-
2025-12-06 15:20:40 | INFO | httpx | HTTP Request: GET http://testserver/api/market-data/price/AAPL "HTTP/1.1 404 Not Found" | trace_id=-
2025-12-06 15:20:40 | INFO | httpx | HTTP Request: GET http://testserver/api/market-data/price/AAPL "HTTP/1.1 404 Not Found" | trace_id=-
2025-12-06 15:20:40 | INFO | httpx | HTTP Request: GET http://testserver/api/market-data/price/AAPL "HTTP/1.1 404 Not Found" | trace_id=-
2025-12-06 15:20:40 | INFO | httpx | HTTP Request: GET http://testserver/api/market-data/price/AAPL "HTTP/1.1 404 Not Found" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/api/market-data/price/AAPL "HTTP/1.1 404 Not Found"
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/api/market-data/price/AAPL "HTTP/1.1 404 Not Found"
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/api/market-data/price/AAPL "HTTP/1.1 404 Not Found"
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/api/market-data/price/AAPL "HTTP/1.1 404 Not Found"
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/api/market-data/price/AAPL "HTTP/1.1 404 Not Found"
_________________________ test_get_market_data_caching _________________________
tests/backend/test_market_data_routes.py:223: in test_get_market_data_caching
    with patch("backend.api.market_data.get_current_price") as mock_get_price:
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'backend.api.market_data' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/api/market_data.py'> does not have the attribute 'get_current_price'
_____________________ test_get_market_data_error_handling ______________________
tests/backend/test_market_data_routes.py:246: in test_get_market_data_error_handling
    with patch("backend.api.market_data.get_ohlc_data") as mock_get_data:
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'backend.api.market_data' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/api/market_data.py'> does not have the attribute 'get_ohlc_data'
_____________________ test_get_market_data_empty_response ______________________
tests/backend/test_market_data_routes.py:260: in test_get_market_data_empty_response
    with patch("backend.api.market_data.get_ohlc_data") as mock_get_data:
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'backend.api.market_data' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/api/market_data.py'> does not have the attribute 'get_ohlc_data'
_________________________ test_place_buy_order_success _________________________
tests/backend/test_trading_routes.py:40: in test_place_buy_order_success
    assert response.status_code == 200
E   assert 403 == 200
E    +  where 403 = <Response [403 Forbidden]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:40 | INFO | httpx | HTTP Request: POST http://testserver/api/trades "HTTP/1.1 403 Forbidden" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/trades "HTTP/1.1 403 Forbidden"
________________________ test_place_sell_order_success _________________________
tests/backend/test_trading_routes.py:80: in test_place_sell_order_success
    assert response.status_code == 200
E   assert 403 == 200
E    +  where 403 = <Response [403 Forbidden]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:40 | INFO | httpx | HTTP Request: POST http://testserver/api/trades "HTTP/1.1 403 Forbidden" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/trades "HTTP/1.1 403 Forbidden"
___________________________ test_place_market_order ____________________________
tests/backend/test_trading_routes.py:115: in test_place_market_order
    assert response.status_code == 200
E   assert 403 == 200
E    +  where 403 = <Response [403 Forbidden]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:40 | INFO | httpx | HTTP Request: POST http://testserver/api/trades "HTTP/1.1 403 Forbidden" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/trades "HTTP/1.1 403 Forbidden"
________________________ test_place_order_invalid_side _________________________
tests/backend/test_trading_routes.py:130: in test_place_order_invalid_side
    assert response.status_code == 400
E   assert 403 == 400
E    +  where 403 = <Response [403 Forbidden]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:40 | INFO | httpx | HTTP Request: POST http://testserver/api/trades "HTTP/1.1 403 Forbidden" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/trades "HTTP/1.1 403 Forbidden"
______________________ test_place_order_invalid_quantity _______________________
tests/backend/test_trading_routes.py:145: in test_place_order_invalid_quantity
    assert response.status_code == 400
E   assert 403 == 400
E    +  where 403 = <Response [403 Forbidden]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:40 | INFO | httpx | HTTP Request: POST http://testserver/api/trades "HTTP/1.1 403 Forbidden" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/trades "HTTP/1.1 403 Forbidden"
___________ test_place_order_live_mode_blocked_without_confirmation ____________
tests/backend/test_trading_routes.py:167: in test_place_order_live_mode_blocked_without_confirmation
    assert "Live trading is disabled" in data["detail"]
E   AssertionError: assert 'Live trading is disabled' in 'Authentication credentials are required'
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:40 | INFO | httpx | HTTP Request: POST http://testserver/api/trades "HTTP/1.1 403 Forbidden" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/trades "HTTP/1.1 403 Forbidden"
__________________________ test_cancel_order_success ___________________________
tests/backend/test_trading_routes.py:188: in test_cancel_order_success
    assert response.status_code == 200
E   assert 404 == 200
E    +  where 404 = <Response [404 Not Found]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:40 | INFO | httpx | HTTP Request: DELETE http://testserver/api/orders/order_123 "HTTP/1.1 404 Not Found" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: DELETE http://testserver/api/orders/order_123 "HTTP/1.1 404 Not Found"
_________________________ test_cancel_order_not_found __________________________
tests/backend/test_trading_routes.py:209: in test_cancel_order_not_found
    assert "Order not found" in data["detail"]
E   AssertionError: assert 'Order not found' in 'Not Found'
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:40 | INFO | httpx | HTTP Request: DELETE http://testserver/api/orders/non_existent_order "HTTP/1.1 404 Not Found" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: DELETE http://testserver/api/orders/non_existent_order "HTTP/1.1 404 Not Found"
______________________________ test_get_pnl_today ______________________________
tests/backend/test_trading_routes.py:267: in test_get_pnl_today
    assert response.status_code == 200
E   assert 404 == 200
E    +  where 404 = <Response [404 Not Found]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:41 | INFO | httpx | HTTP Request: GET http://testserver/api/pnl/today "HTTP/1.1 404 Not Found" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/api/pnl/today "HTTP/1.1 404 Not Found"
__________________________ test_start_trading_engine ___________________________
tests/backend/test_trading_routes.py:350: in test_start_trading_engine
    assert response.status_code == 200
E   assert 404 == 200
E    +  where 404 = <Response [404 Not Found]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:41 | INFO | httpx | HTTP Request: POST http://testserver/api/trading/start "HTTP/1.1 404 Not Found" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/trading/start "HTTP/1.1 404 Not Found"
___________________________ test_stop_trading_engine ___________________________
tests/backend/test_trading_routes.py:362: in test_stop_trading_engine
    assert response.status_code == 200
E   assert 404 == 200
E    +  where 404 = <Response [404 Not Found]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:41 | INFO | httpx | HTTP Request: POST http://testserver/api/trading/stop "HTTP/1.1 404 Not Found" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/trading/stop "HTTP/1.1 404 Not Found"
___________________________ test_get_trading_status ____________________________
tests/backend/test_trading_routes.py:378: in test_get_trading_status
    assert response.status_code == 200
E   assert 404 == 200
E    +  where 404 = <Response [404 Not Found]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:41 | INFO | httpx | HTTP Request: GET http://testserver/api/trading/status "HTTP/1.1 404 Not Found" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/api/trading/status "HTTP/1.1 404 Not Found"
___________________________ test_get_trading_history ___________________________
tests/backend/test_trading_routes.py:401: in test_get_trading_history
    assert response.status_code == 200
E   assert 404 == 200
E    +  where 404 = <Response [404 Not Found]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:41 | INFO | httpx | HTTP Request: GET http://testserver/api/trading/history "HTTP/1.1 404 Not Found" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/api/trading/history "HTTP/1.1 404 Not Found"
_______________________ test_place_order_unauthenticated _______________________
tests/backend/test_trading_routes.py:419: in test_place_order_unauthenticated
    assert response.status_code == 401
E   assert 403 == 401
E    +  where 403 = <Response [403 Forbidden]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:41 | INFO | httpx | HTTP Request: POST http://testserver/api/trades "HTTP/1.1 403 Forbidden" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/trades "HTTP/1.1 403 Forbidden"
_______________________ test_nse_backfill_script_success _______________________
tests/data_collector/test_backfill_scripts.py:11: in test_nse_backfill_script_success
    with patch("data_collector.scripts.nse_backfill.main") as mock_main:
/usr/lib/python3.12/unittest/mock.py:1442: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/usr/lib/python3.12/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'data_collector.scripts' has no attribute 'nse_backfill'
______________________ test_nse_backfill_with_date_range _______________________
tests/data_collector/test_backfill_scripts.py:27: in test_nse_backfill_with_date_range
    with patch("data_collector.scripts.nse_backfill.NSEDataCollector") as mock_collector:
/usr/lib/python3.12/unittest/mock.py:1442: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/usr/lib/python3.12/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'data_collector.scripts' has no attribute 'nse_backfill'
_______________________ test_bse_backfill_script_success _______________________
tests/data_collector/test_backfill_scripts.py:42: in test_bse_backfill_script_success
    with patch("data_collector.scripts.bse_backfill.main") as mock_main:
/usr/lib/python3.12/unittest/mock.py:1442: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/usr/lib/python3.12/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'data_collector.scripts' has no attribute 'bse_backfill'
_______________________ test_mcx_backfill_script_success _______________________
tests/data_collector/test_backfill_scripts.py:53: in test_mcx_backfill_script_success
    with patch("data_collector.scripts.mcx_backfill.main") as mock_main:
/usr/lib/python3.12/unittest/mock.py:1442: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/usr/lib/python3.12/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'data_collector.scripts' has no attribute 'mcx_backfill'
_____________________ test_backfill_script_error_handling ______________________
tests/data_collector/test_backfill_scripts.py:64: in test_backfill_script_error_handling
    with patch("data_collector.scripts.nse_backfill.NSEDataCollector") as mock_collector:
/usr/lib/python3.12/unittest/mock.py:1442: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/usr/lib/python3.12/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'data_collector.scripts' has no attribute 'nse_backfill'
______________________ test_backfill_script_invalid_dates ______________________
tests/data_collector/test_backfill_scripts.py:77: in test_backfill_script_invalid_dates
    with patch("data_collector.scripts.nse_backfill.NSEDataCollector") as mock_collector:
/usr/lib/python3.12/unittest/mock.py:1442: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/usr/lib/python3.12/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'data_collector.scripts' has no attribute 'nse_backfill'
______________________ test_backfill_script_rate_limiting ______________________
tests/data_collector/test_backfill_scripts.py:86: in test_backfill_script_rate_limiting
    with patch("data_collector.scripts.nse_backfill.NSEDataCollector") as mock_collector:
/usr/lib/python3.12/unittest/mock.py:1442: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/usr/lib/python3.12/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'data_collector.scripts' has no attribute 'nse_backfill'
_____________________ test_backfill_script_data_validation _____________________
tests/data_collector/test_backfill_scripts.py:110: in test_backfill_script_data_validation
    with patch("data_collector.scripts.nse_backfill.NSEDataCollector") as mock_collector:
/usr/lib/python3.12/unittest/mock.py:1442: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/usr/lib/python3.12/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'data_collector.scripts' has no attribute 'nse_backfill'
___________________ test_backfill_script_progress_reporting ____________________
tests/data_collector/test_backfill_scripts.py:127: in test_backfill_script_progress_reporting
    with patch("data_collector.scripts.nse_backfill.NSEDataCollector") as mock_collector, \
/usr/lib/python3.12/unittest/mock.py:1442: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/usr/lib/python3.12/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'data_collector.scripts' has no attribute 'nse_backfill'
_____________________ test_backfill_script_config_loading ______________________
tests/data_collector/test_backfill_scripts.py:144: in test_backfill_script_config_loading
    with patch("data_collector.scripts.nse_backfill.load_config") as mock_config:
/usr/lib/python3.12/unittest/mock.py:1442: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/usr/lib/python3.12/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'data_collector.scripts' has no attribute 'nse_backfill'
_____________________ test_backfill_script_output_formats ______________________
tests/data_collector/test_backfill_scripts.py:160: in test_backfill_script_output_formats
    with patch("data_collector.scripts.nse_backfill.NSEDataCollector") as mock_collector, \
/usr/lib/python3.12/unittest/mock.py:1442: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/usr/lib/python3.12/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'data_collector.scripts' has no attribute 'nse_backfill'
______________________ test_backfill_script_dry_run_mode _______________________
tests/data_collector/test_backfill_scripts.py:190: in test_backfill_script_dry_run_mode
    with patch("data_collector.scripts.nse_backfill.NSEDataCollector") as mock_collector:
/usr/lib/python3.12/unittest/mock.py:1442: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/usr/lib/python3.12/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'data_collector.scripts' has no attribute 'nse_backfill'
____________________ test_backfill_script_symbol_filtering _____________________
tests/data_collector/test_backfill_scripts.py:206: in test_backfill_script_symbol_filtering
    with patch("data_collector.scripts.nse_backfill.NSEDataCollector") as mock_collector:
/usr/lib/python3.12/unittest/mock.py:1442: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/usr/lib/python3.12/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'data_collector.scripts' has no attribute 'nse_backfill'
___________________ test_backfill_script_parallel_processing ___________________
tests/data_collector/test_backfill_scripts.py:224: in test_backfill_script_parallel_processing
    with patch("data_collector.scripts.nse_backfill.NSEDataCollector") as mock_collector, \
/usr/lib/python3.12/unittest/mock.py:1442: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/usr/lib/python3.12/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'data_collector.scripts' has no attribute 'nse_backfill'
____________________ test_mock_websocket_server_emits_ticks ____________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
_____________ TestAdapterErrorHandling.test_yfinance_network_error _____________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
_____________ TestAdapterErrorHandling.test_alphavantage_api_error _____________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
_____________ TestAdapterRateLimiting.test_yfinance_rate_limiting ______________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
______________ TestAPIAuthentication.test_login_nonexistent_user _______________
tests/integration/test_api_auth.py:64: in test_login_nonexistent_user
    self.assertEqual(response.status_code, 401)
E   AssertionError: 429 != 401
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:45 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:20:45 | INFO | httpx | HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests"
_________________ TestAPIAuthentication.test_login_successful __________________
tests/integration/test_api_auth.py:37: in test_login_successful
    self.assertEqual(response.status_code, 200)
E   AssertionError: 429 != 200
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:45 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:20:45 | INFO | httpx | HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests"
_______________ TestAPIAuthentication.test_logout_authenticated ________________
tests/integration/test_api_auth.py:75: in test_logout_authenticated
    token = login_response.json()["access_token"]
            ^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/httpx/_models.py:832: in json
    return jsonlib.loads(self.content, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/json/__init__.py:346: in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/json/decoder.py:337: in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/json/decoder.py:355: in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
E   json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:45 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:20:45 | INFO | httpx | HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests"
______________ TestAPIAuthentication.test_logout_unauthenticated _______________
tests/integration/test_api_auth.py:86: in test_logout_unauthenticated
    self.assertEqual(response.status_code, 403)
E   AssertionError: 429 != 403
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:45 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:20:45 | INFO | httpx | HTTP Request: POST http://testserver/auth/logout "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/auth/logout "HTTP/1.1 429 Too Many Requests"
____________ TestProtectedEndpoints.test_place_trade_authenticated _____________
tests/integration/test_api_auth.py:127: in test_place_trade_authenticated
    token = self._get_auth_token()
            ^^^^^^^^^^^^^^^^^^^^^^
tests/integration/test_api_auth.py:102: in _get_auth_token
    self.assertEqual(response.status_code, 200)
E   AssertionError: 429 != 200
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:45 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:20:45 | INFO | httpx | HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests"
___________ TestProtectedEndpoints.test_place_trade_invalid_quantity ___________
tests/integration/test_api_auth.py:176: in test_place_trade_invalid_quantity
    token = self._get_auth_token()
            ^^^^^^^^^^^^^^^^^^^^^^
tests/integration/test_api_auth.py:102: in _get_auth_token
    self.assertEqual(response.status_code, 200)
E   AssertionError: 429 != 200
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:45 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:20:45 | INFO | httpx | HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests"
_____________ TestProtectedEndpoints.test_place_trade_invalid_side _____________
tests/integration/test_api_auth.py:160: in test_place_trade_invalid_side
    token = self._get_auth_token()
            ^^^^^^^^^^^^^^^^^^^^^^
tests/integration/test_api_auth.py:102: in _get_auth_token
    self.assertEqual(response.status_code, 200)
E   AssertionError: 429 != 200
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:45 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:20:45 | INFO | httpx | HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests"
_______________ TestProtectedEndpoints.test_place_trade_no_auth ________________
tests/integration/test_api_auth.py:156: in test_place_trade_no_auth
    self.assertEqual(response.status_code, 403)
E   AssertionError: 429 != 403
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:45 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:20:45 | INFO | httpx | HTTP Request: POST http://testserver/trades "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/trades "HTTP/1.1 429 Too Many Requests"
_________ TestProtectedEndpoints.test_protected_endpoint_authenticated _________
tests/integration/test_api_auth.py:107: in test_protected_endpoint_authenticated
    token = self._get_auth_token()
            ^^^^^^^^^^^^^^^^^^^^^^
tests/integration/test_api_auth.py:102: in _get_auth_token
    self.assertEqual(response.status_code, 200)
E   AssertionError: 429 != 200
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:45 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:20:45 | INFO | httpx | HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests"
_________ TestProtectedEndpoints.test_protected_endpoint_invalid_token _________
tests/integration/test_api_auth.py:123: in test_protected_endpoint_invalid_token
    self.assertEqual(response.status_code, 401)
E   AssertionError: 429 != 401
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:45 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:20:45 | INFO | httpx | HTTP Request: GET http://testserver/protected "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/protected "HTTP/1.1 429 Too Many Requests"
____________ TestProtectedEndpoints.test_protected_endpoint_no_auth ____________
tests/integration/test_api_auth.py:117: in test_protected_endpoint_no_auth
    self.assertEqual(response.status_code, 403)
E   AssertionError: 429 != 403
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:45 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:20:45 | INFO | httpx | HTTP Request: GET http://testserver/protected "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/protected "HTTP/1.1 429 Too Many Requests"
___________________ TestPublicEndpoints.test_health_endpoint ___________________
tests/integration/test_api_auth.py:196: in setUp
    self.admin_token = self._get_auth_token("admin", "admin123")
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/integration/test_api_auth.py:205: in _get_auth_token
    self.assertEqual(response.status_code, 200)
E   AssertionError: 429 != 200
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:45 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:20:45 | INFO | httpx | HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests"
________ TestPublicEndpoints.test_logs_endpoint_forbidden_for_non_admin ________
tests/integration/test_api_auth.py:196: in setUp
    self.admin_token = self._get_auth_token("admin", "admin123")
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/integration/test_api_auth.py:205: in _get_auth_token
    self.assertEqual(response.status_code, 200)
E   AssertionError: 429 != 200
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:45 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:20:45 | INFO | httpx | HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests"
________________ TestPublicEndpoints.test_logs_endpoint_no_file ________________
tests/integration/test_api_auth.py:196: in setUp
    self.admin_token = self._get_auth_token("admin", "admin123")
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/integration/test_api_auth.py:205: in _get_auth_token
    self.assertEqual(response.status_code, 200)
E   AssertionError: 429 != 200
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:45 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:20:45 | INFO | httpx | HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests"
_____________ TestPublicEndpoints.test_logs_endpoint_requires_auth _____________
tests/integration/test_api_auth.py:196: in setUp
    self.admin_token = self._get_auth_token("admin", "admin123")
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/integration/test_api_auth.py:205: in _get_auth_token
    self.assertEqual(response.status_code, 200)
E   AssertionError: 429 != 200
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:45 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:20:45 | INFO | httpx | HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests"
_______________ TestPublicEndpoints.test_logs_endpoint_with_file _______________
tests/integration/test_api_auth.py:196: in setUp
    self.admin_token = self._get_auth_token("admin", "admin123")
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/integration/test_api_auth.py:205: in _get_auth_token
    self.assertEqual(response.status_code, 200)
E   AssertionError: 429 != 200
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:45 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:20:45 | INFO | httpx | HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests"
__________________ TestPublicEndpoints.test_metrics_endpoint ___________________
tests/integration/test_api_auth.py:196: in setUp
    self.admin_token = self._get_auth_token("admin", "admin123")
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/integration/test_api_auth.py:205: in _get_auth_token
    self.assertEqual(response.status_code, 200)
E   AssertionError: 429 != 200
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:45 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:20:45 | INFO | httpx | HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests"
____________________ TestPublicEndpoints.test_root_endpoint ____________________
tests/integration/test_api_auth.py:196: in setUp
    self.admin_token = self._get_auth_token("admin", "admin123")
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/integration/test_api_auth.py:205: in _get_auth_token
    self.assertEqual(response.status_code, 200)
E   AssertionError: 429 != 200
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:45 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:20:45 | INFO | httpx | HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests"
___________________ TestPublicEndpoints.test_status_endpoint ___________________
tests/integration/test_api_auth.py:196: in setUp
    self.admin_token = self._get_auth_token("admin", "admin123")
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/integration/test_api_auth.py:205: in _get_auth_token
    self.assertEqual(response.status_code, 200)
E   AssertionError: 429 != 200
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:46 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:20:46 | INFO | httpx | HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/auth/login "HTTP/1.1 429 Too Many Requests"
__________________ TestStrategyEndpoints.test_get_strategies ___________________
tests/integration/test_api_auth.py:331: in test_get_strategies
    self.assertEqual(response.status_code, 503)
E   AssertionError: 429 != 503
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:46 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:20:46 | INFO | httpx | HTTP Request: GET http://testserver/strategies "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/strategies "HTTP/1.1 429 Too Many Requests"
____________ TestStrategyEndpoints.test_load_strategy_invalid_class ____________
tests/integration/test_api_auth.py:349: in test_load_strategy_invalid_class
    self.assertEqual(response.status_code, 422)
E   AssertionError: 429 != 422
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:46 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:20:46 | INFO | httpx | HTTP Request: POST http://testserver/strategies/load "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/strategies/load "HTTP/1.1 429 Too Many Requests"
__________ TestStrategyEndpoints.test_manage_strategy_invalid_action ___________
tests/integration/test_api_auth.py:337: in test_manage_strategy_invalid_action
    self.assertEqual(response.status_code, 503)
E   AssertionError: 429 != 503
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:46 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:20:46 | INFO | httpx | HTTP Request: POST http://testserver/strategies/invalid_action?strategy_name=test "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/strategies/invalid_action?strategy_name=test "HTTP/1.1 429 Too Many Requests"
___________ TestTradingEndpoints.test_control_trading_invalid_action ___________
tests/integration/test_api_auth.py:373: in test_control_trading_invalid_action
    self.assertEqual(response.status_code, 400)
E   AssertionError: 429 != 400
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:46 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:20:46 | INFO | httpx | HTTP Request: POST http://testserver/trading/invalid_action "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/trading/invalid_action "HTTP/1.1 429 Too Many Requests"
________________ TestTradingEndpoints.test_get_trading_history _________________
tests/integration/test_api_auth.py:368: in test_get_trading_history
    self.assertEqual(response.status_code, 500)
E   AssertionError: 429 != 500
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:46 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:20:46 | INFO | httpx | HTTP Request: GET http://testserver/trading/history "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/trading/history "HTTP/1.1 429 Too Many Requests"
_________________ TestTradingEndpoints.test_get_trading_status _________________
tests/integration/test_api_auth.py:362: in test_get_trading_status
    self.assertEqual(response.status_code, 500)
E   AssertionError: 429 != 500
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:46 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:20:46 | INFO | httpx | HTTP Request: GET http://testserver/trading/status "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/trading/status "HTTP/1.1 429 Too Many Requests"
_________________ TestMetricsEndpoint.test_get_metrics_success _________________
tests/integration/test_api_endpoints.py:225: in test_get_metrics_success
    assert response.headers["content-type"] == "text/plain; charset=utf-8"
E   AssertionError: assert 'text/plain; ...charset=utf-8' == 'text/plain; charset=utf-8'
E     
E     - text/plain; charset=utf-8
E     + text/plain; charset=utf-8; charset=utf-8
E     ?                          +++++++++++++++
---------------------------- Captured stdout setup -----------------------------
2025-12-06 15:20:47 | INFO | market_data_ingestion.market_data_ingestion.core.storage | Connected to SQLite database: /mnt/c/Users/mohit/AppData/Local/Temp/tmp850u61yi.db | trace_id=-
2025-12-06 15:20:47 | INFO | market_data_ingestion.market_data_ingestion.core.storage | Created tables in sqlite database | trace_id=-
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:47 | INFO | httpx | HTTP Request: GET http://testserver/metrics "HTTP/1.1 200 OK" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/metrics "HTTP/1.1 200 OK"
--------------------------- Captured stdout teardown ---------------------------
2025-12-06 15:20:47 | INFO | market_data_ingestion.market_data_ingestion.core.storage | Disconnected from sqlite database | trace_id=-
_____________________ TestHealthEndpoints.test_ready_check _____________________
tests/integration/test_api_endpoints.py:256: in test_ready_check
    assert response.status_code == 200
E   assert 503 == 200
E    +  where 503 = <Response [503 Service Unavailable]>.status_code
---------------------------- Captured stdout setup -----------------------------
2025-12-06 15:20:47 | INFO | market_data_ingestion.market_data_ingestion.core.storage | Connected to SQLite database: /mnt/c/Users/mohit/AppData/Local/Temp/tmpgjvpokj3.db | trace_id=-
2025-12-06 15:20:47 | INFO | market_data_ingestion.market_data_ingestion.core.storage | Created tables in sqlite database | trace_id=-
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:47 | ERROR | market_data_ingestion.market_data_ingestion.src.api | Readiness check failed: 'NoneType' object has no attribute 'execute' | trace_id=-
2025-12-06 15:20:47 | INFO | httpx | HTTP Request: GET http://testserver/ready "HTTP/1.1 503 Service Unavailable" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/ready "HTTP/1.1 503 Service Unavailable"
--------------------------- Captured stdout teardown ---------------------------
2025-12-06 15:20:47 | INFO | market_data_ingestion.market_data_ingestion.core.storage | Disconnected from sqlite database | trace_id=-
_____________________ TestSymbolsEndpoint.test_get_symbols _____________________
tests/integration/test_api_endpoints.py:269: in test_get_symbols
    assert response.status_code == 200
E   assert 500 == 200
E    +  where 500 = <Response [500 Internal Server Error]>.status_code
---------------------------- Captured stdout setup -----------------------------
2025-12-06 15:20:47 | INFO | market_data_ingestion.market_data_ingestion.core.storage | Connected to SQLite database: /mnt/c/Users/mohit/AppData/Local/Temp/tmp8yq8l6kf.db | trace_id=-
2025-12-06 15:20:47 | INFO | market_data_ingestion.market_data_ingestion.core.storage | Created tables in sqlite database | trace_id=-
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:47 | ERROR | market_data_ingestion.market_data_ingestion.src.api | Error fetching symbols: 'NoneType' object has no attribute 'execute' | trace_id=-
2025-12-06 15:20:47 | INFO | httpx | HTTP Request: GET http://testserver/symbols "HTTP/1.1 500 Internal Server Error" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/symbols "HTTP/1.1 500 Internal Server Error"
--------------------------- Captured stdout teardown ---------------------------
2025-12-06 15:20:47 | INFO | market_data_ingestion.market_data_ingestion.core.storage | Disconnected from sqlite database | trace_id=-
__________________ test_process_symbol_invokes_signal_handler __________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
______________ test_backend_metrics_endpoint_includes_components _______________
tests/integration/test_health_and_metrics_stack.py:13: in test_backend_metrics_endpoint_includes_components
    assert "portfolio_metrics" in payload
E   AssertionError: assert 'portfolio_metrics' in {'dependencies': {'cache': 'unhealthy'}, 'logger_metrics': {}, 'portfolio': {}, 'system': {'dependencies': {'cache': 'unhealthy'}, 'logger_metrics': {}}, ...}
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:48 | INFO | httpx | HTTP Request: GET http://testserver/metrics "HTTP/1.1 200 OK" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/metrics "HTTP/1.1 200 OK"
____________________ test_health_check_reports_service_name ____________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
____________________ test_readiness_check_queries_database _____________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
____________________ test_readiness_check_propagates_errors ____________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
_______________________ test_get_candles_returns_payload _______________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
_____________________ test_get_candles_raises_when_no_data _____________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
______________________ test_backfill_api_command_executes ______________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
______________________ test_backfill_csv_command_ingests _______________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
___________________ test_replay_dlq_command_invokes_handler ____________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
____________ test_candle_aggregator_emits_payload_for_each_interval ____________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
__________________ test_tick_aggregator_flushes_all_intervals __________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
____________________ test_trigger_refresh_invokes_backfill _____________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
________________ test_fetch_historical_data_invokes_rate_limit _________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
______________________ test_kite_adapter_normalizes_ticks ______________________
tests/market_data_ingestion/test_source_adapters_mcxticks.py:25: in test_kite_adapter_normalizes_ticks
    adapter = _adapter()
              ^^^^^^^^^^
tests/market_data_ingestion/test_source_adapters_mcxticks.py:14: in _adapter
    return KiteWebSocketAdapter(
E   TypeError: Can't instantiate abstract class KiteWebSocketAdapter without an implementation for abstract method 'close'
______________ test_process_message_returns_none_for_invalid_json ______________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
_____________________ test_process_message_uses_normalizer _____________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
__________________ test_postgres_connection_uses_asyncpg_pool __________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
_________________ test_sqlite_candles_can_be_dumped_to_parquet _________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
_________ TestAggregatorPerformance.test_tick_aggregation_performance __________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
_____ TestAggregatorPerformance.test_multi_symbol_aggregation_performance ______
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
_________________ test_can_open_trade_respects_risk_per_trade __________________
tests/risk/test_var_and_drawdown.py:11: in test_can_open_trade_respects_risk_per_trade
    assert engine.can_open_trade(size=5, stop_distance=100) is False
E   assert True is False
E    +  where True = can_open_trade(size=5, stop_distance=100)
E    +    where can_open_trade = RiskEngine(capital=100000, max_risk_per_trade=0.01, max_daily_loss=0.03, max_lot_size=10.0, max_trades_per_day=20, sl_range=(0.001, 0.1), tp_range=(0.001, 0.2), current_day_pnl=0.0, trade_count_today=0, current_day=datetime.date(2025, 12, 6)).can_open_trade
_______________________ test_dev_run_backend_entrypoint ________________________
tests/scripts/test_dev_run_entrypoints.py:14: in test_dev_run_backend_entrypoint
    with patch("subprocess.run") as mock_run, \
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'scripts.dev_run' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/scripts/dev_run.py'> does not have the attribute 'load_config'
______________________ test_dev_run_ingestion_entrypoint _______________________
tests/scripts/test_dev_run_entrypoints.py:37: in test_dev_run_ingestion_entrypoint
    with patch("subprocess.run") as mock_run, \
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'scripts.dev_run' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/scripts/dev_run.py'> does not have the attribute 'load_config'
________________________ test_dev_run_engine_entrypoint ________________________
tests/scripts/test_dev_run_entrypoints.py:58: in test_dev_run_engine_entrypoint
    with patch("subprocess.run") as mock_run, \
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'scripts.dev_run' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/scripts/dev_run.py'> does not have the attribute 'load_config'
________________________ test_dev_run_with_config_file _________________________
tests/scripts/test_dev_run_entrypoints.py:88: in test_dev_run_with_config_file
    with patch("subprocess.run") as mock_run, \
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'scripts.dev_run' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/scripts/dev_run.py'> does not have the attribute 'load_config'
______________________ test_dev_run_environment_variables ______________________
tests/scripts/test_dev_run_entrypoints.py:109: in test_dev_run_environment_variables
    with patch("subprocess.run") as mock_run, \
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'scripts.dev_run' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/scripts/dev_run.py'> does not have the attribute 'load_config'
____________________ test_dev_run_shutdown_signal_handling _____________________
tests/scripts/test_dev_run_entrypoints.py:133: in test_dev_run_shutdown_signal_handling
    with patch("subprocess.run") as mock_run, \
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'scripts.dev_run' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/scripts/dev_run.py'> does not have the attribute 'load_config'
_______________________ test_dev_run_process_monitoring ________________________
tests/scripts/test_dev_run_entrypoints.py:154: in test_dev_run_process_monitoring
    with patch("subprocess.run") as mock_run, \
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'scripts.dev_run' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/scripts/dev_run.py'> does not have the attribute 'load_config'
_________________________ test_dev_run_log_file_output _________________________
tests/scripts/test_dev_run_entrypoints.py:171: in test_dev_run_log_file_output
    with patch("subprocess.run") as mock_run, \
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'scripts.dev_run' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/scripts/dev_run.py'> does not have the attribute 'load_config'
________________________ test_dev_run_multiple_services ________________________
tests/scripts/test_dev_run_entrypoints.py:192: in test_dev_run_multiple_services
    with patch("subprocess.run") as mock_run, \
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'scripts.dev_run' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/scripts/dev_run.py'> does not have the attribute 'load_config'
________________________ test_dev_run_dependency_check _________________________
tests/scripts/test_dev_run_entrypoints.py:211: in test_dev_run_dependency_check
    with patch("subprocess.run") as mock_run, \
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'scripts.dev_run' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/scripts/dev_run.py'> does not have the attribute 'load_config'
_______________________ test_dev_run_dependency_failure ________________________
tests/scripts/test_dev_run_entrypoints.py:231: in test_dev_run_dependency_failure
    with patch("scripts.dev_run.check_dependencies") as mock_check:
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'scripts.dev_run' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/scripts/dev_run.py'> does not have the attribute 'check_dependencies'
__________________________ test_dev_run_health_check ___________________________
tests/scripts/test_dev_run_entrypoints.py:243: in test_dev_run_health_check
    with patch("subprocess.run") as mock_run, \
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'scripts.dev_run' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/scripts/dev_run.py'> does not have the attribute 'load_config'
______________________ test_dev_run_health_check_timeout _______________________
tests/scripts/test_dev_run_entrypoints.py:264: in test_dev_run_health_check_timeout
    with patch("scripts.dev_run.wait_for_service") as mock_wait:
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'scripts.dev_run' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/scripts/dev_run.py'> does not have the attribute 'wait_for_service'
______________________ test_dev_run_reload_on_file_change ______________________
tests/scripts/test_dev_run_entrypoints.py:276: in test_dev_run_reload_on_file_change
    with patch("subprocess.run") as mock_run, \
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'scripts.dev_run' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/scripts/dev_run.py'> does not have the attribute 'load_config'
___________________________ test_dev_run_debug_mode ____________________________
tests/scripts/test_dev_run_entrypoints.py:296: in test_dev_run_debug_mode
    with patch("subprocess.run") as mock_run, \
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'scripts.dev_run' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/scripts/dev_run.py'> does not have the attribute 'load_config'
__________________________ test_dev_run_profile_mode ___________________________
tests/scripts/test_dev_run_entrypoints.py:318: in test_dev_run_profile_mode
    with patch("subprocess.run") as mock_run, \
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'scripts.dev_run' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/scripts/dev_run.py'> does not have the attribute 'load_config'
_____________________ test_dev_run_with_custom_python_path _____________________
tests/scripts/test_dev_run_entrypoints.py:338: in test_dev_run_with_custom_python_path
    with patch("subprocess.run") as mock_run, \
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'scripts.dev_run' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/scripts/dev_run.py'> does not have the attribute 'load_config'
________________________ test_dev_run_service_discovery ________________________
tests/scripts/test_dev_run_entrypoints.py:359: in test_dev_run_service_discovery
    with patch("subprocess.run") as mock_run, \
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'scripts.dev_run' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/scripts/dev_run.py'> does not have the attribute 'load_config'
_________________________ test_dev_run_cleanup_on_exit _________________________
tests/scripts/test_dev_run_entrypoints.py:379: in test_dev_run_cleanup_on_exit
    with patch("subprocess.run") as mock_run, \
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'scripts.dev_run' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/scripts/dev_run.py'> does not have the attribute 'load_config'
____________________ test_regression_triggers_buy_then_flat ____________________
tests/strategies/regression/test_ema_crossover_regression.py:32: in test_regression_triggers_buy_then_flat
    assert SignalAction.FLAT in signals
E   AssertionError: assert <SignalAction.FLAT: 'flat'> in [<SignalAction.BUY: 'buy'>]
E    +  where <SignalAction.FLAT: 'flat'> = SignalAction.FLAT
_______________ test_validate_order_rejects_when_margin_missing ________________
tests/strategies/test_risk_overrides.py:24: in test_validate_order_rejects_when_margin_missing
    assert "margin" in reason.lower()
E   AssertionError: assert 'margin' in 'risk per trade exceeds limit: 2000.00 > 100.00'
E    +  where 'risk per trade exceeds limit: 2000.00 > 100.00' = <built-in method lower of str object at 0x77680f76ae50>()
E    +    where <built-in method lower of str object at 0x77680f76ae50> = 'Risk per trade exceeds limit: 2000.00 > 100.00'.lower
____________________ TestHealthEndpoints.test_health_check _____________________
tests/test_api_market_data.py:48: in test_health_check
    response = client.get("/health")
               ^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:499: in get
    return super().get(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:1053: in get
    return self.request(
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:465: in request
    return super().request(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:342: in handle_request
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:339: in handle_request
    portal.call(self.app, scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/anyio/from_thread.py:277: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/concurrent/futures/_base.py:456: in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
/home/mohit/.local/lib/python3.12/site-packages/anyio/from_thread.py:217: in _call_func
    retval = await retval
             ^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/fastapi/applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/errors.py:184: in __call__
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/errors.py:162: in __call__
    await self.app(scope, receive, _send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:79: in __call__
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
/home/mohit/.local/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py:20: in __call__
    raise e
/home/mohit/.local/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:718: in __call__
    await route.handle(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:276: in handle
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:66: in app
    response = await func(request)
                     ^^^^^^^^^^^^^
E   TypeError: health_check() takes 0 positional arguments but 1 was given
____________________ TestHealthEndpoints.test_healthz_alias ____________________
tests/test_api_market_data.py:56: in test_healthz_alias
    response = client.get("/healthz")
               ^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:499: in get
    return super().get(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:1053: in get
    return self.request(
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:465: in request
    return super().request(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:342: in handle_request
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:339: in handle_request
    portal.call(self.app, scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/anyio/from_thread.py:277: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/concurrent/futures/_base.py:449: in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
/home/mohit/.local/lib/python3.12/site-packages/anyio/from_thread.py:217: in _call_func
    retval = await retval
             ^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/fastapi/applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/errors.py:184: in __call__
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/errors.py:162: in __call__
    await self.app(scope, receive, _send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:79: in __call__
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
/home/mohit/.local/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py:20: in __call__
    raise e
/home/mohit/.local/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:718: in __call__
    await route.handle(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:276: in handle
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:66: in app
    response = await func(request)
                     ^^^^^^^^^^^^^
E   TypeError: healthz() takes 0 positional arguments but 1 was given
_______________ TestHealthEndpoints.test_readiness_check_success _______________
tests/test_api_market_data.py:70: in test_readiness_check_success
    response = client.get("/ready")
               ^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:499: in get
    return super().get(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:1053: in get
    return self.request(
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:465: in request
    return super().request(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:342: in handle_request
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:339: in handle_request
    portal.call(self.app, scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/anyio/from_thread.py:277: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/concurrent/futures/_base.py:449: in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
/home/mohit/.local/lib/python3.12/site-packages/anyio/from_thread.py:217: in _call_func
    retval = await retval
             ^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/fastapi/applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/errors.py:184: in __call__
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/errors.py:162: in __call__
    await self.app(scope, receive, _send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:79: in __call__
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
/home/mohit/.local/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py:20: in __call__
    raise e
/home/mohit/.local/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:718: in __call__
    await route.handle(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:276: in handle
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:66: in app
    response = await func(request)
                     ^^^^^^^^^^^^^
E   TypeError: readiness_check() takes 0 positional arguments but 1 was given
_______________ TestHealthEndpoints.test_readiness_check_failure _______________
tests/test_api_market_data.py:84: in test_readiness_check_failure
    response = client.get("/ready")
               ^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:499: in get
    return super().get(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:1053: in get
    return self.request(
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:465: in request
    return super().request(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:342: in handle_request
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:339: in handle_request
    portal.call(self.app, scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/anyio/from_thread.py:277: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/concurrent/futures/_base.py:449: in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
/home/mohit/.local/lib/python3.12/site-packages/anyio/from_thread.py:217: in _call_func
    retval = await retval
             ^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/fastapi/applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/errors.py:184: in __call__
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/errors.py:162: in __call__
    await self.app(scope, receive, _send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:79: in __call__
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
/home/mohit/.local/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py:20: in __call__
    raise e
/home/mohit/.local/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:718: in __call__
    await route.handle(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:276: in handle
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:66: in app
    response = await func(request)
                     ^^^^^^^^^^^^^
E   TypeError: readiness_check() takes 0 positional arguments but 1 was given
____________________ TestHealthEndpoints.test_readyz_alias _____________________
tests/test_api_market_data.py:91: in test_readyz_alias
    response = client.get("/readyz")
               ^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:499: in get
    return super().get(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:1053: in get
    return self.request(
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:465: in request
    return super().request(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:342: in handle_request
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:339: in handle_request
    portal.call(self.app, scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/anyio/from_thread.py:277: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/concurrent/futures/_base.py:449: in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
/home/mohit/.local/lib/python3.12/site-packages/anyio/from_thread.py:217: in _call_func
    retval = await retval
             ^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/fastapi/applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/errors.py:184: in __call__
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/errors.py:162: in __call__
    await self.app(scope, receive, _send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:79: in __call__
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
/home/mohit/.local/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py:20: in __call__
    raise e
/home/mohit/.local/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:718: in __call__
    await route.handle(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:276: in handle
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:66: in app
    response = await func(request)
                     ^^^^^^^^^^^^^
E   TypeError: readyz() takes 0 positional arguments but 1 was given
_____________________ TestMetricsEndpoint.test_get_metrics _____________________
tests/test_api_market_data.py:103: in test_get_metrics
    response = client.get("/metrics")
               ^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:499: in get
    return super().get(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:1053: in get
    return self.request(
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:465: in request
    return super().request(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:342: in handle_request
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:339: in handle_request
    portal.call(self.app, scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/anyio/from_thread.py:277: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/concurrent/futures/_base.py:449: in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
/home/mohit/.local/lib/python3.12/site-packages/anyio/from_thread.py:217: in _call_func
    retval = await retval
             ^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/fastapi/applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/errors.py:184: in __call__
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/errors.py:162: in __call__
    await self.app(scope, receive, _send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:79: in __call__
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
/home/mohit/.local/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py:20: in __call__
    raise e
/home/mohit/.local/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:718: in __call__
    await route.handle(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:276: in handle
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:66: in app
    response = await func(request)
                     ^^^^^^^^^^^^^
E   TypeError: get_metrics() takes 0 positional arguments but 1 was given
_________________ TestCandlesEndpoint.test_get_candles_success _________________
tests/test_api_market_data.py:121: in test_get_candles_success
    response = client.get("/candles?symbol=AAPL&interval=1m&limit=50")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:499: in get
    return super().get(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:1053: in get
    return self.request(
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:465: in request
    return super().request(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:342: in handle_request
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:339: in handle_request
    portal.call(self.app, scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/anyio/from_thread.py:277: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/concurrent/futures/_base.py:456: in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
/home/mohit/.local/lib/python3.12/site-packages/anyio/from_thread.py:217: in _call_func
    retval = await retval
             ^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/fastapi/applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/errors.py:184: in __call__
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/errors.py:162: in __call__
    await self.app(scope, receive, _send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:79: in __call__
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
/home/mohit/.local/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py:20: in __call__
    raise e
/home/mohit/.local/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:718: in __call__
    await route.handle(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:276: in handle
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:69: in app
    await response(scope, receive, send)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: 'dict' object is not callable
_________________ TestCandlesEndpoint.test_get_candles_no_data _________________
tests/test_api_market_data.py:136: in test_get_candles_no_data
    assert "No data found for symbol INVALID" in response.json()["detail"]
E   AssertionError: assert 'No data found for symbol INVALID' in 'No data found for symbol <starlette.requests.Request object at 0x77680f736210>'
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:52 | INFO | httpx | HTTP Request: GET http://testserver/candles?symbol=INVALID&interval=1m&limit=10 "HTTP/1.1 404 Not Found" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/candles?symbol=INVALID&interval=1m&limit=10 "HTTP/1.1 404 Not Found"
_____________ TestCandlesEndpoint.test_get_candles_missing_symbol ______________
tests/test_api_market_data.py:150: in test_get_candles_missing_symbol
    assert response.status_code == 422  # Validation error
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   assert 404 == 422
E    +  where 404 = <Response [404 Not Found]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:52 | ERROR | market_data_ingestion.market_data_ingestion.core.storage | Error fetching last N candles from sqlite database: 'NoneType' object has no attribute 'execute' | trace_id=-
2025-12-06 15:20:52 | INFO | httpx | HTTP Request: GET http://testserver/candles?interval=1m&limit=10 "HTTP/1.1 404 Not Found" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/candles?interval=1m&limit=10 "HTTP/1.1 404 Not Found"
______________ TestCandlesEndpoint.test_get_candles_invalid_limit ______________
tests/test_api_market_data.py:156: in test_get_candles_invalid_limit
    assert response.status_code == 422
E   assert 404 == 422
E    +  where 404 = <Response [404 Not Found]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:52 | ERROR | market_data_ingestion.market_data_ingestion.core.storage | Error fetching last N candles from sqlite database: 'NoneType' object has no attribute 'execute' | trace_id=-
2025-12-06 15:20:52 | INFO | httpx | HTTP Request: GET http://testserver/candles?symbol=AAPL&interval=1m&limit=0 "HTTP/1.1 404 Not Found" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/candles?symbol=AAPL&interval=1m&limit=0 "HTTP/1.1 404 Not Found"
_________________ TestSymbolsEndpoint.test_get_symbols_success _________________
tests/test_api_market_data.py:175: in test_get_symbols_success
    response = client.get("/symbols")
               ^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:499: in get
    return super().get(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:1053: in get
    return self.request(
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:465: in request
    return super().request(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:342: in handle_request
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:339: in handle_request
    portal.call(self.app, scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/anyio/from_thread.py:277: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/concurrent/futures/_base.py:456: in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
/home/mohit/.local/lib/python3.12/site-packages/anyio/from_thread.py:217: in _call_func
    retval = await retval
             ^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/fastapi/applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/errors.py:184: in __call__
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/errors.py:162: in __call__
    await self.app(scope, receive, _send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:79: in __call__
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
/home/mohit/.local/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py:20: in __call__
    raise e
/home/mohit/.local/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:718: in __call__
    await route.handle(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:276: in handle
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:66: in app
    response = await func(request)
                     ^^^^^^^^^^^^^
E   TypeError: get_available_symbols() takes 0 positional arguments but 1 was given
__________________ TestSymbolsEndpoint.test_get_symbols_empty __________________
tests/test_api_market_data.py:193: in test_get_symbols_empty
    response = client.get("/symbols")
               ^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:499: in get
    return super().get(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:1053: in get
    return self.request(
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:465: in request
    return super().request(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:342: in handle_request
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:339: in handle_request
    portal.call(self.app, scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/anyio/from_thread.py:277: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/concurrent/futures/_base.py:449: in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
/home/mohit/.local/lib/python3.12/site-packages/anyio/from_thread.py:217: in _call_func
    retval = await retval
             ^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/fastapi/applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/errors.py:184: in __call__
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/errors.py:162: in __call__
    await self.app(scope, receive, _send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:79: in __call__
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
/home/mohit/.local/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py:20: in __call__
    raise e
/home/mohit/.local/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:718: in __call__
    await route.handle(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:276: in handle
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:66: in app
    response = await func(request)
                     ^^^^^^^^^^^^^
E   TypeError: get_available_symbols() takes 0 positional arguments but 1 was given
________________ TestSymbolsEndpoint.test_get_symbols_db_error _________________
tests/test_api_market_data.py:206: in test_get_symbols_db_error
    response = client.get("/symbols")
               ^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:499: in get
    return super().get(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:1053: in get
    return self.request(
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:465: in request
    return super().request(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:342: in handle_request
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:339: in handle_request
    portal.call(self.app, scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/anyio/from_thread.py:277: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/concurrent/futures/_base.py:456: in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
/home/mohit/.local/lib/python3.12/site-packages/anyio/from_thread.py:217: in _call_func
    retval = await retval
             ^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/fastapi/applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/errors.py:184: in __call__
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/errors.py:162: in __call__
    await self.app(scope, receive, _send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:79: in __call__
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
/home/mohit/.local/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py:20: in __call__
    raise e
/home/mohit/.local/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:718: in __call__
    await route.handle(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:276: in handle
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:66: in app
    response = await func(request)
                     ^^^^^^^^^^^^^
E   TypeError: get_available_symbols() takes 0 positional arguments but 1 was given
________________ TestAuthEndpoints.test_register_invalid_email _________________
tests/test_api_market_data.py:250: in test_register_invalid_email
    assert "Invalid email format" in response.json()["detail"]
E   AssertionError: assert 'Invalid email format' in 'Username already exists'
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:53 | INFO | httpx | HTTP Request: POST http://testserver/api/auth/register "HTTP/1.1 400 Bad Request" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/auth/register "HTTP/1.1 400 Bad Request"
________________ TestAuthEndpoints.test_register_weak_password _________________
tests/test_api_market_data.py:261: in test_register_weak_password
    assert "Password must be at least 8 characters" in response.json()["detail"]
E   AssertionError: assert 'Password must be at least 8 characters' in 'Username already exists'
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:53 | INFO | httpx | HTTP Request: POST http://testserver/api/auth/register "HTTP/1.1 400 Bad Request" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/auth/register "HTTP/1.1 400 Bad Request"
________________________ TestAuthEndpoints.test_logout _________________________
tests/test_api_market_data.py:298: in test_logout
    assert response.status_code in [200, 401]  # 401 if auth required
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   assert 403 in [200, 401]
E    +  where 403 = <Response [403 Forbidden]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:20:54 | INFO | httpx | HTTP Request: POST http://testserver/api/auth/logout "HTTP/1.1 403 Forbidden" | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/auth/logout "HTTP/1.1 403 Forbidden"
______________________ TestIntegration.test_full_workflow ______________________
tests/test_api_market_data.py:317: in test_full_workflow
    response = client.get("/health")
               ^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:499: in get
    return super().get(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:1053: in get
    return self.request(
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:465: in request
    return super().request(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:914: in send
    response = self._send_handling_auth(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:342: in handle_request
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:339: in handle_request
    portal.call(self.app, scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/anyio/from_thread.py:277: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/concurrent/futures/_base.py:456: in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
/home/mohit/.local/lib/python3.12/site-packages/anyio/from_thread.py:217: in _call_func
    retval = await retval
             ^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/fastapi/applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/errors.py:184: in __call__
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/errors.py:162: in __call__
    await self.app(scope, receive, _send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:79: in __call__
    raise exc
/home/mohit/.local/lib/python3.12/site-packages/starlette/middleware/exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
/home/mohit/.local/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py:20: in __call__
    raise e
/home/mohit/.local/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:718: in __call__
    await route.handle(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:276: in handle
    await self.app(scope, receive, send)
/home/mohit/.local/lib/python3.12/site-packages/starlette/routing.py:66: in app
    response = await func(request)
                     ^^^^^^^^^^^^^
E   TypeError: health_check() takes 0 positional arguments but 1 was given
________________________ test_database_url_construction ________________________
tests/test_config_loading.py:48: in test_database_url_construction
    assert settings.database_url == expected_url
E   AssertionError: assert 'sqlite:///:memory:' == 'postgresql:/...t:5432/testdb'
E     
E     - postgresql://testuser:testpass@localhost:5432/testdb
E     + sqlite:///:memory:
_____________________ test_database_url_fallback_to_sqlite _____________________
tests/test_config_loading.py:61: in test_database_url_fallback_to_sqlite
    assert settings.database_url == "sqlite:///test.db"
E   AssertionError: assert 'sqlite:///:memory:' == 'sqlite:///test.db'
E     
E     - sqlite:///test.db
E     + sqlite:///:memory:
__________________________ test_broker_config_loading __________________________
tests/test_config_loading.py:79: in test_broker_config_loading
    assert hasattr(settings, 'kite_api_key')
E   AssertionError: assert False
E    +  where False = hasattr(BackendSettings(finbot_mode='dev', live_trading_confirm=False, app_use_case='PERSONAL_EXPERIMENTAL', app_env='test', app_name='Finbot Trading API', app_version='1.0.0', app_host='0.0.0.0', app_port=8000, allow_origins=['http://localhost:8501', 'http://localhost:5173', 'http://localhost:3000'], database_url='sqlite:///:memory:', database_host='localhost', database_port=5432, database_name='finbot_db', database_user='finbot_user', database_password=None, redis_url=None, cache_ttl_seconds=60, sentry_dsn=None, jwt_secret_key='change-me', jwt_algorithm='HS256', trading_mode='paper', update_interval_seconds=5.0, default_symbols=['AAPL', 'GOOGL', 'MSFT'], max_drawdown=0.15, max_daily_loss=0.05, max_position_size=0.1, initial_cash=100000.0, log_level='WARNING', log_dir='/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/tests/integration/logs', log_filename='finbot.log', log_file='/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/tests/integration/logs/test-finbot.log', log_max_size=10485760, log_backup_count=5, health_check_interval=30, metrics_retention_days=30, enable_prometheus_metrics=False, prometheus_port=9090, news_database_url=None, news_enable_ai=True, news_max_articles=25, news_scheduler_run_time='06:00', news_scheduler_timezone='UTC', news_scheduler_enabled=True, news_sources=[{'name': 'WSJ Markets', 'type': 'rss', 'url': 'https://feeds.a.dj.com/rss/RSSMarketsMain.xml', 'symbols': ['AAPL', 'MSFT', 'NVDA']}, {'name': 'Finviz', 'type': 'rss', 'url': 'https://finviz.com/feed.ashx', 'symbols': ['SPY', 'QQQ']}], finbot_live_trading_confirm='false', mvp_max_daily_loss='10000', mvp_max_position_size='200', mvp_max_positions='2'), 'kite_api_key')
__________________________ test_feature_flags_loading __________________________
tests/test_config_loading.py:121: in test_feature_flags_loading
    assert hasattr(settings, 'enable_ai_features')
E   AssertionError: assert False
E    +  where False = hasattr(BackendSettings(finbot_mode='dev', live_trading_confirm=False, app_use_case='PERSONAL_EXPERIMENTAL', app_env='test', app_name='Finbot Trading API', app_version='1.0.0', app_host='0.0.0.0', app_port=8000, allow_origins=['http://localhost:8501', 'http://localhost:5173', 'http://localhost:3000'], database_url='sqlite:///:memory:', database_host='localhost', database_port=5432, database_name='finbot_db', database_user='finbot_user', database_password=None, redis_url=None, cache_ttl_seconds=60, sentry_dsn=None, jwt_secret_key='change-me', jwt_algorithm='HS256', trading_mode='paper', update_interval_seconds=5.0, default_symbols=['AAPL', 'GOOGL', 'MSFT'], max_drawdown=0.15, max_daily_loss=0.05, max_position_size=0.1, initial_cash=100000.0, log_level='WARNING', log_dir='/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/tests/integration/logs', log_filename='finbot.log', log_file='/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/tests/integration/logs/test-finbot.log', log_max_size=10485760, log_backup_count=5, health_check_interval=30, metrics_retention_days=30, enable_prometheus_metrics=False, prometheus_port=9090, news_database_url=None, news_enable_ai=True, news_max_articles=25, news_scheduler_run_time='06:00', news_scheduler_timezone='UTC', news_scheduler_enabled=True, news_sources=[{'name': 'WSJ Markets', 'type': 'rss', 'url': 'https://feeds.a.dj.com/rss/RSSMarketsMain.xml', 'symbols': ['AAPL', 'MSFT', 'NVDA']}, {'name': 'Finviz', 'type': 'rss', 'url': 'https://finviz.com/feed.ashx', 'symbols': ['SPY', 'QQQ']}], finbot_live_trading_confirm='false', mvp_max_daily_loss='10000', mvp_max_position_size='200', mvp_max_positions='2'), 'enable_ai_features')
____________________________ test_config_validation ____________________________
tests/test_config_loading.py:137: in test_config_validation
    with pytest.raises(ValueError):
E   Failed: DID NOT RAISE <class 'ValueError'>
__________________________ test_config_from_env_file ___________________________
tests/test_config_loading.py:169: in test_config_from_env_file
    with patch("backend.config.settings.load_dotenv") as mock_load:
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'backend.config.settings' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py'> does not have the attribute 'load_dotenv'
______________________ test_strategy_initializes_defaults ______________________
tests/test_ema_crossover_strategy.py:27: in test_strategy_initializes_defaults
    assert strategy.short_ema is None
           ^^^^^^^^^^^^^^^^^^
E   AttributeError: 'EMACrossoverStrategy' object has no attribute 'short_ema'
________________ test_strategy_emits_buy_and_sell_on_crossovers ________________
tests/test_ema_crossover_strategy.py:38: in test_strategy_emits_buy_and_sell_on_crossovers
    strategy.update(_make_candle(price, idx=idx))
    ^^^^^^^^^^^^^^^
E   AttributeError: 'EMACrossoverStrategy' object has no attribute 'update'
_________________ test_strategy_returns_none_when_no_crossover _________________
tests/test_ema_crossover_strategy.py:49: in test_strategy_returns_none_when_no_crossover
    strategy.update(_make_candle(price, idx=idx))
    ^^^^^^^^^^^^^^^
E   AttributeError: 'EMACrossoverStrategy' object has no attribute 'update'
______________________ test_ema_values_progress_over_time ______________________
tests/test_ema_crossover_strategy.py:59: in test_ema_values_progress_over_time
    strategy.update(_make_candle(price, idx=idx))
    ^^^^^^^^^^^^^^^
E   AttributeError: 'EMACrossoverStrategy' object has no attribute 'update'
__________________ test_ema_crossover_emits_signals_on_cross ___________________
tests/test_ema_strategy.py:28: in test_ema_crossover_emits_signals_on_cross
    strat.update(candle)
    ^^^^^^^^^^^^
E   AttributeError: 'EMACrossoverStrategy' object has no attribute 'update'
________________________ test_finbot_mode_valid_values _________________________
tests/test_env_modes.py:11: in test_finbot_mode_valid_values
    from common.env import get_mode  # Adjust import as needed
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   ImportError: cannot import name 'get_mode' from 'common.env' (/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/common/env.py)
_________________ test_finbot_mode_invalid_value_raises_error __________________
tests/test_env_modes.py:22: in test_finbot_mode_invalid_value_raises_error
    from common.env import get_mode  # Adjust import as needed
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   ImportError: cannot import name 'get_mode' from 'common.env' (/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/common/env.py)
_____________________ test_live_mode_requires_confirmation _____________________
tests/test_env_modes.py:39: in test_live_mode_requires_confirmation
    assert settings.finbot_mode == "paper"  # Should be downgraded
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AssertionError: assert 'live' == 'paper'
E     
E     - paper
E     + live
____________________________ test_env_file_loading _____________________________
tests/test_env_modes.py:77: in test_env_file_loading
    with patch("scripts.dev_run.read_env_file", return_value={
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'scripts.dev_run' from '/mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/scripts/dev_run.py'> does not have the attribute 'read_env_file'
___________________________ test_safety_audit_script ___________________________
tests/test_env_modes.py:91: in test_safety_audit_script
    assert normalize_mode("dev") == "dev"
E   AssertionError: assert 'DEV' == 'dev'
E     
E     - dev
E     + DEV
_______________ test_full_pipeline_intraday_ema_with_mock_broker _______________
tests/test_full_pipeline.py:73: in test_full_pipeline_intraday_ema_with_mock_broker
    strategy.update(candle)
    ^^^^^^^^^^^^^^^
E   AttributeError: 'EMACrossoverStrategy' object has no attribute 'update'
__________________________ test_ready_endpoint_alias ___________________________
tests/test_health_endpoints.py:97: in test_ready_endpoint_alias
    assert ready_response.status_code == health_response.status_code
E   assert 404 == 200
E    +  where 404 = <Response [404 Not Found]>.status_code
E    +  and   200 = <Response [200 OK]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:21:04 | WARNING | backend.api.main | Slow response /health: 783.94ms | trace_id=-
2025-12-06 15:21:04 | INFO | httpx | HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK" | trace_id=-
2025-12-06 15:21:04 | INFO | httpx | HTTP Request: GET http://testserver/ready "HTTP/1.1 404 Not Found" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.api.main:main.py:209 Slow response /health: 783.94ms
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/ready "HTTP/1.1 404 Not Found"
___________________________ test_live_endpoint_alias ___________________________
tests/test_health_endpoints.py:106: in test_live_endpoint_alias
    assert live_response.status_code == health_response.status_code
E   assert 429 == 200
E    +  where 429 = <Response [429 Too Many Requests]>.status_code
E    +  and   200 = <Response [200 OK]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:21:05 | WARNING | backend.api.main | Slow response /health: 836.84ms | trace_id=-
2025-12-06 15:21:05 | INFO | httpx | HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK" | trace_id=-
2025-12-06 15:21:05 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:21:05 | INFO | httpx | HTTP Request: GET http://testserver/live "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.api.main:main.py:209 Slow response /health: 836.84ms
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/live "HTTP/1.1 429 Too Many Requests"
___________________________ test_api_health_endpoint ___________________________
tests/test_health_endpoints.py:114: in test_api_health_endpoint
    assert response.status_code == 200
E   assert 429 == 200
E    +  where 429 = <Response [429 Too Many Requests]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:21:05 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:21:05 | INFO | httpx | HTTP Request: GET http://testserver/api/health "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/api/health "HTTP/1.1 429 Too Many Requests"
____________________ test_health_endpoint_timestamp_format _____________________
tests/test_health_endpoints.py:182: in test_health_endpoint_timestamp_format
    assert "Z" in timestamp or "+" in timestamp or "-" in timestamp[-6:]
E   AssertionError: assert ('Z' in '2025-12-06T15:21:08.176361' or '+' in '2025-12-06T15:21:08.176361' or '-' in '176361')
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:21:08 | WARNING | backend.api.main | Slow response /health: 1107.96ms | trace_id=-
2025-12-06 15:21:08 | INFO | httpx | HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.api.main:main.py:209 Slow response /health: 1107.96ms
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
_________________ test_health_endpoint_cache_dependency_check __________________
tests/test_health_endpoints.py:198: in test_health_endpoint_cache_dependency_check
    assert "cache" in str(data).lower()  # Flexible check
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   assert 'cache' in "{'status': 'degraded', 'timestamp': '2025-12-06t15:21:09.739151', 'version': '1.0.0', 'services': {'strategy_manager': 'unhealthy', 'portfolio_manager': 'unhealthy', 'logger': 'unhealthy', 'trading_engine': 'unhealthy'}, 'database': {'status': 'healthy', 'latency_ms': 5.03}, 'external_apis': {'alphavantage': {'status': 'healthy', 'latency_ms': 494.03}, 'yahoo_finance': {'status': 'healthy', 'latency_ms': 1038.21}}}"
E    +  where "{'status': 'degraded', 'timestamp': '2025-12-06t15:21:09.739151', 'version': '1.0.0', 'services': {'strategy_manager': 'unhealthy', 'portfolio_manager': 'unhealthy', 'logger': 'unhealthy', 'trading_engine': 'unhealthy'}, 'database': {'status': 'healthy', 'latency_ms': 5.03}, 'external_apis': {'alphavantage': {'status': 'healthy', 'latency_ms': 494.03}, 'yahoo_finance': {'status': 'healthy', 'latency_ms': 1038.21}}}" = <built-in method lower of str object at 0x7505d50>()
E    +    where <built-in method lower of str object at 0x7505d50> = "{'status': 'degraded', 'timestamp': '2025-12-06T15:21:09.739151', 'version': '1.0.0', 'services': {'strategy_manager': 'unhealthy', 'portfolio_manager': 'unhealthy', 'logger': 'unhealthy', 'trading_engine': 'unhealthy'}, 'database': {'status': 'healthy', 'latency_ms': 5.03}, 'external_apis': {'alphavantage': {'status': 'healthy', 'latency_ms': 494.03}, 'yahoo_finance': {'status': 'healthy', 'latency_ms': 1038.21}}}".lower
E    +      where "{'status': 'degraded', 'timestamp': '2025-12-06T15:21:09.739151', 'version': '1.0.0', 'services': {'strategy_manager': 'unhealthy', 'portfolio_manager': 'unhealthy', 'logger': 'unhealthy', 'trading_engine': 'unhealthy'}, 'database': {'status': 'healthy', 'latency_ms': 5.03}, 'external_apis': {'alphavantage': {'status': 'healthy', 'latency_ms': 494.03}, 'yahoo_finance': {'status': 'healthy', 'latency_ms': 1038.21}}}" = str({'database': {'latency_ms': 5.03, 'status': 'healthy'}, 'external_apis': {'alphavantage': {'latency_ms': 494.03, 'status': 'healthy'}, 'yahoo_finance': {'latency_ms': 1038.21, 'status': 'healthy'}}, 'services': {'logger': 'unhealthy', 'portfolio_manager': 'unhealthy', 'strategy_manager': 'unhealthy', 'trading_engine': 'unhealthy'}, 'status': 'degraded', ...})
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:21:09 | WARNING | backend.api.main | Slow response /health: 1539.25ms | trace_id=-
2025-12-06 15:21:09 | INFO | httpx | HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.api.main:main.py:209 Slow response /health: 1539.25ms
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
___________________ test_metrics_endpoint_returns_valid_json ___________________
tests/test_logging_and_metrics.py:13: in test_metrics_endpoint_returns_valid_json
    assert response.status_code == 200
E   assert 429 == 200
E    +  where 429 = <Response [429 Too Many Requests]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:21:10 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:21:11 | INFO | httpx | HTTP Request: GET http://testserver/api/metrics "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/api/metrics "HTTP/1.1 429 Too Many Requests"
____________________ test_metrics_endpoint_includes_uptime _____________________
tests/test_logging_and_metrics.py:30: in test_metrics_endpoint_includes_uptime
    assert response.status_code == 200
E   assert 429 == 200
E    +  where 429 = <Response [429 Too Many Requests]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:21:11 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:21:11 | INFO | httpx | HTTP Request: GET http://testserver/api/metrics "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/api/metrics "HTTP/1.1 429 Too Many Requests"
_______________ test_metrics_endpoint_includes_trade_stream_info _______________
tests/test_logging_and_metrics.py:42: in test_metrics_endpoint_includes_trade_stream_info
    assert response.status_code == 200
E   assert 429 == 200
E    +  where 429 = <Response [429 Too Many Requests]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:21:11 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:21:11 | INFO | httpx | HTTP Request: GET http://testserver/api/metrics "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/api/metrics "HTTP/1.1 429 Too Many Requests"
______________ test_metrics_endpoint_includes_dependencies_health ______________
tests/test_logging_and_metrics.py:54: in test_metrics_endpoint_includes_dependencies_health
    assert response.status_code == 200
E   assert 429 == 200
E    +  where 429 = <Response [429 Too Many Requests]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:21:11 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:21:11 | INFO | httpx | HTTP Request: GET http://testserver/api/metrics "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/api/metrics "HTTP/1.1 429 Too Many Requests"
__________________ test_logs_endpoint_returns_structured_logs __________________
tests/test_logging_and_metrics.py:67: in test_logs_endpoint_returns_structured_logs
    assert response.status_code == 200
E   assert 429 == 200
E    +  where 429 = <Response [429 Too Many Requests]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:21:11 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:21:11 | INFO | httpx | HTTP Request: GET http://testserver/api/logs "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/api/logs "HTTP/1.1 429 Too Many Requests"
_____________________ test_logs_endpoint_filters_by_level ______________________
tests/test_logging_and_metrics.py:85: in test_logs_endpoint_filters_by_level
    assert response.status_code == 200
E   assert 429 == 200
E    +  where 429 = <Response [429 Too Many Requests]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:21:11 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:21:11 | INFO | httpx | HTTP Request: GET http://testserver/api/logs?level=ERROR "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/api/logs?level=ERROR "HTTP/1.1 429 Too Many Requests"
______________________ test_logs_endpoint_limits_results _______________________
tests/test_logging_and_metrics.py:98: in test_logs_endpoint_limits_results
    assert response.status_code == 200
E   assert 429 == 200
E    +  where 429 = <Response [429 Too Many Requests]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:21:11 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:21:11 | INFO | httpx | HTTP Request: GET http://testserver/api/logs?limit=5 "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/api/logs?limit=5 "HTTP/1.1 429 Too Many Requests"
________________ test_logs_endpoint_pagination_with_since_until ________________
tests/test_logging_and_metrics.py:113: in test_logs_endpoint_pagination_with_since_until
    assert response.status_code == 200
E   assert 429 == 200
E    +  where 429 = <Response [429 Too Many Requests]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:21:11 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:21:11 | INFO | httpx | HTTP Request: GET http://testserver/api/logs?since=2025-12-06T14:21:11.149707 "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/api/logs?since=2025-12-06T14:21:11.149707 "HTTP/1.1 429 Too Many Requests"
___________________ test_logs_endpoint_masks_sensitive_data ____________________
tests/test_logging_and_metrics.py:130: in test_logs_endpoint_masks_sensitive_data
    "timestamp": datetime.utcnow().isoformat(),
                 ^^^^^^^^
E   NameError: name 'datetime' is not defined. Did you forget to import 'datetime'
_________________ test_logs_endpoint_handles_missing_log_file __________________
tests/test_logging_and_metrics.py:158: in test_logs_endpoint_handles_missing_log_file
    assert response.status_code == 200
E   assert 429 == 200
E    +  where 429 = <Response [429 Too Many Requests]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:21:11 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:21:11 | INFO | httpx | HTTP Request: GET http://testserver/api/logs "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/api/logs "HTTP/1.1 429 Too Many Requests"
_________________ test_logs_endpoint_handles_corrupt_log_file __________________
tests/test_logging_and_metrics.py:177: in test_logs_endpoint_handles_corrupt_log_file
    assert response.status_code in [200, 500]
E   assert 429 in [200, 500]
E    +  where 429 = <Response [429 Too Many Requests]>.status_code
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:21:11 | WARNING | backend.core.rate_limit | Rate limit exceeded for IP: testclient | trace_id=-
2025-12-06 15:21:11 | INFO | httpx | HTTP Request: GET http://testserver/api/logs "HTTP/1.1 429 Too Many Requests" | trace_id=-
------------------------------ Captured log call -------------------------------
WARNING  backend.core.rate_limit:rate_limit.py:79 Rate limit exceeded for IP: testclient
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/api/logs "HTTP/1.1 429 Too Many Requests"
______________________ test_detects_volume_spike_anomaly _______________________
tests/test_stock_scraper.py:33: in test_detects_volume_spike_anomaly
    anomalies = StockScraper.detect_anomalies(bars, volume_window=3)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
data_collector/stock_scraper.py:127: in detect_anomalies
    df.groupby("symbol")["volume"].rolling(volume_window, min_periods=5).mean().reset_index(level=0, drop=True)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/home/mohit/.local/lib/python3.12/site-packages/pandas/core/groupby/groupby.py:3879: in rolling
    return RollingGroupby(
/home/mohit/.local/lib/python3.12/site-packages/pandas/core/window/rolling.py:713: in __init__
    super().__init__(obj, *args, **kwargs)
/home/mohit/.local/lib/python3.12/site-packages/pandas/core/window/rolling.py:170: in __init__
    self._validate()
/home/mohit/.local/lib/python3.12/site-packages/pandas/core/window/rolling.py:1869: in _validate
    super()._validate()
/home/mohit/.local/lib/python3.12/site-packages/pandas/core/window/rolling.py:181: in _validate
    raise ValueError(
E   ValueError: min_periods 5 must be <= window 3
______________________ test_run_backtest_produces_result _______________________
tests/trading_engine/test_backtest_runner.py:37: in test_run_backtest_produces_result
    result = backtester.run_backtest(TrendStrategy(), _market_data())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
trading_engine/backtester.py:151: in run_backtest
    trade = self._execute_trade(signal, symbol, row['close'], timestamp,
trading_engine/backtester.py:302: in _execute_trade
    quantity = int(self.config.initial_capital * 0.1 / execution_price)  # 10% of capital
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   OverflowError: cannot convert float infinity to integer
----------------------------- Captured stdout call -----------------------------
2025-12-06 15:21:11 | INFO | trading_engine.backtester.Backtester | Starting backtest for trend from 2024-01-01 00:00:00 to 2024-01-10 00:00:00 | trace_id=-
------------------------------ Captured log call -------------------------------
INFO     trading_engine.backtester.Backtester:backtester.py:121 Starting backtest for trend from 2024-01-01 00:00:00 to 2024-01-10 00:00:00
__________________ test_circuit_breaker_opens_after_failures ___________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
____________ TestYFinanceAdapter.test_fetch_historical_data_success ____________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
_____________ TestYFinanceAdapter.test_fetch_historical_data_error _____________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
__________ TestYFinanceAdapter.test_realtime_connect_not_implemented ___________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
___________ TestAlphaVantageAdapter.test_fetch_historical_data_daily ___________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
_________ TestAlphaVantageAdapter.test_fetch_historical_data_intraday __________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
___________ TestAlphaVantageAdapter.test_fetch_historical_data_error ___________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
________ TestAlphaVantageAdapter.test_realtime_connect_not_implemented _________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
_________________ TestAlphaVantageAdapter.test_context_manager _________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
________________________ test_pipeline_blocks_jailbreak ________________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
____________________ test_pipeline_returns_grounded_answer _____________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
________________ TestBackfillCommand.test_backfill_with_symbols ________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
__________________ TestBackfillCommand.test_backfill_with_csv __________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
_________________ TestBackfillCommand.test_backfill_no_symbols _________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
_____________ TestRealtimeCommand.test_realtime_with_mock_provider _____________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
___________________ TestMigrateCommand.test_migrate_success ____________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
_____________________ TestDataStorage.test_connect_sqlite ______________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
__________________ TestDataStorage.test_health_check_failure ___________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
_______________________ TestDataStorage.test_disconnect ________________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
_______________ test_candle_aggregation_emits_expected_payloads ________________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
=============================== warnings summary ===============================
data_collector/config.py:63
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/data_collector/config.py:63: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    finbot_mode: Literal["dev", "paper", "live"] = Field("dev", env="FINBOT_MODE")

data_collector/config.py:64
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/data_collector/config.py:64: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    live_trading_confirm: bool = Field(False, env="FINBOT_LIVE_TRADING_CONFIRM")

data_collector/config.py:75
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/data_collector/config.py:75: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    news_api_key: str | None = Field(default=None, env="NEWS_API_KEY")

data_collector/config.py:76
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/data_collector/config.py:76: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    news_api_endpoint: str = Field("https://newsapi.org/v2/everything", env="NEWS_API_ENDPOINT")

data_collector/config.py:77
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/data_collector/config.py:77: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    gnews_api_key: str | None = Field(default=None, env="GNEWS_API_KEY")

data_collector/config.py:57
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/data_collector/config.py:57: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class DataCollectorSettings(BaseSettings):

backend/app/config.py:23
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/config.py:23: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    finbot_mode: Literal["dev", "paper", "live"] = Field("dev", env="FINBOT_MODE")

backend/app/config.py:24
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/config.py:24: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    live_trading_confirm: bool = Field(False, env="FINBOT_LIVE_TRADING_CONFIRM")

backend/app/config.py:39
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/config.py:39: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    log_level: str = Field("INFO", env="LOG_LEVEL")

backend/app/config.py:40
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/config.py:40: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    log_dir: str = Field("logs", env="LOG_DIR")

backend/app/config.py:41
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/config.py:41: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    log_filename: str = Field("finbot.log", env="LOG_FILENAME")

backend/app/config.py:42
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/config.py:42: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    log_file: str | None = Field(None, env="LOG_FILE")

backend/app/config.py:43
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/config.py:43: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    log_max_bytes: int = Field(10_485_760, env="LOG_MAX_SIZE")

backend/app/config.py:44
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/config.py:44: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    log_backup_count: int = Field(5, env="LOG_BACKUP_COUNT")

backend/app/config.py:45
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/config.py:45: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    log_scan_limit: int = Field(2000, env="LOG_SCAN_LIMIT")

backend/app/config.py:47
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/config.py:47: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    enforce_https: bool = Field(default=False, env="ENFORCE_HTTPS")

backend/app/config.py:49
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/config.py:49: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    jwt_secret_key: str = Field(

backend/app/config.py:53
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/config.py:53: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    jwt_algorithm: str = Field(default="HS256", env="JWT_ALGORITHM")

backend/app/config.py:54
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/config.py:54: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    access_token_expire_minutes: int = Field(

backend/app/config.py:57
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/config.py:57: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    default_admin_username: str = Field(default="admin", env="DEFAULT_ADMIN_USERNAME")

backend/app/config.py:58
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/config.py:58: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    default_admin_password: str = Field(default="adminpass", env="DEFAULT_ADMIN_PASSWORD")

backend/app/config.py:59
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/config.py:59: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    default_user_username: str = Field(default="user", env="DEFAULT_USER_USERNAME")

backend/app/config.py:60
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/config.py:60: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    default_user_password: str = Field(default="userpass", env="DEFAULT_USER_PASSWORD")

backend/app/config.py:92
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/config.py:92: PydanticDeprecatedSince211: Accessing the 'model_fields' attribute on the instance is deprecated. Instead, you should access this attribute from the model class. Deprecated in Pydantic V2.11 to be removed in V3.0.
    for field_name in getattr(self, "model_fields", {}):

../../../../../../../home/mohit/.local/lib/python3.12/site-packages/passlib/utils/__init__.py:854
  /home/mohit/.local/lib/python3.12/site-packages/passlib/utils/__init__.py:854: DeprecationWarning: 'crypt' is deprecated and slated for removal in Python 3.13
    from crypt import crypt as _crypt

backend/app/schemas/health.py:11
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/schemas/health.py:11: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'example'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    status: str = Field(..., example="ok")

backend/app/schemas/health.py:8
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/schemas/health.py:8: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class HealthResponse(BaseModel):

../../../../../../../home/mohit/.local/lib/python3.12/site-packages/pydantic/_internal/_config.py:383
  /home/mohit/.local/lib/python3.12/site-packages/pydantic/_internal/_config.py:383: UserWarning: Valid config keys have changed in V2:
  * 'schema_extra' has been renamed to 'json_schema_extra'
    warnings.warn(message, UserWarning)

backend/app/schemas/system.py:17
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/schemas/system.py:17: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'example'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    app_version: str = Field(..., example="1.1.0")

backend/app/schemas/system.py:18
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/schemas/system.py:18: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'example'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    uptime_seconds: float = Field(..., example=12345.5)

backend/app/schemas/system.py:19
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/schemas/system.py:19: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'example'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    environment: str = Field(..., example="development")

backend/app/schemas/system.py:20
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/schemas/system.py:20: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'example'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    dependencies_ok: Dict[str, bool] = Field(

backend/app/schemas/portfolio.py:27
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/schemas/portfolio.py:27: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'example'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    timestamp: str = Field(..., example="2024-01-01T00:00:00Z")

backend/app/schemas/strategy.py:9
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/schemas/strategy.py:9: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'example'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    strategy_id: str = Field(..., example="alphadelta-v1")

backend/app/schemas/strategy.py:14
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/schemas/strategy.py:14: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'example'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    strategy_id: Optional[str] = Field(None, example="alphadelta-v1")

backend/app/schemas/strategy.py:15
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/schemas/strategy.py:15: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'example'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    instance_id: Optional[str] = Field(None, example="instance-1234")

backend/app/schemas/common.py:7
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/schemas/common.py:7: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class TimestampedModel(BaseModel):

../../../../../../../home/mohit/.local/lib/python3.12/site-packages/pydantic/_internal/_config.py:383
  /home/mohit/.local/lib/python3.12/site-packages/pydantic/_internal/_config.py:383: UserWarning: Valid config keys have changed in V2:
  * 'orm_mode' has been renamed to 'from_attributes'
    warnings.warn(message, UserWarning)

backend/app/schemas/common.py:16
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/schemas/common.py:16: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class PaginatedResponse(BaseModel):

backend/config/settings.py:39
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:39: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    finbot_mode: Literal["dev", "paper", "live"] = Field("dev", env="FINBOT_MODE")

backend/config/settings.py:40
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:40: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    live_trading_confirm: bool = Field(False, env="FINBOT_LIVE_TRADING_CONFIRM")

backend/config/settings.py:41
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:41: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    app_use_case: str = Field("PERSONAL_EXPERIMENTAL", env="APP_USE_CASE")

backend/config/settings.py:43
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:43: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    app_env: str = Field("development", env="APP_ENV")

backend/config/settings.py:44
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:44: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    app_name: str = Field("Finbot Trading API", env="APP_NAME")

backend/config/settings.py:45
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:45: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    app_version: str = Field("1.0.0", env="APP_VERSION")

backend/config/settings.py:46
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:46: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    app_host: str = Field("0.0.0.0", env="APP_HOST")

backend/config/settings.py:47
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:47: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    app_port: int = Field(8000, env="APP_PORT")

backend/config/settings.py:48
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:48: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    allow_origins: Sequence[str] = Field(DEFAULT_ORIGINS, env="ALLOW_ORIGINS")

backend/config/settings.py:50
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:50: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    database_url: str | None = Field(None, env="DATABASE_URL")

backend/config/settings.py:51
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:51: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    database_host: str = Field("localhost", env="DATABASE_HOST")

backend/config/settings.py:52
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:52: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    database_port: int = Field(5432, env="DATABASE_PORT")

backend/config/settings.py:53
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:53: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    database_name: str = Field("finbot_db", env="DATABASE_NAME")

backend/config/settings.py:54
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:54: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    database_user: str = Field("finbot_user", env="DATABASE_USER")

backend/config/settings.py:55
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:55: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    database_password: str | None = Field(None, env="DATABASE_PASSWORD")

backend/config/settings.py:57
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:57: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    redis_url: str | None = Field(None, env="REDIS_URL")

backend/config/settings.py:58
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:58: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    cache_ttl_seconds: int = Field(60, env="CACHE_TTL_SECONDS")

backend/config/settings.py:59
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:59: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    sentry_dsn: str | None = Field(None, env="SENTRY_DSN")

backend/config/settings.py:61
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:61: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    jwt_secret_key: str = Field("change-me", env="JWT_SECRET_KEY")

backend/config/settings.py:62
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:62: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    jwt_algorithm: str = Field("HS256", env="JWT_ALGORITHM")

backend/config/settings.py:64
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:64: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    trading_mode: str = Field("simulation", env="TRADING_MODE")

backend/config/settings.py:65
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:65: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    update_interval_seconds: float = Field(5.0, env="UPDATE_INTERVAL_SECONDS")

backend/config/settings.py:66
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:66: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    default_symbols: Sequence[str] = Field(("AAPL", "GOOGL", "MSFT"), env="DEFAULT_SYMBOLS")

backend/config/settings.py:68
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:68: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    max_drawdown: float = Field(0.15, env="MAX_DRAWDOWN")

backend/config/settings.py:69
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:69: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    max_daily_loss: float = Field(0.05, env="MAX_DAILY_LOSS")

backend/config/settings.py:70
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:70: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    max_position_size: float = Field(0.1, env="MAX_POSITION_SIZE")

backend/config/settings.py:71
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:71: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    initial_cash: float = Field(100000.0, env="INITIAL_CASH")

backend/config/settings.py:73
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:73: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    log_level: str = Field("INFO", env="LOG_LEVEL")

backend/config/settings.py:74
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:74: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    log_dir: str = Field("logs", env="LOG_DIR")

backend/config/settings.py:75
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:75: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    log_filename: str = Field("finbot.log", env="LOG_FILENAME")

backend/config/settings.py:76
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:76: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    log_file: str | None = Field(None, env="LOG_FILE")

backend/config/settings.py:77
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:77: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    log_max_size: int = Field(10_485_760, env="LOG_MAX_SIZE")

backend/config/settings.py:78
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:78: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    log_backup_count: int = Field(5, env="LOG_BACKUP_COUNT")

backend/config/settings.py:80
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:80: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    health_check_interval: int = Field(30, env="HEALTH_CHECK_INTERVAL")

backend/config/settings.py:81
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:81: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    metrics_retention_days: int = Field(30, env="METRICS_RETENTION_DAYS")

backend/config/settings.py:82
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:82: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    enable_prometheus_metrics: bool = Field(False, env="ENABLE_PROMETHEUS_METRICS")

backend/config/settings.py:83
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:83: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    prometheus_port: int = Field(9090, env="PROMETHEUS_PORT")

backend/config/settings.py:85
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:85: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    news_database_url: str | None = Field(None, env="NEWS_DATABASE_URL")

backend/config/settings.py:86
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:86: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    news_enable_ai: bool = Field(True, env="NEWS_ENABLE_AI")

backend/config/settings.py:87
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:87: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    news_max_articles: int = Field(25, env="NEWS_MAX_ARTICLES")

backend/config/settings.py:88
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:88: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    news_scheduler_run_time: str = Field("06:00", env="NEWS_SCHEDULER_RUN_TIME")

backend/config/settings.py:89
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:89: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    news_scheduler_timezone: str = Field("UTC", env="NEWS_SCHEDULER_TIMEZONE")

backend/config/settings.py:90
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:90: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    news_scheduler_enabled: bool = Field(True, env="NEWS_SCHEDULER_ENABLED")

backend/config/settings.py:91
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:91: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    news_sources: List[Dict[str, Any]] = Field(DEFAULT_NEWS_SOURCES, env="NEWS_SOURCES")

backend/config/settings.py:134: 1 warning
tests/backend/test_auth_routes.py: 1 warning
tests/test_config_loading.py: 7 warnings
tests/test_env_modes.py: 1 warning
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/config/settings.py:134: PydanticDeprecatedSince211: Accessing the 'model_fields' attribute on the instance is deprecated. Instead, you should access this attribute from the model class. Deprecated in Pydantic V2.11 to be removed in V3.0.
    for field_name in getattr(self, "model_fields", {}):

backend/api/main.py:83
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/api/main.py:83: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    APP_START_TIME = datetime.utcnow()

market_data_ingestion/src/settings.py:59
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/market_data_ingestion/src/settings.py:59: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    app_env: str = Field("development", env="APP_ENV")

market_data_ingestion/src/settings.py:60
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/market_data_ingestion/src/settings.py:60: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    finbot_mode: Literal["dev", "paper", "live"] = Field("dev", env="FINBOT_MODE")

market_data_ingestion/src/settings.py:61
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/market_data_ingestion/src/settings.py:61: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    database_url: str = Field("sqlite:///market_data.db", env="MARKET_DATA_DATABASE_URL")

market_data_ingestion/src/settings.py:62
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/market_data_ingestion/src/settings.py:62: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    config_path: Path = Field(

market_data_ingestion/src/settings.py:67
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/market_data_ingestion/src/settings.py:67: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    log_level: str = Field("INFO", env="LOG_LEVEL")

market_data_ingestion/src/settings.py:68
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/market_data_ingestion/src/settings.py:68: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    api_port: int = Field(8001, env="APP_PORT")

market_data_ingestion/src/settings.py:69
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/market_data_ingestion/src/settings.py:69: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    health_port: int = Field(8080, env="MARKET_DATA_HEALTH_PORT")

market_data_ingestion/src/settings.py:70
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/market_data_ingestion/src/settings.py:70: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    metrics_port: int = Field(9090, env="MARKET_DATA_METRICS_PORT")

market_data_ingestion/src/settings.py:71
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/market_data_ingestion/src/settings.py:71: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    enable_metrics: bool = Field(True, env="ENABLE_PROMETHEUS_METRICS")

market_data_ingestion/src/settings.py:76
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/market_data_ingestion/src/settings.py:76: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    scheduler_run_time: str = Field("02:00", env="MARKET_DATA_SCHEDULER_RUN_TIME")

market_data_ingestion/src/settings.py:77
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/market_data_ingestion/src/settings.py:77: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    scheduler_timezone: str = Field("UTC", env="MARKET_DATA_SCHEDULER_TIMEZONE")

market_data_ingestion/src/settings.py:78
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/market_data_ingestion/src/settings.py:78: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    scheduler_period: str | None = Field(None, env="MARKET_DATA_SCHEDULER_PERIOD")

market_data_ingestion/src/settings.py:79
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/market_data_ingestion/src/settings.py:79: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    scheduler_interval: str | None = Field(None, env="MARKET_DATA_SCHEDULER_INTERVAL")

market_data_ingestion/src/settings.py:80
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/market_data_ingestion/src/settings.py:80: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    scheduler_symbols: List[str] | None = Field(None, env="MARKET_DATA_SCHEDULER_SYMBOLS")

market_data_ingestion/src/settings.py:81
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/market_data_ingestion/src/settings.py:81: PydanticDeprecatedSince20: Using extra keyword arguments on `Field` is deprecated and will be removed. Use `json_schema_extra` instead. (Extra keys: 'env'). Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    scheduler_enabled: bool = Field(True, env="MARKET_DATA_SCHEDULER_ENABLED")

market_data_ingestion/src/settings.py:144
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/market_data_ingestion/src/settings.py:144: PydanticDeprecatedSince211: Accessing the 'model_fields' attribute on the instance is deprecated. Instead, you should access this attribute from the model class. Deprecated in Pydantic V2.11 to be removed in V3.0.
    for field_name in getattr(self, "model_fields", {}):

tests/backend/test_middlewares.py::test_enforce_https_redirects_insecure_requests
  /home/mohit/.local/lib/python3.12/site-packages/starlette/testclient.py:431: DeprecationWarning: The `allow_redirects` argument is deprecated. Use `follow_redirects` instead.
    warnings.warn(message, DeprecationWarning)

tests/backend/test_user_routes.py: 3 warnings
tests/e2e/test_paper_trading_e2e.py: 3 warnings
tests/test_api_market_data.py: 4 warnings
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/api/auth.py:122: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    expire = datetime.utcnow() + timedelta(minutes=ACCESS_TOKEN_EXPIRE_MINUTES)

tests/data_collector/test_mock_feeds.py::test_signal_handler_schedules_stop
  /home/mohit/.local/lib/python3.12/site-packages/_pytest/monkeypatch.py:414: RuntimeWarning: coroutine 'RealtimeIngestionManager.stop' was never awaited
    setattr(obj, name, value)
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

tests/integration/test_backend_api_roles.py::test_health_endpoints_exposed_without_auth
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/backend/app/main.py:115: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    return {"status": "healthy", "timestamp": datetime.utcnow().isoformat()}

tests/integration/test_backend_api_roles.py::test_health_endpoints_exposed_without_auth
  /home/mohit/.local/lib/python3.12/site-packages/pydantic/main.py:250: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)

tests/test_execution_brokers.py::test_mock_broker_fills_market_orders
tests/test_execution_brokers.py::test_mock_broker_cancel
  <string>:10: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).

tests/test_execution_brokers.py::test_mock_broker_fills_market_orders
tests/test_execution_brokers.py::test_mock_broker_cancel
  <string>:11: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).

tests/test_execution_brokers.py::test_mock_broker_fills_market_orders
tests/test_execution_brokers.py::test_mock_broker_cancel
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/execution/mocked_broker.py:45: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    order.created_at = datetime.utcnow()

tests/test_logging_and_metrics.py::test_logs_endpoint_pagination_with_since_until
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/tests/test_logging_and_metrics.py:110: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    since = datetime.utcnow() - timedelta(hours=1)

tests/trading_engine/test_backtest_runner.py::test_run_backtest_produces_result
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/trading_engine/backtester.py:302: RuntimeWarning: divide by zero encountered in scalar divide
    quantity = int(self.config.initial_capital * 0.1 / execution_price)  # 10% of capital

tests/trading_engine/test_live_safety_guards.py::test_trading_halt_flag
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/tests/trading_engine/test_live_safety_guards.py:40: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    engine._trading_halted_until = datetime.utcnow() + timedelta(seconds=5)

tests/trading_engine/test_live_safety_guards.py::test_trading_halt_flag
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/trading_engine/live_trading_engine.py:192: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    return datetime.utcnow() < self._trading_halted_until

tests/unit/test_normalizer.py::TestDataNormalizer::test_normalize_trade_success
tests/unit/test_normalizer.py::TestDataNormalizer::test_normalize_trades_batch
tests/unit/test_normalizer.py::TestDataNormalizer::test_normalize_trades_batch
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/data_collector/market_data/normalization/normalizer.py:34: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    received_at=datetime.utcnow(),

tests/unit/test_normalizer.py::TestDataNormalizer::test_normalize_quote_success
tests/unit/test_normalizer.py::TestDataNormalizer::test_normalize_quote_with_none_values
tests/unit/test_normalizer.py::TestDataNormalizer::test_normalize_quotes_batch
tests/unit/test_normalizer.py::TestDataNormalizer::test_normalize_quotes_batch
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/data_collector/market_data/normalization/normalizer.py:54: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    received_at=datetime.utcnow(),

tests/unit/test_normalizer.py::TestDataNormalizer::test_normalize_candle_success
tests/unit/test_normalizer.py::TestDataNormalizer::test_normalize_candles_batch
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/data_collector/market_data/normalization/normalizer.py:75: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    received_at=datetime.utcnow(),

tests/unit/test_project_report.py::test_build_report_includes_summary_and_pending_items
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/infrastructure/scripts/generate_project_report.py:183: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    timestamp = dt.datetime.utcnow().strftime("%Y-%m-%d %H:%M UTC")

tests/unit/test_trading_engine.py::TestLiveTradingEngine::test_check_signal_risk_limits
  /mnt/c/Users/mohit/Documents/GitHub/blackboxai-finbot/trading_engine/live_trading_engine.py:651: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    now = datetime.utcnow()

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
SKIPPED [1] tests/performance/test_candles_latency.py:19: API server not running
ERROR tests/e2e/test_paper_trading_e2e.py::test_paper_trading_edge_cases_and_errors
ERROR tests/e2e/test_paper_trading_e2e.py::test_paper_trading_limit_and_stop_orders
ERROR tests/integration/test_adapters_integration.py::TestYFinanceAdapterIntegration::test_fetch_and_store_data
ERROR tests/integration/test_adapters_integration.py::TestYFinanceAdapterIntegration::test_fetch_multiple_symbols
ERROR tests/integration/test_backend_api_roles.py::test_metrics_requires_admin
ERROR tests/integration/test_backend_api_roles.py::test_protected_get_routes_accept_user_token
ERROR tests/integration/test_backend_api_roles.py::test_strategy_actions_accept_user_token
ERROR tests/integration/test_backend_api_roles.py::test_malformed_and_expired_tokens_are_rejected
ERROR tests/integration/test_backend_api_roles.py::test_logs_restricted_to_admin
ERROR tests/integration/test_backend_api_roles.py::test_logs_returns_503_when_store_unavailable
ERROR tests/performance/test_ingestion_performance.py::TestStoragePerformance::test_bulk_insert_performance
ERROR tests/performance/test_ingestion_performance.py::TestStoragePerformance::test_fetch_performance
ERROR tests/performance/test_ingestion_performance.py::TestEndToEndPerformance::test_full_pipeline_performance
ERROR tests/performance/test_ingestion_performance.py::TestConcurrentOperations::test_concurrent_inserts
ERROR tests/unit/test_adapters.py::TestKiteWebSocketAdapter::test_authenticate
ERROR tests/unit/test_adapters.py::TestKiteWebSocketAdapter::test_subscribe
ERROR tests/unit/test_adapters.py::TestKiteWebSocketAdapter::test_context_manager
ERROR tests/unit/test_adapters.py::TestKiteWebSocketAdapter::test_process_message_tick
ERROR tests/unit/test_storage.py::TestDataStorage::test_create_tables - pytes...
ERROR tests/unit/test_storage.py::TestDataStorage::test_insert_candle - pytes...
ERROR tests/unit/test_storage.py::TestDataStorage::test_insert_duplicate_candle
ERROR tests/unit/test_storage.py::TestDataStorage::test_fetch_last_n_candles
ERROR tests/unit/test_storage.py::TestDataStorage::test_fetch_last_n_candles_empty
ERROR tests/unit/test_storage.py::TestDataStorage::test_fetch_last_n_candles_different_symbols
ERROR tests/unit/test_storage.py::TestDataStorage::test_health_check_success
FAILED tests/ai_models/test_model_loading.py::test_pipeline_answer_returns_clean_response
FAILED tests/backend/test_auth_routes.py::test_logout_successful - assert 403...
FAILED tests/backend/test_auth_routes.py::test_register_new_user - AttributeE...
FAILED tests/backend/test_auth_routes.py::test_register_existing_user - Attri...
FAILED tests/backend/test_auth_routes.py::test_forgot_password_valid_email - ...
FAILED tests/backend/test_auth_routes.py::test_forgot_password_unknown_email
FAILED tests/backend/test_auth_routes.py::test_protected_endpoint_requires_auth
FAILED tests/backend/test_auth_routes.py::test_protected_endpoint_with_valid_token
FAILED tests/backend/test_auth_routes.py::test_admin_only_endpoint_requires_admin_role
FAILED tests/backend/test_auth_routes.py::test_logout_invalidates_token - ass...
FAILED tests/backend/test_auth_routes.py::test_auth_endpoints_cors_headers - ...
FAILED tests/backend/test_market_data_routes.py::test_get_market_data_ohlc - ...
FAILED tests/backend/test_market_data_routes.py::test_get_market_data_ohlc_invalid_symbol
FAILED tests/backend/test_market_data_routes.py::test_get_market_data_ohlc_with_date_range
FAILED tests/backend/test_market_data_routes.py::test_get_current_price - Att...
FAILED tests/backend/test_market_data_routes.py::test_get_current_price_not_found
FAILED tests/backend/test_market_data_routes.py::test_get_market_data_quote
FAILED tests/backend/test_market_data_routes.py::test_get_market_depth - Attr...
FAILED tests/backend/test_market_data_routes.py::test_get_historical_volume
FAILED tests/backend/test_market_data_routes.py::test_get_market_data_with_pagination
FAILED tests/backend/test_market_data_routes.py::test_get_market_data_invalid_timeframe
FAILED tests/backend/test_market_data_routes.py::test_get_market_data_rate_limiting
FAILED tests/backend/test_market_data_routes.py::test_get_market_data_caching
FAILED tests/backend/test_market_data_routes.py::test_get_market_data_error_handling
FAILED tests/backend/test_market_data_routes.py::test_get_market_data_empty_response
FAILED tests/backend/test_trading_routes.py::test_place_buy_order_success - a...
FAILED tests/backend/test_trading_routes.py::test_place_sell_order_success - ...
FAILED tests/backend/test_trading_routes.py::test_place_market_order - assert...
FAILED tests/backend/test_trading_routes.py::test_place_order_invalid_side - ...
FAILED tests/backend/test_trading_routes.py::test_place_order_invalid_quantity
FAILED tests/backend/test_trading_routes.py::test_place_order_live_mode_blocked_without_confirmation
FAILED tests/backend/test_trading_routes.py::test_cancel_order_success - asse...
FAILED tests/backend/test_trading_routes.py::test_cancel_order_not_found - As...
FAILED tests/backend/test_trading_routes.py::test_get_pnl_today - assert 404 ...
FAILED tests/backend/test_trading_routes.py::test_start_trading_engine - asse...
FAILED tests/backend/test_trading_routes.py::test_stop_trading_engine - asser...
FAILED tests/backend/test_trading_routes.py::test_get_trading_status - assert...
FAILED tests/backend/test_trading_routes.py::test_get_trading_history - asser...
FAILED tests/backend/test_trading_routes.py::test_place_order_unauthenticated
FAILED tests/data_collector/test_backfill_scripts.py::test_nse_backfill_script_success
FAILED tests/data_collector/test_backfill_scripts.py::test_nse_backfill_with_date_range
FAILED tests/data_collector/test_backfill_scripts.py::test_bse_backfill_script_success
FAILED tests/data_collector/test_backfill_scripts.py::test_mcx_backfill_script_success
FAILED tests/data_collector/test_backfill_scripts.py::test_backfill_script_error_handling
FAILED tests/data_collector/test_backfill_scripts.py::test_backfill_script_invalid_dates
FAILED tests/data_collector/test_backfill_scripts.py::test_backfill_script_rate_limiting
FAILED tests/data_collector/test_backfill_scripts.py::test_backfill_script_data_validation
FAILED tests/data_collector/test_backfill_scripts.py::test_backfill_script_progress_reporting
FAILED tests/data_collector/test_backfill_scripts.py::test_backfill_script_config_loading
FAILED tests/data_collector/test_backfill_scripts.py::test_backfill_script_output_formats
FAILED tests/data_collector/test_backfill_scripts.py::test_backfill_script_dry_run_mode
FAILED tests/data_collector/test_backfill_scripts.py::test_backfill_script_symbol_filtering
FAILED tests/data_collector/test_backfill_scripts.py::test_backfill_script_parallel_processing
FAILED tests/data_collector/test_mock_feeds.py::test_mock_websocket_server_emits_ticks
FAILED tests/integration/test_adapters_integration.py::TestAdapterErrorHandling::test_yfinance_network_error
FAILED tests/integration/test_adapters_integration.py::TestAdapterErrorHandling::test_alphavantage_api_error
FAILED tests/integration/test_adapters_integration.py::TestAdapterRateLimiting::test_yfinance_rate_limiting
FAILED tests/integration/test_api_auth.py::TestAPIAuthentication::test_login_nonexistent_user
FAILED tests/integration/test_api_auth.py::TestAPIAuthentication::test_login_successful
FAILED tests/integration/test_api_auth.py::TestAPIAuthentication::test_logout_authenticated
FAILED tests/integration/test_api_auth.py::TestAPIAuthentication::test_logout_unauthenticated
FAILED tests/integration/test_api_auth.py::TestProtectedEndpoints::test_place_trade_authenticated
FAILED tests/integration/test_api_auth.py::TestProtectedEndpoints::test_place_trade_invalid_quantity
FAILED tests/integration/test_api_auth.py::TestProtectedEndpoints::test_place_trade_invalid_side
FAILED tests/integration/test_api_auth.py::TestProtectedEndpoints::test_place_trade_no_auth
FAILED tests/integration/test_api_auth.py::TestProtectedEndpoints::test_protected_endpoint_authenticated
FAILED tests/integration/test_api_auth.py::TestProtectedEndpoints::test_protected_endpoint_invalid_token
FAILED tests/integration/test_api_auth.py::TestProtectedEndpoints::test_protected_endpoint_no_auth
FAILED tests/integration/test_api_auth.py::TestPublicEndpoints::test_health_endpoint
FAILED tests/integration/test_api_auth.py::TestPublicEndpoints::test_logs_endpoint_forbidden_for_non_admin
FAILED tests/integration/test_api_auth.py::TestPublicEndpoints::test_logs_endpoint_no_file
FAILED tests/integration/test_api_auth.py::TestPublicEndpoints::test_logs_endpoint_requires_auth
FAILED tests/integration/test_api_auth.py::TestPublicEndpoints::test_logs_endpoint_with_file
FAILED tests/integration/test_api_auth.py::TestPublicEndpoints::test_metrics_endpoint
FAILED tests/integration/test_api_auth.py::TestPublicEndpoints::test_root_endpoint
FAILED tests/integration/test_api_auth.py::TestPublicEndpoints::test_status_endpoint
FAILED tests/integration/test_api_auth.py::TestStrategyEndpoints::test_get_strategies
FAILED tests/integration/test_api_auth.py::TestStrategyEndpoints::test_load_strategy_invalid_class
FAILED tests/integration/test_api_auth.py::TestStrategyEndpoints::test_manage_strategy_invalid_action
FAILED tests/integration/test_api_auth.py::TestTradingEndpoints::test_control_trading_invalid_action
FAILED tests/integration/test_api_auth.py::TestTradingEndpoints::test_get_trading_history
FAILED tests/integration/test_api_auth.py::TestTradingEndpoints::test_get_trading_status
FAILED tests/integration/test_api_endpoints.py::TestMetricsEndpoint::test_get_metrics_success
FAILED tests/integration/test_api_endpoints.py::TestHealthEndpoints::test_ready_check
FAILED tests/integration/test_api_endpoints.py::TestSymbolsEndpoint::test_get_symbols
FAILED tests/integration/test_full_paper_trading_loop.py::test_process_symbol_invokes_signal_handler
FAILED tests/integration/test_health_and_metrics_stack.py::test_backend_metrics_endpoint_includes_components
FAILED tests/market_data_ingestion/test_api_routes.py::test_health_check_reports_service_name
FAILED tests/market_data_ingestion/test_api_routes.py::test_readiness_check_queries_database
FAILED tests/market_data_ingestion/test_api_routes.py::test_readiness_check_propagates_errors
FAILED tests/market_data_ingestion/test_api_routes.py::test_get_candles_returns_payload
FAILED tests/market_data_ingestion/test_api_routes.py::test_get_candles_raises_when_no_data
FAILED tests/market_data_ingestion/test_backfill_cli.py::test_backfill_api_command_executes
FAILED tests/market_data_ingestion/test_backfill_cli.py::test_backfill_csv_command_ingests
FAILED tests/market_data_ingestion/test_backfill_cli.py::test_replay_dlq_command_invokes_handler
FAILED tests/market_data_ingestion/test_bar_builders.py::test_candle_aggregator_emits_payload_for_each_interval
FAILED tests/market_data_ingestion/test_bar_builders.py::test_tick_aggregator_flushes_all_intervals
FAILED tests/market_data_ingestion/test_scheduler_and_retries.py::test_trigger_refresh_invokes_backfill
FAILED tests/market_data_ingestion/test_source_adapters_equities.py::test_fetch_historical_data_invokes_rate_limit
FAILED tests/market_data_ingestion/test_source_adapters_mcxticks.py::test_kite_adapter_normalizes_ticks
FAILED tests/market_data_ingestion/test_source_adapters_mcxticks.py::test_process_message_returns_none_for_invalid_json
FAILED tests/market_data_ingestion/test_source_adapters_mcxticks.py::test_process_message_uses_normalizer
FAILED tests/market_data_ingestion/test_storage_parquet_postgres.py::test_postgres_connection_uses_asyncpg_pool
FAILED tests/market_data_ingestion/test_storage_parquet_postgres.py::test_sqlite_candles_can_be_dumped_to_parquet
FAILED tests/performance/test_ingestion_performance.py::TestAggregatorPerformance::test_tick_aggregation_performance
FAILED tests/performance/test_ingestion_performance.py::TestAggregatorPerformance::test_multi_symbol_aggregation_performance
FAILED tests/risk/test_var_and_drawdown.py::test_can_open_trade_respects_risk_per_trade
FAILED tests/scripts/test_dev_run_entrypoints.py::test_dev_run_backend_entrypoint
FAILED tests/scripts/test_dev_run_entrypoints.py::test_dev_run_ingestion_entrypoint
FAILED tests/scripts/test_dev_run_entrypoints.py::test_dev_run_engine_entrypoint
FAILED tests/scripts/test_dev_run_entrypoints.py::test_dev_run_with_config_file
FAILED tests/scripts/test_dev_run_entrypoints.py::test_dev_run_environment_variables
FAILED tests/scripts/test_dev_run_entrypoints.py::test_dev_run_shutdown_signal_handling
FAILED tests/scripts/test_dev_run_entrypoints.py::test_dev_run_process_monitoring
FAILED tests/scripts/test_dev_run_entrypoints.py::test_dev_run_log_file_output
FAILED tests/scripts/test_dev_run_entrypoints.py::test_dev_run_multiple_services
FAILED tests/scripts/test_dev_run_entrypoints.py::test_dev_run_dependency_check
FAILED tests/scripts/test_dev_run_entrypoints.py::test_dev_run_dependency_failure
FAILED tests/scripts/test_dev_run_entrypoints.py::test_dev_run_health_check
FAILED tests/scripts/test_dev_run_entrypoints.py::test_dev_run_health_check_timeout
FAILED tests/scripts/test_dev_run_entrypoints.py::test_dev_run_reload_on_file_change
FAILED tests/scripts/test_dev_run_entrypoints.py::test_dev_run_debug_mode - A...
FAILED tests/scripts/test_dev_run_entrypoints.py::test_dev_run_profile_mode
FAILED tests/scripts/test_dev_run_entrypoints.py::test_dev_run_with_custom_python_path
FAILED tests/scripts/test_dev_run_entrypoints.py::test_dev_run_service_discovery
FAILED tests/scripts/test_dev_run_entrypoints.py::test_dev_run_cleanup_on_exit
FAILED tests/strategies/regression/test_ema_crossover_regression.py::test_regression_triggers_buy_then_flat
FAILED tests/strategies/test_risk_overrides.py::test_validate_order_rejects_when_margin_missing
FAILED tests/test_api_market_data.py::TestHealthEndpoints::test_health_check
FAILED tests/test_api_market_data.py::TestHealthEndpoints::test_healthz_alias
FAILED tests/test_api_market_data.py::TestHealthEndpoints::test_readiness_check_success
FAILED tests/test_api_market_data.py::TestHealthEndpoints::test_readiness_check_failure
FAILED tests/test_api_market_data.py::TestHealthEndpoints::test_readyz_alias
FAILED tests/test_api_market_data.py::TestMetricsEndpoint::test_get_metrics
FAILED tests/test_api_market_data.py::TestCandlesEndpoint::test_get_candles_success
FAILED tests/test_api_market_data.py::TestCandlesEndpoint::test_get_candles_no_data
FAILED tests/test_api_market_data.py::TestCandlesEndpoint::test_get_candles_missing_symbol
FAILED tests/test_api_market_data.py::TestCandlesEndpoint::test_get_candles_invalid_limit
FAILED tests/test_api_market_data.py::TestSymbolsEndpoint::test_get_symbols_success
FAILED tests/test_api_market_data.py::TestSymbolsEndpoint::test_get_symbols_empty
FAILED tests/test_api_market_data.py::TestSymbolsEndpoint::test_get_symbols_db_error
FAILED tests/test_api_market_data.py::TestAuthEndpoints::test_register_invalid_email
FAILED tests/test_api_market_data.py::TestAuthEndpoints::test_register_weak_password
FAILED tests/test_api_market_data.py::TestAuthEndpoints::test_logout - assert...
FAILED tests/test_api_market_data.py::TestIntegration::test_full_workflow - T...
FAILED tests/test_config_loading.py::test_database_url_construction - Asserti...
FAILED tests/test_config_loading.py::test_database_url_fallback_to_sqlite - A...
FAILED tests/test_config_loading.py::test_broker_config_loading - AssertionEr...
FAILED tests/test_config_loading.py::test_feature_flags_loading - AssertionEr...
FAILED tests/test_config_loading.py::test_config_validation - Failed: DID NOT...
FAILED tests/test_config_loading.py::test_config_from_env_file - AttributeErr...
FAILED tests/test_ema_crossover_strategy.py::test_strategy_initializes_defaults
FAILED tests/test_ema_crossover_strategy.py::test_strategy_emits_buy_and_sell_on_crossovers
FAILED tests/test_ema_crossover_strategy.py::test_strategy_returns_none_when_no_crossover
FAILED tests/test_ema_crossover_strategy.py::test_ema_values_progress_over_time
FAILED tests/test_ema_strategy.py::test_ema_crossover_emits_signals_on_cross
FAILED tests/test_env_modes.py::test_finbot_mode_valid_values - ImportError: ...
FAILED tests/test_env_modes.py::test_finbot_mode_invalid_value_raises_error
FAILED tests/test_env_modes.py::test_live_mode_requires_confirmation - Assert...
FAILED tests/test_env_modes.py::test_env_file_loading - AttributeError: <modu...
FAILED tests/test_env_modes.py::test_safety_audit_script - AssertionError: as...
FAILED tests/test_full_pipeline.py::test_full_pipeline_intraday_ema_with_mock_broker
FAILED tests/test_health_endpoints.py::test_ready_endpoint_alias - assert 404...
FAILED tests/test_health_endpoints.py::test_live_endpoint_alias - assert 429 ...
FAILED tests/test_health_endpoints.py::test_api_health_endpoint - assert 429 ...
FAILED tests/test_health_endpoints.py::test_health_endpoint_timestamp_format
FAILED tests/test_health_endpoints.py::test_health_endpoint_cache_dependency_check
FAILED tests/test_logging_and_metrics.py::test_metrics_endpoint_returns_valid_json
FAILED tests/test_logging_and_metrics.py::test_metrics_endpoint_includes_uptime
FAILED tests/test_logging_and_metrics.py::test_metrics_endpoint_includes_trade_stream_info
FAILED tests/test_logging_and_metrics.py::test_metrics_endpoint_includes_dependencies_health
FAILED tests/test_logging_and_metrics.py::test_logs_endpoint_returns_structured_logs
FAILED tests/test_logging_and_metrics.py::test_logs_endpoint_filters_by_level
FAILED tests/test_logging_and_metrics.py::test_logs_endpoint_limits_results
FAILED tests/test_logging_and_metrics.py::test_logs_endpoint_pagination_with_since_until
FAILED tests/test_logging_and_metrics.py::test_logs_endpoint_masks_sensitive_data
FAILED tests/test_logging_and_metrics.py::test_logs_endpoint_handles_missing_log_file
FAILED tests/test_logging_and_metrics.py::test_logs_endpoint_handles_corrupt_log_file
FAILED tests/test_stock_scraper.py::test_detects_volume_spike_anomaly - Value...
FAILED tests/trading_engine/test_backtest_runner.py::test_run_backtest_produces_result
FAILED tests/trading_engine/test_live_safety_guards.py::test_circuit_breaker_opens_after_failures
FAILED tests/unit/test_adapters.py::TestYFinanceAdapter::test_fetch_historical_data_success
FAILED tests/unit/test_adapters.py::TestYFinanceAdapter::test_fetch_historical_data_error
FAILED tests/unit/test_adapters.py::TestYFinanceAdapter::test_realtime_connect_not_implemented
FAILED tests/unit/test_adapters.py::TestAlphaVantageAdapter::test_fetch_historical_data_daily
FAILED tests/unit/test_adapters.py::TestAlphaVantageAdapter::test_fetch_historical_data_intraday
FAILED tests/unit/test_adapters.py::TestAlphaVantageAdapter::test_fetch_historical_data_error
FAILED tests/unit/test_adapters.py::TestAlphaVantageAdapter::test_realtime_connect_not_implemented
FAILED tests/unit/test_adapters.py::TestAlphaVantageAdapter::test_context_manager
FAILED tests/unit/test_ai_pipeline.py::test_pipeline_blocks_jailbreak - Faile...
FAILED tests/unit/test_ai_pipeline.py::test_pipeline_returns_grounded_answer
FAILED tests/unit/test_cli.py::TestBackfillCommand::test_backfill_with_symbols
FAILED tests/unit/test_cli.py::TestBackfillCommand::test_backfill_with_csv - ...
FAILED tests/unit/test_cli.py::TestBackfillCommand::test_backfill_no_symbols
FAILED tests/unit/test_cli.py::TestRealtimeCommand::test_realtime_with_mock_provider
FAILED tests/unit/test_cli.py::TestMigrateCommand::test_migrate_success - Fai...
FAILED tests/unit/test_storage.py::TestDataStorage::test_connect_sqlite - Fai...
FAILED tests/unit/test_storage.py::TestDataStorage::test_health_check_failure
FAILED tests/unit/test_storage.py::TestDataStorage::test_disconnect - Failed:...
FAILED tests/unit/test_tick_aggregator.py::test_candle_aggregation_emits_expected_payloads
===== 200 failed, 266 passed, 1 skipped, 145 warnings, 25 errors in 59.17s =====
